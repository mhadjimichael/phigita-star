var i18n = {CONFIRM_LINK_CLICK:"Please confirm that you want to open this link", Cancel:"Cancel", Dictionary:"Dictionary", 'Finished list of mispelled words':"Finished list of mispelled words", 'I will open it in a new page.':"I will open it in a new page.", 'Ignore all':"Ignore all", Ignore:"Ignore", NO_ERRORS:"No mispelled words found with the selected dictionary.", NO_ERRORS_CLOSING:"Spell check complete, didn't find any mispelled words.  Closing now...", OK:"OK", 'Original word':"Original word", 'Please wait.  Calling spell checker.':"Please wait.  Calling spell checker.", 'Please wait: changing dictionary to':"Please wait: changing dictionary to", QUIT_CONFIRMATION:"This will drop changes and quit spell checker.  Please confirm.", 'Re-check':"Re-check", 'Replace all':"Replace all", 'Replace with':"Replace with", Replace:"Replace", Revert:"Revert", 'SC-spell-check':"Spell-check", Suggestions:"Suggestions", 'pliz weit ;-)':"pliz weit ;-)"};var SpellChecker = window.opener.SC;var is_ie = SpellChecker.is_ie;var frame = null;var currentElement = null;var wrongWords = null;var modified = false;var allWords = {};var fixedWords = [];var suggested_words = {};function makeCleanDoc(d) {var c = wrongWords.concat(fixedWords);for (var b = c.length; --b >= 0;) {var a = c[b];if (!(d && /HA-spellcheck-fixed/.test(a.className))) {a.parentNode.insertBefore(a.firstChild, a);a.parentNode.removeChild(a);} else {a.className = "HA-spellcheck-fixed";}}return frame.contentWindow.document.body.innerHTML.replace(/^<pre [^>]+>/gi, "").replace(/<\/pre>$/gi, "");}function recheckClicked() {document.getElementById("status").innerHTML = i18n['Please wait: changing dictionary to'] + ": \"" + document.getElementById("f_dictionary").value + "\".";var c = document.getElementById("f_content");c.value = makeCleanDoc(false);c.form.submit();}function saveClicked() {if (modified) {window.opener.document.getElementById(SpellChecker._textarea).value = makeCleanDoc(false);}window.close();return false;}function cancelClicked() {var a = true;if (modified) {a = confirm(i18n.QUIT_CONFIRMATION);}if (a) {window.close();}return false;}function replaceWord(c) {var b = document.getElementById("v_replacement").value;var a = (c.innerHTML != b);if (a) {modified = true;}if (c) {c.className = c.className.replace(/\s*HA-spellcheck-(hover|fixed)\s*/g, " ");}c.className += " HA-spellcheck-fixed";c.__msh_fixed = true;if (!a) {return false;}c.innerHTML = b;}function replaceClicked() {replaceWord(currentElement);var b = currentElement.__msh_id;var a = b;do {++a;if (a == wrongWords.length) {a = 0;}} while ((a != b) && wrongWords[a].__msh_fixed);if (a == b) {a = 0;alert(i18n['Finished list of mispelled words']);}wrongWords[a].__msh_wordClicked(true);return false;}function revertClicked() {document.getElementById("v_replacement").value = currentElement.__msh_origWord;replaceWord(currentElement);currentElement.className = "HA-spellcheck-error HA-spellcheck-current";return false;}function replaceAllClicked() {var d = document.getElementById("v_replacement").value;var c = true;var b = allWords[currentElement.__msh_origWord];if (b.length == 0) {alert("An impossible condition just happened.  Call FBI.  ;-)");} else {if (b.length == 1) {replaceClicked();return false;}}if (c) {for (var a in b) {if (b[a] != currentElement) {replaceWord(b[a]);}}replaceClicked();}return false;}function ignoreClicked() {document.getElementById("v_replacement").value = currentElement.__msh_origWord;replaceClicked();return false;}function ignoreAllClicked() {document.getElementById("v_replacement").value = currentElement.__msh_origWord;replaceAllClicked();return false;}function learnClicked() {alert("Not [yet] implemented");return false;}function initDocument() {modified = false;frame = document.getElementById("i_framecontent");var c = document.getElementById("f_content");var b = document.getElementById("f_dictionary");c.value = window.opener.document.getElementById(SpellChecker._textarea).value;b.value = window.opener.document.getElementById(SpellChecker._dictionary).value;c.form.submit();document.getElementById("f_init").value = "0";var a = document.getElementById("v_suggestions");a.onchange = (function () {document.getElementById("v_replacement").value = this.value;});if (is_ie) {a.attachEvent("ondblclick", replaceClicked);} else {a.addEventListener("dblclick", replaceClicked, true);}document.getElementById("b_replace").onclick = replaceClicked;document.getElementById("b_replall").onclick = replaceAllClicked;document.getElementById("b_ignore").onclick = ignoreClicked;document.getElementById("b_ignall").onclick = ignoreAllClicked;document.getElementById("b_recheck").onclick = recheckClicked;document.getElementById("b_revert").onclick = revertClicked;document.getElementById("b_ok").onclick = saveClicked;document.getElementById("b_cancel").onclick = cancelClicked;a = document.getElementById("v_dictionaries");a.onchange = (function () {document.getElementById("f_dictionary").value = this.value;});}function getAbsolutePos(c) {var b = {x:c.offsetLeft, y:c.offsetTop};if (c.offsetParent) {var a = getAbsolutePos(c.offsetParent);b.x += a.x;b.y += a.y;}return b;}function wordClicked(i) {var h = this;if (i) {(function () {var pos = getAbsolutePos(self);var ws = {x:frame.offsetWidth - 4, y:frame.offsetHeight - 4};var wp = {x:frame.contentWindow.document.body.scrollLeft, y:frame.contentWindow.document.body.scrollTop};pos.x -= Math.round(ws.x / 2);if (pos.x < 0) {pos.x = 0;}pos.y -= Math.round(ws.y / 2);if (pos.y < 0) {pos.y = 0;}frame.contentWindow.scrollTo(pos.x, pos.y);})();}if (currentElement) {var g = allWords[currentElement.__msh_origWord];currentElement.className = currentElement.className.replace(/\s*HA-spellcheck-current\s*/g, " ");for (var f in g) {var e = g[f];if (e != currentElement) {e.className = e.className.replace(/\s*HA-spellcheck-same\s*/g, " ");}}}currentElement = this;this.className += " HA-spellcheck-current";var g = allWords[currentElement.__msh_origWord];for (var f in g) {var e = g[f];if (e != currentElement) {e.className += " HA-spellcheck-same";}}var d;if (g.length == 1) {d = "one occurrence";} else {if (g.length == 2) {d = "two occurrences";} else {d = g.length + " occurrences";}}var c = suggested_words[this.__msh_origWord];if (c) {c = c.split(/,/);} else {c = [];}var b = document.getElementById("v_suggestions");document.getElementById("statusbar").innerHTML = "Found " + d + " for word \"<b>" + currentElement.__msh_origWord + "</b>\"";for (var f = b.length; --f >= 0;) {b.remove(f);}for (var f = 0; f < c.length; ++f) {var d = c[f];var a = document.createElement("option");a.value = d;a.appendChild(document.createTextNode(d));b.appendChild(a);}document.getElementById("v_currentWord").innerHTML = this.__msh_origWord;if (c.length > 0) {b.selectedIndex = 0;b.onchange();} else {document.getElementById("v_replacement").value = this.innerHTML;}b.style.display = "none";b.style.display = "block";return false;}function wordMouseOver() {this.className += " HA-spellcheck-hover";}function wordMouseOut() {this.className = this.className.replace(/\s*HA-spellcheck-hover\s*/g, " ");}function displayInfo() {var c = frame.contentWindow.spellcheck_info;if (!c) {alert("No information available");} else {var b = "** Document information **";for (var a in c) {b += "\n" + a + " : " + c[a];}alert(b);}return false;}function finishedSpellChecking() {currentElement = null;wrongWords = null;allWords = {};fixedWords = [];suggested_words = frame.contentWindow.suggested_words;document.getElementById("status").innerHTML = "";var l = frame.contentWindow.document;var k = l.getElementsByTagName("span");var j = [];var i = 0;for (var h = 0; h < k.length; ++h) {var g = k[h];if (/HA-spellcheck-error/.test(g.className)) {j.push(g);g.__msh_wordClicked = wordClicked;g.onclick = (function (ev) {ev || (ev = window.event);ev && SpellChecker._stopEvent(ev);return this.__msh_wordClicked(false);});g.onmouseover = wordMouseOver;g.onmouseout = wordMouseOut;g.__msh_id = i++;var f = (g.__msh_origWord = g.firstChild.data);g.__msh_fixed = false;if (typeof allWords[f] == "undefined") {allWords[f] = [g];} else {allWords[f].push(g);}} else {if (/HA-spellcheck-fixed/.test(g.className)) {fixedWords.push(g);}}}var e = l.getElementById("HA-spellcheck-dictionaries");if (e) {e.parentNode.removeChild(e);e = e.innerHTML.split(/,/);var d = document.getElementById("v_dictionaries");for (var h = d.length; --h >= 0;) {d.remove(h);}for (var h = 0; h < e.length; ++h) {var f = e[h];var c = document.createElement("option");if (/^@(.*)$/.test(f)) {f = RegExp.$1;c.selected = true;}c.value = f;c.appendChild(document.createTextNode(f));d.appendChild(c);}}wrongWords = j;if (j.length == 0) {alert(i18n.NO_ERRORS);return false;}(currentElement = j[0]).__msh_wordClicked(true);var b = l.getElementsByTagName("a");for (var h = b.length; --h >= 0;) {var a = b[h];a.onclick = (function () {if (confirm(i18n.CONFIRM_LINK_CLICK + ":\n" + this.href + "\n" + i18n['I will open it in a new page.'])) {window.open(this.href);}return false;});}}