
var DHTMLSuite=new Object();var standardObjectsCreated=false;DHTMLSuite.eventElements=new Array();DHTMLSuite.createStandardObjects=function()
{DHTMLSuite.clientInfoObj=new DHTMLSuite.clientInfo();DHTMLSuite.clientInfoObj.init();if(!DHTMLSuite.configObj){DHTMLSuite.configObj=new DHTMLSuite.config();DHTMLSuite.configObj.init();}
DHTMLSuite.commonObj=new DHTMLSuite.common();DHTMLSuite.variableStorage=new DHTMLSuite.globalVariableStorage();;DHTMLSuite.commonObj.init();DHTMLSuite.domQueryObj=new DHTMLSuite.domQuery();window.onunload=function(){DHTMLSuite.commonObj.__clearGarbage();}
standardObjectsCreated=true;}
DHTMLSuite.config=function()
{var imagePath;var cssPath;var defaultCssPath;var defaultImagePath;}
DHTMLSuite.config.prototype={init:function()
{this.imagePath='/images/dhtmlsuite/';this.cssPath='/css/dhtmlsuite/';this.defaultCssPath=this.cssPath;this.defaultImagePath=this.imagePath;},setCssPath:function(newCssPath)
{this.cssPath=newCssPath;},resetCssPath:function()
{this.cssPath=this.defaultCssPath;},resetImagePath:function()
{this.imagePath=this.defaultImagePath;},setImagePath:function(newImagePath)
{this.imagePath=newImagePath;}}
DHTMLSuite.globalVariableStorage=function()
{var menuBar_highlightedItems;this.menuBar_highlightedItems=new Array();var arrayOfDhtmlSuiteObjects;this.arrayOfDhtmlSuiteObjects=new Array();var ajaxObjects;this.ajaxObjects=new Array();}
DHTMLSuite.globalVariableStorage.prototype={}
DHTMLSuite.common=function()
{var loadedCSSFiles;var cssCacheStatus;var eventElements;var isOkToSelect;this.okToSelect=true;this.cssCacheStatus=true;this.eventElements=new Array();}
DHTMLSuite.common.prototype={init:function()
{this.loadedCSSFiles=new Array();},loadCSS:function(cssFileName)
{if(!this.loadedCSSFiles[cssFileName]){this.loadedCSSFiles[cssFileName]=true;var linkTag=document.createElement('LINK');if(!this.cssCacheStatus){if(cssFileName.indexOf('?')>=0)cssFileName=cssFileName+'&';else cssFileName=cssFileName+'?';cssFileName=cssFileName+'rand='+Math.random();}
linkTag.href=DHTMLSuite.configObj.cssPath+cssFileName;linkTag.rel='stylesheet';linkTag.media='screen';linkTag.type='text/css';document.getElementsByTagName('HEAD')[0].appendChild(linkTag);}},getTopPos:function(inputObj)
{var returnValue=inputObj.offsetTop;while((inputObj=inputObj.offsetParent)!=null){if(inputObj.tagName!='HTML'){returnValue+=(inputObj.offsetTop-inputObj.scrollTop);if(document.all)returnValue+=inputObj.clientTop;}}
return returnValue;},__setOkToSelect:function(okToSelect){this.okToSelect=okToSelect;},__getOkToSelect:function()
{return this.okToSelect;},setCssCacheStatus:function(cssCacheStatus)
{this.cssCacheStatus=cssCacheStatus;},getLeftPos:function(inputObj)
{var returnValue=inputObj.offsetLeft;while((inputObj=inputObj.offsetParent)!=null){if(inputObj.tagName!='HTML'){returnValue+=inputObj.offsetLeft;if(document.all)returnValue+=inputObj.clientLeft;}}
return returnValue;},getCookie:function(name){var start=document.cookie.indexOf(name+"=");var len=start+name.length+1;if((!start)&&(name!=document.cookie.substring(0,name.length)))return null;if(start==-1)return null;var end=document.cookie.indexOf(";",len);if(end==-1)end=document.cookie.length;return unescape(document.cookie.substring(len,end));},setCookie:function(name,value,expires,path,domain,secure){expires=expires*60*60*24*1000;var today=new Date();var expires_date=new Date(today.getTime()+(expires));var cookieString=name+"="+escape(value)+
((expires)?";expires="+expires_date.toGMTString():"")+
((path)?";path="+path:"")+
((domain)?";domain="+domain:"")+
((secure)?";secure":"");document.cookie=cookieString;},cancelEvent:function()
{return false;},addEvent:function(whichObject,eventType,functionName)
{if(whichObject.attachEvent){whichObject['e'+eventType+functionName]=functionName;whichObject[eventType+functionName]=function(){whichObject['e'+eventType+functionName](window.event);}
whichObject.attachEvent('on'+eventType,whichObject[eventType+functionName]);}else
whichObject.addEventListener(eventType,functionName,false);this.__addEventElement(whichObject);},removeEvent:function(whichObject,eventType,functionName)
{if(whichObject.detachEvent){whichObject.detachEvent('on'+eventType,whichObject[eventType+functionName]);whichObject[eventType+functionName]=null;}else
whichObject.removeEventListener(eventType,functionName,false);},__clearGarbage:function()
{if(!DHTMLSuite.clientInfoObj.isMSIE)return;for(var no in DHTMLSuite.variableStorage.arrayOfDhtmlSuiteObjects){DHTMLSuite.variableStorage.arrayOfDhtmlSuiteObjects[no]=false;}
for(var no=0;no<DHTMLSuite.eventElements.length;no++){DHTMLSuite.eventElements[no].onclick=null;DHTMLSuite.eventElements[no].onmousedown=null;DHTMLSuite.eventElements[no].onmousemove=null;DHTMLSuite.eventElements[no].onmouseout=null;DHTMLSuite.eventElements[no].onmouseover=null;DHTMLSuite.eventElements[no].onmouseup=null;DHTMLSuite.eventElements[no].onfocus=null;DHTMLSuite.eventElements[no].onblur=null;DHTMLSuite.eventElements[no].onkeydown=null;DHTMLSuite.eventElements[no].onkeypress=null;DHTMLSuite.eventElements[no].onkeyup=null;DHTMLSuite.eventElements[no].onselectstart=null;DHTMLSuite.eventElements[no].ondragstart=null;DHTMLSuite.eventElements[no].oncontextmenu=null;DHTMLSuite.eventElements[no].onscroll=null;}
window.onunload=null;DHTMLSuite=null;},__addEventElement:function(el)
{DHTMLSuite.eventElements[DHTMLSuite.eventElements.length]=el;},getSrcElement:function(e)
{var el;if(e.target)el=e.target;else if(e.srcElement)el=e.srcElement;if(el.nodeType==3)
el=el.parentNode;return el;},isObjectClicked:function(obj,e)
{var src=this.getSrcElement(e);var string=src.tagName+'('+src.className+')';if(src==obj)return true;while(src.parentNode&&src.tagName.toLowerCase()!='html'){src=src.parentNode;string=string+','+src.tagName+'('+src.className+')';if(src==obj)return true;}
return false;}}
DHTMLSuite.clientInfo=function()
{var browser;var isOpera;var isMSIE;var isOldMSIE;var isFirefox;var navigatorVersion;}
DHTMLSuite.clientInfo.prototype={init:function()
{this.browser=navigator.userAgent;this.isOpera=(this.browser.toLowerCase().indexOf('opera')>=0)?true:false;this.isFirefox=(this.browser.toLowerCase().indexOf('firefox')>=0)?true:false;this.isMSIE=(this.browser.toLowerCase().indexOf('msie')>=0)?true:false;this.isOldMSIE=(this.browser.toLowerCase().match(/msie [0-6]/gi))?true:false;this.isSafari=(this.browser.toLowerCase().indexOf('safari')>=0)?true:false;this.navigatorVersion=navigator.appVersion.replace(/.*?MSIE (\d\.\d).*/g,'$1')/1;},getBrowserWidth:function()
{return document.documentElement.offsetWidth;},getBrowserHeight:function()
{return document.documentElement.offsetHeight;}}
DHTMLSuite.domQuery=function()
{document.getElementsByClassName=this.getElementsByClassName;document.getElementsByAttribute=this.getElementsByAttribute;}
DHTMLSuite.domQuery.prototype={getElementsByClassName:function(className,inputObj)
{var returnArray=new Array();if(inputObj)
var allElements=inputObj.getElementsByTagName('*');else
var allElements=document.getElementsByTagName('*');for(var no=0;no<allElements.length;no++){if(allElements[no].className==className)returnArray[returnArray.length]=allElements[no];}
return returnArray;},getElementsByAttribute:function(attribute,attributeValue,inputObj)
{var returnArray=new Array();if(inputObj)
var allElements=inputObj.getElementsByTagName('*');else
var allElements=document.getElementsByTagName('*');for(var no=0;no<allElements.length;no++){var att=allElements[no].getAttribute(attribute);if(!attributeValue){if(att)returnArray[returnArray.length]=allElements[no];}
else
if(att==attributeValue)returnArray[returnArray.length]=allElements[no];}
return returnArray;}}
DHTMLSuite.tableWidgetPageHandler=function()
{var tableRef;var targetRef;var txtPrevious;var txtNext;var txtResultPrefix;var txtResultTo;var txtResultOf;var totalNumberOfRows;var rowsPerPage;var layoutCSS;var activePageNumber;var mainDivElement;var resultDivElement;var pageListDivElement;var objectIndex;var linkPagePrefix;var linkPageSuffix;this.txtPrevious='Previous';this.txtNext='Next';this.txtResultPrefix='Result: ';this.txtResultTo='to';this.txtResultOf='of';this.tableRef=false;this.targetRef=false;this.totalNumberOfRows=false;this.activePageNumber=1;this.layoutCSS='table-widget-page-handler.css';this.linkPagePrefix='';this.linkPageSuffix='';this.objectIndex=DHTMLSuite.variableStorage.arrayOfDhtmlSuiteObjects.length;DHTMLSuite.variableStorage.arrayOfDhtmlSuiteObjects[this.objectIndex]=this;}
DHTMLSuite.tableWidgetPageHandler.prototype={setTableRef:function(tableRef)
{this.tableRef=tableRef;this.tableRef.setPageHandler(this);},setTargetId:function(targetId)
{if(!document.getElementById(targetId)){alert('ERROR IN tableWidgetPageHandler.setTargetId:\nElement with id '+targetId+' does not exists');return;}
this.targetRef=document.getElementById(targetId);},setTxtPrevious:function(newText)
{this.txtPrevious=newText;},setLinkPagePrefix:function(linkPagePrefix)
{this.linkPagePrefix=linkPagePrefix;},setLinkPageSuffix:function(linkPageSuffix)
{this.linkPageSuffix=linkPageSuffix;},setTxtNext:function(newText)
{this.txtNext=newText;},setTxtResultOf:function(txtResultOf)
{this.txtResultOf=txtResultOf;},setTxtResultTo:function(txtResultTo)
{this.txtResultTo=txtResultTo;},setTxtResultPrefix:function(txtResultPrefix)
{this.txtResultPrefix=txtResultPrefix;},setTotalNumberOfRows:function(totalNumberOfRows)
{this.totalNumberOfRows=totalNumberOfRows;},setLayoutCss:function(layoutCSS)
{this.layoutCSS=layoutCSS;},init:function()
{this.rowsPerPage=this.tableRef.getServersideSortNumberOfRows();DHTMLSuite.commonObj.loadCSS(this.layoutCSS);this.__createMainElements();this.__createResultList();this.__createPageLinks();},__createMainElements:function()
{if(!this.targetRef){alert('Error creating table widget page handler. Remember to specify targetRef');return;}
this.mainDivElement=document.createElement('DIV');this.mainDivElement.className='DHTMLSuite_tableWidgetPageHandler_mainDiv';this.targetRef.appendChild(this.mainDivElement);this.resultDivElement=document.createElement('DIV');this.resultDivElement.className='DHTMLSuite_tableWidgetPageHandler_result';this.mainDivElement.appendChild(this.resultDivElement);this.pageListDivElement=document.createElement('DIV');this.pageListDivElement.className='DHTMLSuite_tableWidgetPageHandler_pageList';this.mainDivElement.appendChild(this.pageListDivElement);},__createResultList:function()
{this.resultDivElement.innerHTML='';var html=this.txtResultPrefix+(((this.activePageNumber-1)*this.rowsPerPage)+1)+' '+this.txtResultTo+' '+Math.min(this.totalNumberOfRows,(this.activePageNumber*this.rowsPerPage))+' '+this.txtResultOf+' '+this.totalNumberOfRows;this.resultDivElement.innerHTML=html;},__createPageLinks:function()
{var ind=this.objectIndex;this.pageListDivElement.innerHTML='';var previousLink=document.createElement('A');previousLink.innerHTML=this.txtPrevious;previousLink.href='#';previousLink.id='previous';previousLink.onclick=function(e){return DHTMLSuite.variableStorage.arrayOfDhtmlSuiteObjects[ind].__navigate(e);}
this.pageListDivElement.appendChild(previousLink);DHTMLSuite.commonObj.__addEventElement(previousLink);if(this.activePageNumber==1)previousLink.className='previousLinkDisabled';else previousLink.className='previousLink';var numberOfPages=Math.ceil(this.totalNumberOfRows/this.rowsPerPage);for(var no=1;no<=numberOfPages;no++){var span=document.createElement('SPAN');span.innerHTML=this.linkPagePrefix;this.pageListDivElement.appendChild(span);var pageLink=document.createElement('A');if(no==this.activePageNumber)pageLink.className='DHTMLSuite_tableWidgetPageHandler_activePage';else pageLink.className='DHTMLSuite_tableWidgetPageHandler_inactivePage';pageLink.innerHTML=no;pageLink.href='#';pageLink.id='pageLink_'+no;pageLink.onclick=function(e){return DHTMLSuite.variableStorage.arrayOfDhtmlSuiteObjects[ind].__navigate(e);}
DHTMLSuite.commonObj.__addEventElement(pageLink);this.pageListDivElement.appendChild(pageLink);var span=document.createElement('SPAN');span.innerHTML=this.linkPageSuffix;this.pageListDivElement.appendChild(span);}
var nextLink=document.createElement('A');nextLink.innerHTML=this.txtNext;nextLink.id='next';nextLink.href='#';nextLink.onclick=function(e){return DHTMLSuite.variableStorage.arrayOfDhtmlSuiteObjects[ind].__navigate(e);}
DHTMLSuite.commonObj.__addEventElement(nextLink);this.pageListDivElement.appendChild(nextLink);if(this.activePageNumber==numberOfPages)nextLink.className='nextLinkDisabled';else nextLink.className='nextLink';},__navigate:function(e)
{if(document.all)e=event;var src=DHTMLSuite.commonObj.getSrcElement(e);var initActivePageNumber=this.activePageNumber;var numberOfPages=Math.ceil(this.totalNumberOfRows/this.rowsPerPage);if(src.id.indexOf('pageLink_')>=0){var pageNo=src.id.replace(/[^0-9]/gi,'')/1;this.activePageNumber=pageNo;}
if(src.id=='next'){this.activePageNumber++;if(this.activePageNumber>numberOfPages)this.activePageNumber=numberOfPages;}
if(src.id=='previous'){this.activePageNumber--;if(this.activePageNumber<1)this.activePageNumber=1;}
if(this.activePageNumber!=initActivePageNumber){this.tableRef.serversideSortCurrentStartIndex=((this.activePageNumber-1)*this.rowsPerPage);this.tableRef.__getItemsFromServer();this.__createResultList();this.__createPageLinks();}
return false;},__resetActivePageNumber:function()
{this.activePageNumber=1;this.__createResultList();this.__createPageLinks();}}
DHTMLSuite.tableWidget=function()
{var tableWidget_okToSort;var activeColumn;var idOfTable;var tableObj;var widthOfTable;var heightOfTable;var columnSortArray;var layoutCSS;var noCssLayout;var serversideSort;var serversideSortAscending;var tableCurrentlySortedBy;var serversideSortFileName;var serversideSortNumberOfRows;var serversideSortCurrentStartIndex;var serversideSortExtraSearchCriterias;var pageHandler;var objectIndex;this.serversideSort=false;this.serversideSortAscending=true;this.tableCurrentlySortedBy=false;this.serversideSortFileName=false;this.serversideSortCurrentStartIndex=0;this.serversideSortExtraSearchCriterias='';if(!standardObjectsCreated)DHTMLSuite.createStandardObjects();this.objectIndex=DHTMLSuite.variableStorage.arrayOfDhtmlSuiteObjects.length;DHTMLSuite.variableStorage.arrayOfDhtmlSuiteObjects[this.objectIndex]=this;}
DHTMLSuite.tableWidget.prototype={init:function()
{this.tableWidget_okToSort=true;this.activeColumn=false;if(!this.layoutCSS)this.layoutCSS='table-widget.css';DHTMLSuite.commonObj.loadCSS(this.layoutCSS);this.__initTableWidget();},setLayoutCss:function(newCssFile)
{this.layoutCSS=newCSSFile;},setServerSideSort:function(serversideSort)
{this.serversideSort=serversideSort;},setServersideSearchCriterias:function(serversideSortExtraSearchCriterias)
{this.serversideSortExtraSearchCriterias=serversideSortExtraSearchCriterias;},getServersideSortNumberOfRows:function(serversideSort)
{return this.serversideSortNumberOfRows;},setServersideSortNumberOfRows:function(serversideSortNumberOfRows)
{this.serversideSortNumberOfRows=serversideSortNumberOfRows;},setServersideSortFileName:function(serversideSortFileName)
{this.serversideSortFileName=serversideSortFileName;},setNoCssLayout:function()
{this.noCssLayout=true;},sortTableByColumn:function(columnIndex)
{var tableObj=document.getElementById(this.idOfTable);var firstRow=tableObj.rows[0];var tds=firstRow.cells;if(tds[columnIndex]&&this.columnSortArray[columnIndex]){this.__sortTable(tds[columnIndex]);}},setTableId:function(idOfTable)
{this.idOfTable=idOfTable;try{this.tableObj=document.getElementById(idOfTable);}catch(e){}},setTableWidth:function(width)
{this.widthOfTable=width;},setTableHeight:function(height)
{this.heightOfTable=height;},setColumnSort:function(columnSortArray)
{this.columnSortArray=columnSortArray;},addNewRow:function(cellContent)
{var tableObj=document.getElementById(this.idOfTable);var tbody=tableObj.getElementsByTagName('TBODY')[0];var row=tbody.insertRow(-1);for(var no=0;no<cellContent.length;no++){var cell=row.insertCell(-1);cell.innerHTML=cellContent[no];}
this.__parseDataRows(tableObj);},addNewColumn:function(columnContent,headerText,sortMethod)
{this.columnSortArray[this.columnSortArray.length]=sortMethod;var tableObj=document.getElementById(this.idOfTable);var tbody=tableObj.getElementsByTagName('TBODY')[0];var thead=tableObj.getElementsByTagName('THEAD')[0];var bodyRows=tbody.rows;var headerRows=thead.rows;cellIndexSubtract=1;if(DHTMLSuite.clientInfoObj.isMSIE)cellIndexSubtract=0;var headerCell=headerRows[0].insertCell(headerRows[0].cells.length-cellIndexSubtract);if(!this.noCssLayout)headerCell.className='DHTMLSuite_tableWidget_headerCell';headerCell.onselectstart=this.__cancelTableWidgetEvent;DHTMLSuite.commonObj.__addEventElement(headerCell);headerCell.innerHTML=headerText;if(sortMethod){this.__parseHeaderCell(headerCell);}else{headerCell.style.cursor='default';}
headerRows[0].cells[headerRows[0].cells.length-1].style.borderRightWidth='0px';headerRows[0].cells[headerRows[0].cells.length-2].style.borderRightWidth='1px';for(var no=0;no<columnContent.length;no++){var dataCell=bodyRows[no].insertCell(bodyRows[no].cells.length-cellIndexSubtract);dataCell.innerHTML=columnContent[no];}
this.__parseDataRows(tableObj);},setPageHandler:function(ref)
{this.pageHandler=ref;},__parseHeaderCell:function(inputCell)
{if(!this.noCssLayout){inputCell.onmouseover=this.__highlightTableHeader;inputCell.onmouseout=this.__deHighlightTableHeader;inputCell.onmousedown=this.__mousedownTableHeader;inputCell.onmouseup=this.__highlightTableHeader;}else{inputCell.style.cursor='pointer';}
var refToThis=this;inputCell.onclick=function(){refToThis.__sortTable(this);};DHTMLSuite.commonObj.__addEventElement(inputCell);var img=document.createElement('IMG');img.src=DHTMLSuite.configObj.imagePath+'arrow_up.gif';inputCell.appendChild(img);img.style.visibility='hidden';},__parseDataRows:function(parentObj)
{for(var no=1;no<parentObj.rows.length;no++){if(!this.noCssLayout){parentObj.rows[no].onmouseover=this.__highlightDataRow;parentObj.rows[no].onmouseout=this.__deHighlightDataRow;DHTMLSuite.commonObj.__addEventElement(parentObj.rows[no]);}
for(var no2=0;no2<this.columnSortArray.length;no2++){try{if(this.columnSortArray[no2]&&this.columnSortArray[no2]=='N')parentObj.rows[no].cells[no2].style.textAlign='right';}catch(e){alert('Error in __parseDataRows method - row: '+no+', column : '+no2);}}}
for(var no2=0;no2<this.columnSortArray.length;no2++){if(this.columnSortArray[no2]&&this.columnSortArray[no2]=='N')parentObj.rows[0].cells[no2].style.textAlign='right';}},__initTableWidget:function()
{if(!this.columnSortArray)this.columnSortArray=new Array();this.widthOfTable=this.widthOfTable+'';this.heightOfTable=this.heightOfTable+'';var obj=document.getElementById(this.idOfTable);obj.parentNode.className='DHTMLSuite_widget_tableDiv';if(navigator.userAgent.toLowerCase().indexOf('safari')==-1&&!this.noCssLayout){if(!DHTMLSuite.clientInfoObj.isMSIE)
obj.parentNode.style.overflow='hidden';else{obj.parentNode.style.overflowX='hidden';obj.parentNode.style.overflowY='scroll';}}
if(!this.noCssLayout){if(this.widthOfTable.indexOf('%')>=0){obj.style.width='100%';obj.parentNode.style.width=this.widthOfTable;}else{obj.style.width=this.widthOfTable+'px';obj.parentNode.style.width=this.widthOfTable+'px';}
if(this.heightOfTable.indexOf('%')>=0){obj.parentNode.style.height=this.heightOfTable;}else{obj.parentNode.style.height=this.heightOfTable+'px';}}
if(!DHTMLSuite.clientInfoObj.isMSIE){this.__addEndCol(obj);}else{obj.style.cssText='width:expression(this.parentNode.clientWidth)';}
obj.cellSpacing=0;obj.cellPadding=0;if(!this.noCssLayout)obj.className='DHTMLSuite_tableWidget';var tHead=obj.getElementsByTagName('THEAD')[0];var cells=tHead.getElementsByTagName('TD');var tBody=obj.getElementsByTagName('TBODY')[0];tBody.className='DHTMLSuite_scrollingContent';if(DHTMLSuite.clientInfoObj.isMSIE&&1==2){lastCell=tHead.rows[0].insertCell(-1);lastCell.innerHTML='&nbsp;&nbsp;&nbsp;';lastCell.className='DHTMLSuite_tableWidget_MSIESPACER';}
for(var no=0;no<cells.length;no++){if(!this.noCssLayout)cells[no].className='DHTMLSuite_tableWidget_headerCell';cells[no].onselectstart=this.__cancelTableWidgetEvent;DHTMLSuite.commonObj.__addEventElement(cells[no]);if(no==cells.length-1&&!this.noCssLayout){cells[no].style.borderRightWidth='0px';}
if(this.columnSortArray[no]){this.__parseHeaderCell(cells[no]);}else{cells[no].style.cursor='default';}}
if(!this.noCssLayout){var tBody=obj.getElementsByTagName('TBODY')[0];if(document.all&&navigator.userAgent.indexOf('Opera')<0){tBody.className='DHTMLSuite_scrollingContent';tBody.style.display='block';}else{if(!this.noCssLayout)tBody.className='DHTMLSuite_scrollingContent';tBody.style.height=(obj.parentNode.clientHeight-tHead.offsetHeight)+'px';if(navigator.userAgent.indexOf('Opera')>=0){obj.parentNode.style.overflow='auto';}}}
this.__parseDataRows(obj);if(this.serversideSort)this.__autoSetColumnWidth();var ind=this.objectIndex;DHTMLSuite.commonObj.addEvent(window,"resize",function(){DHTMLSuite.variableStorage.arrayOfDhtmlSuiteObjects[ind].__autoSetColumnWidth();});},__addEndCol:function(obj)
{var rows=obj.getElementsByTagName('TR');for(var no=0;no<rows.length;no++){var cell=rows[no].insertCell(rows[no].cells.length);cell.innerHTML='<img src="'+DHTMLSuite.configObj.imagePath+'transparent.gif" width="10" style="visibility:hidden">';cell.style.width='13px';cell.width='13';cell.style.overflow='hidden';}},__highlightTableHeader:function()
{this.className='DHTMLSuite_tableWigdet_headerCellOver';if(document.all){var divObj=this.parentNode.parentNode.parentNode.parentNode;this.parentNode.style.top=divObj.scrollTop+'px';}},__deHighlightTableHeader:function()
{this.className='DHTMLSuite_tableWidget_headerCell';},__mousedownTableHeader:function()
{this.className='DHTMLSuite_tableWigdet_headerCellDown';if(document.all){var divObj=this.parentNode.parentNode.parentNode.parentNode;this.parentNode.style.top=divObj.scrollTop+'px';}},__sortNumeric:function(a,b){a=a.replace(/,/,'.');b=b.replace(/,/,'.');a=a.replace(/[^\d\.\/]/g,'');b=b.replace(/[^\d\.\/]/g,'');if(a.indexOf('/')>=0)a=eval(a);if(b.indexOf('/')>=0)b=eval(b);return a/1-b/1;},__sortString:function(a,b){if(a.toUpperCase()<b.toUpperCase())return-1;if(a.toUpperCase()>b.toUpperCase())return 1;return 0;},__cancelTableWidgetEvent:function()
{return false;},__parseDataContentFromServer:function(ajaxIndex)
{var content=DHTMLSuite.variableStorage.ajaxObjects[ajaxIndex].response;if(content.indexOf('|||')==-1&&content.indexOf('###')==-1){alert('Error in data from server\n'+content);return;}
this.__clearDataRows();var rows=content.split('|||');for(var no=0;no<rows.length;no++){var items=rows[no].split('###');if(items.length>1)this.__fillDataRow(items);}
this.__parseDataRows(this.tableObj);},__clearDataRows:function()
{if(!this.tableObj)this.tableObj=document.getElementById(this.idOfTable);while(this.tableObj.rows.length>1){this.tableObj.rows[this.tableObj.rows.length-1].parentNode.removeChild(this.tableObj.rows[this.tableObj.rows.length-1]);}},__fillDataRow:function(data)
{if(!this.tableObj)this.tableObj=document.getElementById(this.idOfTable);var tbody=this.tableObj.getElementsByTagName('TBODY')[0];var row=tbody.insertRow(-1);for(var no=0;no<data.length;no++){var cell=row.insertCell(no);cell.innerHTML=data[no];}},__autoSetColumnWidth:function()
{return;if(!this.tableObj)this.tableObj=document.getElementById(this.idOfTable);var colgroup=this.tableObj.getElementsByTagName('COLGROUP')[0];if(!colgroup){colgroup=document.createElement('COLGROUP');this.tableObj.insertBefore(colgroup,this.tableObj.firstChild);var noCells=this.tableObj.getElementsByTagName('TR')[0].cells.length;for(var no=0;no<noCells;no++){var col=document.createElement('COL');colgroup.appendChild(col);}}
var cols=colgroup.getElementsByTagName('COL');var cells=this.tableObj.getElementsByTagName('TR')[1].cells;for(var no=0;no<cells.length;no++){if(!cols[no].style.width)cols[no].style.width=cells[no].clientWidth+'px';}},updateTableHeader:function(columnIndex,direction)
{var tableObj=document.getElementById(this.idOfTable);var firstRow=tableObj.rows[0];var tds=firstRow.cells;var tdObj=tds[columnIndex];tdObj.setAttribute('direction',direction);tdObj.direction=direction;var sortBy=tdObj.getAttribute('sortBy');if(!sortBy)sortBy=tdObj.sortBy;this.tableCurrentlySortedBy=sortBy;this.__updateSortArrow(tdObj,direction);},__updateSortArrow:function(obj,direction)
{var images=obj.getElementsByTagName('IMG');if(direction=='descending'){images[0].src=images[0].src.replace('arrow_up','arrow_down');images[0].style.visibility='visible';}else{images[0].src=images[0].src.replace('arrow_down','arrow_up');images[0].style.visibility='visible';}
if(this.activeColumn&&this.activeColumn!=obj){var images=this.activeColumn.getElementsByTagName('IMG');images[0].style.visibility='hidden';this.activeColumn.removeAttribute('direction');}
this.activeColumn=obj;},__getItemsFromServer:function()
{var objIndex=this.objectIndex;var url=this.serversideSortFileName+'?sortBy='+this.tableCurrentlySortedBy+'&numberOfRows='+this.serversideSortNumberOfRows+'&sortAscending='+this.serversideSortAscending+'&startIndex='+this.serversideSortCurrentStartIndex+this.serversideSortExtraSearchCriterias;var index=DHTMLSuite.variableStorage.ajaxObjects.length;try{DHTMLSuite.variableStorage.ajaxObjects[index]=new sack();}catch(e){alert('Unable to create ajax object. Please make sure that the sack js file is included on your page');return;}
DHTMLSuite.variableStorage.ajaxObjects[index].requestFile=url;DHTMLSuite.variableStorage.ajaxObjects[index].onCompletion=function(){DHTMLSuite.variableStorage.arrayOfDhtmlSuiteObjects[objIndex].__parseDataContentFromServer(index);};DHTMLSuite.variableStorage.ajaxObjects[index].runAJAX();},__sortTable:function(obj)
{if(this.serversideSort){if(!this.serversideSortFileName){alert('No server side file defined. Use the setServersideSortFileName to specify where to send the ajax request');return;}
var sortBy=obj.getAttribute('sortBy');if(!sortBy)sortBy=obj.sortBy;if(!sortBy){alert('Sort is not defined. Remember to set a sortBy attribute on the header <td> tags');return;}
if(sortBy==this.tableCurrentlySortedBy)this.serversideSortAscending=!this.serversideSortAscending;else this.serversideSortAscending=true;this.tableCurrentlySortedBy=sortBy;this.serversideSortCurrentStartIndex=0;this.__getItemsFromServer();if(this.pageHandler)this.pageHandler.__resetActivePageNumber();this.__updateSortArrow(obj,this.serversideSortAscending?'ascending':'descending');return;}
if(!this.tableWidget_okToSort)return;this.tableWidget_okToSort=false;var indexThis=0;var tmpObj=obj;while(tmpObj.previousSibling){tmpObj=tmpObj.previousSibling;if(tmpObj.tagName=='TD')indexThis++;}
if(obj.getAttribute('direction')||obj.direction){direction=obj.getAttribute('direction');if(navigator.userAgent.indexOf('Opera')>=0)direction=obj.direction;if(direction=='ascending'){direction='descending';obj.setAttribute('direction','descending');obj.direction='descending';}else{direction='ascending';obj.setAttribute('direction','ascending');obj.direction='ascending';}}else{direction='ascending';obj.setAttribute('direction','ascending');obj.direction='ascending';}
this.__updateSortArrow(obj,direction);var tableObj=obj.parentNode.parentNode.parentNode;var tBody=tableObj.getElementsByTagName('TBODY')[0];var widgetIndex=tableObj.id.replace(/[^\d]/g,'');var sortMethod=this.columnSortArray[indexThis];var cellArray=new Array();var cellObjArray=new Array();for(var no=1;no<tableObj.rows.length;no++){var content=tableObj.rows[no].cells[indexThis].innerHTML+'';cellArray.push(content);cellObjArray.push(tableObj.rows[no].cells[indexThis]);}
if(sortMethod=='N'){cellArray=cellArray.sort(this.__sortNumeric);}else{cellArray=cellArray.sort(this.__sortString);}
if(direction=='descending'){for(var no=cellArray.length;no>=0;no--){for(var no2=0;no2<cellObjArray.length;no2++){if(cellObjArray[no2].innerHTML==cellArray[no]&&!cellObjArray[no2].getAttribute('allreadySorted')){cellObjArray[no2].setAttribute('allreadySorted','1');tBody.appendChild(cellObjArray[no2].parentNode);}}}}else{for(var no=0;no<cellArray.length;no++){for(var no2=0;no2<cellObjArray.length;no2++){if(cellObjArray[no2].innerHTML==cellArray[no]&&!cellObjArray[no2].getAttribute('allreadySorted')){cellObjArray[no2].setAttribute('allreadySorted','1');tBody.appendChild(cellObjArray[no2].parentNode);}}}}
for(var no2=0;no2<cellObjArray.length;no2++){cellObjArray[no2].removeAttribute('allreadySorted');}
this.tableWidget_okToSort=true;},__highlightDataRow:function()
{if(navigator.userAgent.indexOf('Opera')>=0)return;this.className='DHTMLSuite_tableWidget_dataRollOver';if(document.all){var divObj=this.parentNode.parentNode.parentNode;var tHead=divObj.getElementsByTagName('TR')[0];tHead.style.top=divObj.scrollTop+'px';}},__deHighlightDataRow:function()
{if(navigator.userAgent.indexOf('Opera')>=0)return;this.className=null;if(document.all){var divObj=this.parentNode.parentNode.parentNode;var tHead=divObj.getElementsByTagName('TR')[0];tHead.style.top=divObj.scrollTop+'px';}}}
DHTMLSuite.dragDrop=function()
{var mouse_x;var mouse_y;var el_x;var el_y;var dragDropTimer;var numericIdToBeDragged;var dragObjCloneArray;var dragDropSourcesArray;var dragDropTargetArray;var currentZIndex;var okToStartDrag;var moveBackBySliding;var dragX_allowed;var dragY_allowed;var currentEl_allowX;var currentEl_allowY;var drag_minX;var drag_maxX;var drag_minY;var drag_maxY;var dragInProgress;if(!standardObjectsCreated)DHTMLSuite.createStandardObjects();this.dragX_allowed=true;this.dragY_allowed=true;this.currentZIndex=21000;this.dragDropTimer=-1;this.dragObjCloneArray=new Array();this.numericIdToBeDragged=false;this.okToStartDrag=true;this.moveBackBySliding=true;this.dragInProgress=false;var objectIndex;this.objectIndex=DHTMLSuite.variableStorage.arrayOfDhtmlSuiteObjects.length;DHTMLSuite.variableStorage.arrayOfDhtmlSuiteObjects[this.objectIndex]=this;}
DHTMLSuite.dragDrop.prototype={init:function()
{this.__initDragDropScript();},addSource:function(sourceId,slideBackAfterDrop,xAxis,yAxis,dragOnlyWithinElId)
{if(!this.dragDropSourcesArray)this.dragDropSourcesArray=new Array();if(!document.getElementById(sourceId)){alert('The source element with id '+sourceId+' does not exists. Check your HTML code');return;}
if(xAxis!==false)xAxis=true;if(yAxis!==false)yAxis=true;var obj=document.getElementById(sourceId);this.dragDropSourcesArray[this.dragDropSourcesArray.length]=[obj,slideBackAfterDrop,xAxis,yAxis,dragOnlyWithinElId];obj.setAttribute('dragableElement',this.dragDropSourcesArray.length-1);obj.dragableElement=this.dragDropSourcesArray.length-1;},addTarget:function(targetId,functionToCallOnDrop)
{if(!this.dragDropTargetArray)this.dragDropTargetArray=new Array();if(!document.getElementById(targetId))alert('The target element with id '+targetId+' does not exists.  Check your HTML code');var obj=document.getElementById(targetId);this.dragDropTargetArray[this.dragDropTargetArray.length]=[obj,functionToCallOnDrop];},setSlide:function(slide)
{this.moveBackBySliding=slide;},__initDragDropScript:function()
{var ind=this.objectIndex;var refToThis=this;var startIndex=Math.random()+'';startIndex=startIndex.replace('.','')/1;for(var no=0;no<this.dragDropSourcesArray.length;no++){var el=this.dragDropSourcesArray[no][0].cloneNode(true);eval("el.onmousedown =function(e,index){ DHTMLSuite.variableStorage.arrayOfDhtmlSuiteObjects["+ind+"].__initDragDropElement(e,"+no+"); }");DHTMLSuite.commonObj.__addEventElement(el);var tmpIndex=startIndex+no;el.id='DHTMLSuite_dragableElement'+tmpIndex;el.style.position='absolute';el.style.visibility='hidden';el.style.display='none';document.body.appendChild(el);el.style.top=DHTMLSuite.commonObj.getTopPos(this.dragDropSourcesArray[no][0])+'px';el.style.left=DHTMLSuite.commonObj.getLeftPos(this.dragDropSourcesArray[no][0])+'px';eval("this.dragDropSourcesArray["+no+"][0].onmousedown =function(e,index){ return DHTMLSuite.variableStorage.arrayOfDhtmlSuiteObjects["+ind+"].__initDragDropElement(e,"+no+"); }");DHTMLSuite.commonObj.__addEventElement(this.dragDropSourcesArray[no][0]);this.dragObjCloneArray[no]=el;}
eval("DHTMLSuite.commonObj.addEvent(document.documentElement,\"mousemove\",function(e){ DHTMLSuite.variableStorage.arrayOfDhtmlSuiteObjects["+ind+"].__moveDragableElement(e); } )");eval("DHTMLSuite.commonObj.addEvent(document.documentElement,\"mouseup\",function(e){ DHTMLSuite.variableStorage.arrayOfDhtmlSuiteObjects["+ind+"].__stop_dragDropElement(e); } );");if(!document.documentElement.onselectstart)document.documentElement.onselectstart=function(){return DHTMLSuite.commonObj.__getOkToSelect();};document.documentElement.ondragstart=function(){return DHTMLSuite.commonObj.cancelEvent()};DHTMLSuite.commonObj.__addEventElement(document.documentElement);},__initDragDropElement:function(e,index)
{var ind=this.objectIndex;if(!this.okToStartDrag)return false;setTimeout('DHTMLSuite.variableStorage.arrayOfDhtmlSuiteObjects['+ind+'].okToStartDrag = true;',100);if(document.all)e=event;this.numericIdToBeDragged=index;this.numericIdToBeDragged=this.numericIdToBeDragged+'';this.dragDropTimer=0;DHTMLSuite.commonObj.__setOkToSelect(false);this.mouse_x=e.clientX;this.mouse_y=e.clientY;this.currentZIndex=this.currentZIndex+1;this.dragObjCloneArray[this.numericIdToBeDragged].style.zIndex=this.currentZIndex;this.currentEl_allowX=this.dragDropSourcesArray[this.numericIdToBeDragged][2];this.currentEl_allowY=this.dragDropSourcesArray[this.numericIdToBeDragged][3];var parentEl=this.dragDropSourcesArray[this.numericIdToBeDragged][4];this.drag_minX=false;this.drag_minY=false;this.drag_maxX=false;this.drag_maxY=false;if(parentEl){var obj=document.getElementById(parentEl);if(obj){this.drag_minX=DHTMLSuite.commonObj.getLeftPos(obj);this.drag_minY=DHTMLSuite.commonObj.getTopPos(obj);this.drag_maxX=this.drag_minX+obj.clientWidth;this.drag_maxY=this.drag_minY+obj.clientHeight;}}
if(this.dragDropSourcesArray[this.numericIdToBeDragged][1]){this.dragObjCloneArray[this.numericIdToBeDragged].style.top=DHTMLSuite.commonObj.getTopPos(this.dragDropSourcesArray[this.numericIdToBeDragged][0])+'px';this.dragObjCloneArray[this.numericIdToBeDragged].style.left=DHTMLSuite.commonObj.getLeftPos(this.dragDropSourcesArray[this.numericIdToBeDragged][0])+'px';}
this.el_x=this.dragObjCloneArray[this.numericIdToBeDragged].style.left.replace('px','')/1;this.el_y=this.dragObjCloneArray[this.numericIdToBeDragged].style.top.replace('px','')/1;this.__timerDragDropElement();return false;},__timerDragDropElement:function()
{var ind=this.objectIndex;if(this.dragDropTimer>=0&&this.dragDropTimer<5){this.dragDropTimer=this.dragDropTimer+1;setTimeout('DHTMLSuite.variableStorage.arrayOfDhtmlSuiteObjects['+ind+'].__timerDragDropElement()',2);return;}
if(this.dragDropTimer>=5){if(this.dragObjCloneArray[this.numericIdToBeDragged].style.display=='none'){this.dragDropSourcesArray[this.numericIdToBeDragged][0].style.visibility='hidden';this.dragObjCloneArray[this.numericIdToBeDragged].style.display='block';this.dragObjCloneArray[this.numericIdToBeDragged].style.visibility='visible';this.dragObjCloneArray[this.numericIdToBeDragged].style.top=DHTMLSuite.commonObj.getTopPos(this.dragDropSourcesArray[this.numericIdToBeDragged][0])+'px';this.dragObjCloneArray[this.numericIdToBeDragged].style.left=DHTMLSuite.commonObj.getLeftPos(this.dragDropSourcesArray[this.numericIdToBeDragged][0])+'px';}}},__moveDragableElement:function(e)
{var ind=this.objectIndex;if(document.all)e=event;if(this.dragDropTimer<5)return false;if(this.dragInProgress)return false;this.dragInProgress=true;var dragObj=this.dragObjCloneArray[this.numericIdToBeDragged];if(this.currentEl_allowX){var leftPos=(e.clientX-this.mouse_x+this.el_x);if(this.drag_maxX){var tmpMaxX=this.drag_maxX-dragObj.offsetWidth;if(leftPos>tmpMaxX)leftPos=tmpMaxX
if(leftPos<this.drag_minX)leftPos=this.drag_minX;}
dragObj.style.left=leftPos+'px';}
if(this.currentEl_allowY){var topPos=(e.clientY-this.mouse_y+this.el_y);if(this.drag_maxY){var tmpMaxY=this.drag_maxY-dragObj.offsetHeight;if(topPos>tmpMaxY)topPos=tmpMaxY;if(topPos<this.drag_minY)topPos=this.drag_minY;}
dragObj.style.top=topPos+'px';}
this.dragInProgress=false;return false;},__stop_dragDropElement:function(e)
{if(this.dragDropTimer<5)return false;if(document.all)e=event;var dropDestination=DHTMLSuite.commonObj.getSrcElement(e);var leftPosMouse=e.clientX+Math.max(document.body.scrollLeft,document.documentElement.scrollLeft);var topPosMouse=e.clientY+Math.max(document.body.scrollTop,document.documentElement.scrollTop);if(!this.dragDropTargetArray)this.dragDropTargetArray=new Array();for(var no=0;no<this.dragDropTargetArray.length;no++){var leftPosEl=DHTMLSuite.commonObj.getLeftPos(this.dragDropTargetArray[no][0]);var topPosEl=DHTMLSuite.commonObj.getTopPos(this.dragDropTargetArray[no][0]);var widthEl=this.dragDropTargetArray[no][0].offsetWidth;var heightEl=this.dragDropTargetArray[no][0].offsetHeight;if(leftPosMouse>leftPosEl&&leftPosMouse<(leftPosEl+widthEl)&&topPosMouse>topPosEl&&topPosMouse<(topPosEl+heightEl)){if(this.dragDropTargetArray[no][1]){try{eval(this.dragDropTargetArray[no][1]+'("'+this.dragDropSourcesArray[this.numericIdToBeDragged][0].id+'","'+this.dragDropTargetArray[no][0].id+'",'+e.clientX+','+e.clientY+')');}catch(e){alert('Unable to execute \n'+this.dragDropTargetArray[no][1]+'("'+this.dragDropSourcesArray[this.numericIdToBeDragged][0].id+'","'+this.dragDropTargetArray[no][0].id+'",'+e.clientX+','+e.clientY+')');}}
break;}}
if(this.dragDropSourcesArray[this.numericIdToBeDragged][1]){this.__slideElementBackIntoItsOriginalPosition(this.numericIdToBeDragged);}
this.dragDropTimer=-1;DHTMLSuite.commonObj.__setOkToSelect(true);this.numericIdToBeDragged=false;},__slideElementBackIntoItsOriginalPosition:function(numId)
{var currentX=this.dragObjCloneArray[numId].style.left.replace('px','')/1;var currentY=this.dragObjCloneArray[numId].style.top.replace('px','')/1;var targetX=DHTMLSuite.commonObj.getLeftPos(this.dragDropSourcesArray[numId][0]);var targetY=DHTMLSuite.commonObj.getTopPos(this.dragDropSourcesArray[numId][0]);;if(this.moveBackBySliding){this.__processSlide(numId,currentX,currentY,targetX,targetY);}else{this.dragObjCloneArray[numId].style.display='none';this.dragDropSourcesArray[numId][0].style.visibility='visible';}},__processSlide:function(numId,currentX,currentY,targetX,targetY)
{var slideX=Math.round(Math.abs(Math.max(currentX,targetX)-Math.min(currentX,targetX))/10);var slideY=Math.round(Math.abs(Math.max(currentY,targetY)-Math.min(currentY,targetY))/10);if(slideY<3&&Math.abs(slideX)<10)slideY=3;if(slideX<3&&Math.abs(slideY)<10)slideX=3;if(currentX>targetX)slideX*=-1;if(currentY>targetY)slideY*=-1;currentX=currentX+slideX;currentY=currentY+slideY;if(Math.max(currentX,targetX)-Math.min(currentX,targetX)<4)currentX=targetX;if(Math.max(currentY,targetY)-Math.min(currentY,targetY)<4)currentY=targetY;this.dragObjCloneArray[numId].style.left=currentX+'px';this.dragObjCloneArray[numId].style.top=currentY+'px';if(currentX!=targetX||currentY!=targetY){window.thisRef=this;setTimeout('window.thisRef.__processSlide("'+numId+'",'+currentX+','+currentY+','+targetX+','+targetY+')',5);}else{this.dragObjCloneArray[numId].style.display='none';this.dragDropSourcesArray[numId][0].style.visibility='visible';}}}
var refToTabViewObjects=new Array();DHTMLSuite.tabView=function()
{var textPadding;var strictDocType;var tabView_maxNumberOfTabs;var DHTMLSuite_tabObj;var activeTabIndex;var initActiveTabIndex;var ajaxObjects;var tabView_countTabs;var tabViewHeight;var tabSetParentId;var tabTitles;var width;var height;var layoutCSS;var outsideObjectRefIndex;var maxNumberOfTabs;var dynamicContentObj;var closeButtons;this.textPadding=3;this.strictDocType=true;this.ajaxObjects=new Array();this.tabTitles=new Array();this.layoutCSS='tab-view.css';this.maxNumberOfTabs=6;this.dynamicContentObj=false;this.closeButtons=new Array();if(!standardObjectsCreated)DHTMLSuite.createStandardObjects();}
DHTMLSuite.tabView.prototype={init:function()
{DHTMLSuite.commonObj.loadCSS(this.layoutCSS);this.outsideObjectRefIndex=refToTabViewObjects.length;refToTabViewObjects[this.outsideObjectRefIndex]=this;this.dynamicContentObj=new DHTMLSuite.dynamicContent();this.__initTabs(false,false);},setMaximumTabs:function(maxTabs)
{this.maxNumberOfTabs=maxTabs;},setParentId:function(newParentDiv)
{this.tabSetParentId=newParentDiv;this.DHTMLSuite_tabObj=document.getElementById(newParentDiv);},setWidth:function(newWidth)
{this.width=newWidth;},setHeight:function(newHeight)
{this.height=newHeight;},setIndexActiveTab:function(indexOfNewActiveTab)
{this.initActiveTabIndex=indexOfNewActiveTab;},setTabTitles:function(titleOfTabs)
{this.tabTitles=titleOfTabs;},setCloseButtons:function(closeButtons)
{this.closeButtons=closeButtons;},createNewTab:function(parentId,tabTitle,tabContent,tabContentUrl,closeButton)
{if(this.tabView_countTabs>=this.maxNumberOfTabs)return;var div=document.createElement('DIV');div.className='DHTMLSuite_aTab';this.DHTMLSuite_tabObj.appendChild(div);var tabId=this.__initTabs(true,tabTitle,closeButton);if(tabContent)div.innerHTML=tabContent;if(tabContentUrl){this.dynamicContentObj.loadContent('tabView'+parentId+'_'+tabId,tabContentUrl);}},deleteTab:function(tabLabel,tabIndex)
{if(tabLabel){var index=this.getTabIndexByTitle(tabLabel);if(index!=-1){this.deleteTab(false,index);}}else if(tabIndex>=0){if(document.getElementById('tabTab'+this.tabSetParentId+'_'+tabIndex)){var obj=document.getElementById('tabTab'+this.tabSetParentId+'_'+tabIndex);var id=obj.parentNode.parentNode.id;obj.parentNode.removeChild(obj);var obj2=document.getElementById('tabView'+this.tabSetParentId+'_'+tabIndex);obj2.parentNode.removeChild(obj2);this.__resetTabIds(this.tabSetParentId);this.initActiveTabIndex=-1;var newIndex=0;if(refToTabViewObjects[this.outsideObjectRefIndex].activeTabIndex==tabIndex)refToTabViewObjects[this.outsideObjectRefIndex].activeTabIndex=-1;this.__showTab(this.tabSetParentId,newIndex,this.outsideObjectRefIndex);}}},addContentToTab:function(tabLabel,filePath)
{var index=this.getTabIndexByTitle(tabLabel);if(index!=-1){this.dynamicContentObj.loadContent('tabView'+this.tabSetParentId+'_'+index,filePath);}},displayATab:function(tabLabel,tabIndex)
{if(tabLabel){var index=this.getTabIndexByTitle(tabLabel);if(index!=-1){this.initActiveTabIndex=index;}else return false;}else{this.initActiveTabIndex=tabIndex;}
this.__showTab(this.tabSetParentId,this.initActiveTabIndex,this.outsideObjectRefIndex)},__setPadding:function(obj,padding){var span=obj.getElementsByTagName('SPAN')[0];span.style.paddingLeft=padding+'px';span.style.paddingRight=padding+'px';},__showTab:function(parentId,tabIndex,objectIndex)
{var parentId_div=parentId+"_";if(!document.getElementById('tabView'+parentId_div+tabIndex)){return;}
if(refToTabViewObjects[objectIndex].activeTabIndex>=0){if(refToTabViewObjects[objectIndex].activeTabIndex==tabIndex){return;}
var obj=document.getElementById('tabTab'+parentId_div+refToTabViewObjects[objectIndex].activeTabIndex);if(!obj){refToTabViewObjects[objectIndex].activeTabIndex=0;var obj=document.getElementById('tabTab'+parentId_div+refToTabViewObjects[objectIndex].activeTabIndex);}
obj.className='tabInactive';obj.style.backgroundImage='url(\''+DHTMLSuite.configObj.imagePath+'tab_left_inactive.gif'+'\')';var imgs=obj.getElementsByTagName('IMG');var img=imgs[imgs.length-1];img.src=DHTMLSuite.configObj.imagePath+'tab_right_inactive.gif';document.getElementById('tabView'+parentId_div+refToTabViewObjects[objectIndex].activeTabIndex).style.display='none';}
var thisObj=document.getElementById('tabTab'+parentId_div+tabIndex);thisObj.className='tabActive';thisObj.style.backgroundImage='url(\''+DHTMLSuite.configObj.imagePath+'tab_left_active.gif'+'\')';var imgs=thisObj.getElementsByTagName('IMG');var img=imgs[imgs.length-1];img.src=DHTMLSuite.configObj.imagePath+'tab_right_active.gif';document.getElementById('tabView'+parentId_div+tabIndex).style.display='block';refToTabViewObjects[objectIndex].activeTabIndex=tabIndex;var parentObj=thisObj.parentNode;var aTab=parentObj.getElementsByTagName('DIV')[0];countObjects=0;var startPos=2;var previousObjectActive=false;while(aTab){if(aTab.tagName=='DIV'){if(previousObjectActive){previousObjectActive=false;startPos-=2;}
if(aTab==thisObj){startPos-=2;previousObjectActive=true;refToTabViewObjects[objectIndex].__setPadding(aTab,refToTabViewObjects[objectIndex].textPadding+1);}else{refToTabViewObjects[objectIndex].__setPadding(aTab,refToTabViewObjects[objectIndex].textPadding);}
aTab.style.left=startPos+'px';countObjects++;startPos+=2;}
aTab=aTab.nextSibling;}
return;},__tabClick:function(inputObj,index)
{var idArray=inputObj.id.split('_');var parentId=inputObj.getAttribute('parentRefId');if(!parentId)parentId=inputObj.parentRefId;this.__showTab(parentId,idArray[idArray.length-1].replace(/[^0-9]/gi,''),index);},__rolloverTab:function()
{if(this.className.indexOf('tabInactive')>=0){this.className='inactiveTabOver';this.style.backgroundImage='url(\''+DHTMLSuite.configObj.imagePath+'tab_left_over.gif'+'\')';var imgs=this.getElementsByTagName('IMG');var img=imgs[imgs.length-1];img.src=DHTMLSuite.configObj.imagePath+'tab_right_over.gif';}},__rolloutTab:function()
{if(this.className=='inactiveTabOver'){this.className='tabInactive';this.style.backgroundImage='url(\''+DHTMLSuite.configObj.imagePath+'tab_left_inactive.gif'+'\')';var imgs=this.getElementsByTagName('IMG');var img=imgs[imgs.length-1];img.src=DHTMLSuite.configObj.imagePath+'tab_right_inactive.gif';}},__initTabs:function(additionalTab,nameOfAdditionalTab,additionalCloseButton)
{this.DHTMLSuite_tabObj.className=' DHTMLSuite_tabWidget';window.refToThisTabSet=this;if(!additionalTab||additionalTab=='undefined'){this.DHTMLSuite_tabObj=document.getElementById(this.tabSetParentId);this.width=this.width+'';if(this.width.indexOf('%')<0)this.width=this.width+'px';this.DHTMLSuite_tabObj.style.width=this.width;this.height=this.height+'';if(this.height.length>0){if(this.height.indexOf('%')<0)this.height=this.height+'px';this.DHTMLSuite_tabObj.style.height=this.height;}
var tabDiv=document.createElement('DIV');var firstDiv=this.DHTMLSuite_tabObj.getElementsByTagName('DIV')[0];this.DHTMLSuite_tabObj.insertBefore(tabDiv,firstDiv);tabDiv.className='DHTMLSuite_tabContainer';this.tabView_countTabs=0;var tmpTabTitles=this.tabTitles;}else{var tabDiv=this.DHTMLSuite_tabObj.getElementsByTagName('DIV')[0];var firstDiv=this.DHTMLSuite_tabObj.getElementsByTagName('DIV')[1];this.initActiveTabIndex=this.tabView_countTabs;var tmpTabTitles=Array(nameOfAdditionalTab);}
for(var no=0;no<tmpTabTitles.length;no++){var aTab=document.createElement('DIV');aTab.id='tabTab'+this.tabSetParentId+"_"+(no+this.tabView_countTabs);aTab.onmouseover=this.__rolloverTab;aTab.onmouseout=this.__rolloutTab;aTab.setAttribute('parentRefId',this.tabSetParentId);aTab.parentRefId=this.tabSetParentId;var numIndex=window.refToThisTabSet.outsideObjectRefIndex+'';aTab.onclick=function(){window.refToThisTabSet.__tabClick(this,numIndex);};DHTMLSuite.commonObj.__addEventElement(aTab);aTab.className='tabInactive';aTab.style.backgroundImage='url(\''+DHTMLSuite.configObj.imagePath+'tab_left_inactive.gif'+'\')';tabDiv.appendChild(aTab);var span=document.createElement('SPAN');span.innerHTML=tmpTabTitles[no];aTab.appendChild(span);if(this.closeButtons[no]||additionalCloseButton){var closeButton=document.createElement('IMG');closeButton.src=DHTMLSuite.configObj.imagePath+'tab-view-close.gif';closeButton.style.position='absolute';closeButton.style.top='4px';closeButton.style.right='2px';closeButton.onmouseover=this.__hoverTabViewCloseButton;closeButton.onmouseout=this.__mouseOutTabViewCloseButton;DHTMLSuite.commonObj.__addEventElement(closeButton);span.innerHTML=span.innerHTML+'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;';var deleteTxt=span.innerHTML+'';closeButton.onclick=function(){refToTabViewObjects[numIndex].deleteTab(this.parentNode.innerHTML)};span.appendChild(closeButton);}
var img=document.createElement('IMG');img.valign='bottom';img.src=DHTMLSuite.configObj.imagePath+'tab_right_inactive.gif';if((DHTMLSuite.clientInfoObj.navigatorVersion&&DHTMLSuite.clientInfoObj.navigatorVersion<6)||(DHTMLSuite.clientInfoObj.isMSIE&&!this.strictDocType)){img.style.styleFloat='none';img.style.position='relative';img.style.top='4px'
span.style.paddingTop='4px';aTab.style.cursor='hand';}
aTab.appendChild(img);}
var tabs=this.DHTMLSuite_tabObj.getElementsByTagName('DIV');var divCounter=0;for(var no=0;no<tabs.length;no++){if(tabs[no].className=='DHTMLSuite_aTab'&&tabs[no].parentNode==this.DHTMLSuite_tabObj){if(this.height.length>0){if(this.height.indexOf('%')==-1){var tmpHeight=(this.height.replace('px','')/1-22);tabs[no].style.height=tmpHeight+'px';}else
tabs[no].style.height=this.height;}
tabs[no].style.display='none';tabs[no].id='tabView'+this.tabSetParentId+"_"+divCounter;divCounter++;}}
this.tabView_countTabs=this.tabView_countTabs+this.tabTitles.length;this.__showTab(this.tabSetParentId,this.initActiveTabIndex,this.outsideObjectRefIndex);return this.activeTabIndex;},__mouseOutTabViewCloseButton:function()
{this.src=this.src.replace('close-over.gif','close.gif');},__hoverTabViewCloseButton:function()
{this.src=this.src.replace('close.gif','close-over.gif');},__showAjaxTabContent:function(ajaxIndex,objId,tabId)
{var obj=document.getElementById('tabView'+objId+'_'+tabId);obj.innerHTML=this.ajaxObjects[ajaxIndex].response;},__resetTabIds:function(parentId)
{var tabTitleCounter=0;var tabContentCounter=0;var divs=this.DHTMLSuite_tabObj.getElementsByTagName('DIV');for(var no=0;no<divs.length;no++){if(divs[no].className=='DHTMLSuite_aTab'&&divs[no].parentNode==this.DHTMLSuite_tabObj){divs[no].id='tabView'+parentId+'_'+tabTitleCounter;tabTitleCounter++;}
if(divs[no].id.indexOf('tabTab')>=0&&divs[no].parentNode.parentNode==this.DHTMLSuite_tabObj){divs[no].id='tabTab'+parentId+'_'+tabContentCounter;tabContentCounter++;}}
this.tabView_countTabs=tabContentCounter;},getTabIndexByTitle:function(tabTitle)
{tabTitle=tabTitle.replace(/(.*?)&nbsp.*$/gi,'$1');var divs=this.DHTMLSuite_tabObj.getElementsByTagName('DIV');for(var no=0;no<divs.length;no++){if(divs[no].id.indexOf('tabTab')>=0){var span=divs[no].getElementsByTagName('SPAN')[0];var spanTitle=span.innerHTML.replace(/(.*?)&nbsp.*$/gi,'$1');if(spanTitle==tabTitle){var tmpId=divs[no].id.split('_');return tmpId[tmpId.length-1].replace(/[^0-9]/g,'')/1;}}}
return-1;}}
var JSTreeObj;var treeUlCounter=0;var nodeId=1;DHTMLSuite.JSDragDropTree=function()
{var idOfTree;var folderImage;var plusImage;var minusImage;var maximumDepth;var dragNode_source;var dragNode_parent;var dragNode_sourceNextSib;var dragNode_noSiblings;var dragNode_destination;var floatingContainer;var dragDropTimer;var dropTargetIndicator;var insertAsSub;var indicator_offsetX;var indicator_offsetX_sub;var indicator_offsetY;var messageMaximumDepthReached;var ajaxObjects;var layoutCSS;this.folderImage='DHTMLSuite_folder.gif';this.plusImage='DHTMLSuite_plus.gif';this.minusImage='DHTMLSuite_minus.gif';this.maximumDepth=6;this.layoutCSS='drag-drop-folder-tree.css';this.floatingContainer=document.createElement('UL');this.floatingContainer.style.position='absolute';this.floatingContainer.style.display='none';this.floatingContainer.id='floatingContainer';this.insertAsSub=false;document.body.appendChild(this.floatingContainer);this.dragDropTimer=-1;this.dragNode_noSiblings=false;if(document.all){this.indicator_offsetX=1;this.indicator_offsetX_sub=3;this.indicator_offsetY=14;}else{this.indicator_offsetX=1;this.indicator_offsetX_sub=3;this.indicator_offsetY=5;}
if(navigator.userAgent.indexOf('Opera')>=0){this.indicator_offsetX=2;this.indicator_offsetX_sub=3;this.indicator_offsetY=-7;}
this.messageMaximumDepthReached='';this.ajaxObjects=new Array();if(!standardObjectsCreated)DHTMLSuite.createStandardObjects();}
DHTMLSuite.JSDragDropTree.prototype={init:function()
{DHTMLSuite.commonObj.loadCSS(this.layoutCSS);JSTreeObj=this;JSTreeObj.__createDropIndicator();if(!document.documentElement.onselectstart)document.documentElement.onselectstart=function(){return DHTMLSuite.commonObj.__getOkToSelect();};document.documentElement.ondragstart=document.documentElement.ondragstart=function(){return DHTMLSuite.commonObj.cancelEvent()};DHTMLSuite.commonObj.__addEventElement(document.documentElement);var nodeId=0;var DHTMLSuite_tree=document.getElementById(this.idOfTree);var menuItems=DHTMLSuite_tree.getElementsByTagName('LI');for(var no=0;no<menuItems.length;no++){var noChildren=false;var tmpVar=menuItems[no].getAttribute('noChildren');if(!tmpVar)tmpVar=menuItems[no].noChildren;if(tmpVar=='true')noChildren=true;var noDrag=false;var tmpVar=menuItems[no].getAttribute('noDrag');if(!tmpVar)tmpVar=menuItems[no].noDrag;if(tmpVar=='true')noDrag=true;nodeId++;var subItems=menuItems[no].getElementsByTagName('UL');var img=document.createElement('IMG');img.src=DHTMLSuite.configObj.imagePath+this.plusImage;img.onclick=JSTreeObj.showHideNode;DHTMLSuite.commonObj.__addEventElement(img);if(subItems.length==0)img.style.visibility='hidden';else{subItems[0].id='tree_ul_'+treeUlCounter;treeUlCounter++;}
var aTag=menuItems[no].getElementsByTagName('A')[0];if(!noDrag)aTag.onmousedown=JSTreeObj.__initDrag;if(!noChildren)aTag.onmousemove=JSTreeObj.__moveDragableNodes;DHTMLSuite.commonObj.__addEventElement(aTag);menuItems[no].insertBefore(img,aTag);menuItems[no].id='DHTMLSuite_treeNode'+nodeId;var folderImg=document.createElement('IMG');if(!noDrag)folderImg.onmousedown=JSTreeObj.__initDrag;if(!noChildren)folderImg.onmousemove=JSTreeObj.__moveDragableNodes;if(menuItems[no].className){folderImg.src=DHTMLSuite.configObj.imagePath+menuItems[no].className;}else{folderImg.src=DHTMLSuite.configObj.imagePath+this.folderImage;}
DHTMLSuite.commonObj.__addEventElement(folderImg);menuItems[no].insertBefore(folderImg,aTag);}
initExpandedNodes=DHTMLSuite.commonObj.getCookie('DHTMLSuite_expandedNodes');if(initExpandedNodes){var nodes=initExpandedNodes.split(',');for(var no=0;no<nodes.length;no++){if(nodes[no])this.showHideNode(false,nodes[no]);}}
DHTMLSuite.commonObj.addEvent(document.documentElement,"mousemove",JSTreeObj.__moveDragableNodes);DHTMLSuite.commonObj.addEvent(document.documentElement,"mouseup",JSTreeObj.__dropDragableNodes);},setLayoutCss:function(cssFileName)
{this.layoutCSS=cssFileName;},setFolderImage:function(newFolderImage)
{this.folderImage=newFolderImage;},setPlusImage:function(newPlusImage)
{this.plusImage=newPlusImage;},setMinusImage:function(newMinusImage)
{this.mlusImage=newMinusImage;},setMaximumDepth:function(maxDepth)
{this.maximumDepth=maxDepth;},setMessageMaximumDepthReached:function(newMessage)
{this.messageMaximumDepthReached=newMessage;},setTreeId:function(idOfTree)
{this.idOfTree=idOfTree;},expandAll:function()
{var menuItems=document.getElementById(this.idOfTree).getElementsByTagName('LI');for(var no=0;no<menuItems.length;no++){var subItems=menuItems[no].getElementsByTagName('UL');if(subItems.length>0&&subItems[0].style.display!='block'){JSTreeObj.showHideNode(false,menuItems[no].id.replace(/[^0-9]/g,''));}}},collapseAll:function()
{var menuItems=document.getElementById(this.idOfTree).getElementsByTagName('LI');for(var no=0;no<menuItems.length;no++){var subItems=menuItems[no].getElementsByTagName('UL');if(subItems.length>0&&subItems[0].style.display=='block'){JSTreeObj.showHideNode(false,menuItems[no].id.replace(/[^0-9]/g,''));}}},showHideNode:function(e,inputId)
{if(inputId){if(!document.getElementById('DHTMLSuite_treeNode'+inputId))return;thisNode=document.getElementById('DHTMLSuite_treeNode'+inputId).getElementsByTagName('IMG')[0];}else{thisNode=this;if(this.tagName=='A')thisNode=this.parentNode.getElementsByTagName('IMG')[0];}
if(thisNode.style.visibility=='hidden')return;var parentNode=thisNode.parentNode;inputId=parentNode.id.replace(/[^0-9]/g,'');if(thisNode.src.indexOf(JSTreeObj.plusImage)>=0){thisNode.src=thisNode.src.replace(JSTreeObj.plusImage,JSTreeObj.minusImage);var ul=parentNode.getElementsByTagName('UL')[0];ul.style.display='block';if(!initExpandedNodes)initExpandedNodes=',';if(initExpandedNodes.indexOf(','+inputId+',')<0)initExpandedNodes=initExpandedNodes+inputId+',';}else{thisNode.src=thisNode.src.replace(JSTreeObj.minusImage,JSTreeObj.plusImage);parentNode.getElementsByTagName('UL')[0].style.display='none';initExpandedNodes=initExpandedNodes.replace(','+inputId,'');}
DHTMLSuite.commonObj.setCookie('DHTMLSuite_expandedNodes',initExpandedNodes,500);return false;},getSaveString:function(initObj,saveString)
{if(!saveString)var saveString='';if(!initObj){initObj=document.getElementById(this.idOfTree);}
var lis=initObj.getElementsByTagName('LI');if(lis.length>0){var li=lis[0];while(li){if(li.id){if(saveString.length>0)saveString=saveString+',';saveString=saveString+li.id.replace(/[^0-9]/gi,'');saveString=saveString+'-';if(li.parentNode.id!=this.idOfTree)saveString=saveString+li.parentNode.parentNode.id.replace(/[^0-9]/gi,'');else saveString=saveString+'0';var ul=li.getElementsByTagName('UL');if(ul.length>0){saveString=this.getSaveString(ul[0],saveString);}}
li=li.nextSibling;}}
if(initObj.id==this.idOfTree){return saveString;}
return saveString;},__initDrag:function(e)
{if(document.all)e=event;var subs=JSTreeObj.floatingContainer.getElementsByTagName('LI');if(subs.length>0){if(JSTreeObj.dragNode_sourceNextSib){JSTreeObj.dragNode_parent.insertBefore(JSTreeObj.dragNode_source,JSTreeObj.dragNode_sourceNextSib);}else{JSTreeObj.dragNode_parent.appendChild(JSTreeObj.dragNode_source);}}
JSTreeObj.dragNode_source=this.parentNode;JSTreeObj.dragNode_parent=this.parentNode.parentNode;JSTreeObj.dragNode_sourceNextSib=false;if(JSTreeObj.dragNode_source.nextSibling)JSTreeObj.dragNode_sourceNextSib=JSTreeObj.dragNode_source.nextSibling;JSTreeObj.dragNode_destination=false;JSTreeObj.dragDropTimer=0;DHTMLSuite.commonObj.__setOkToSelect(false);JSTreeObj.__timerDrag();return false;},__timerDrag:function()
{if(this.dragDropTimer>=0&&this.dragDropTimer<10){this.dragDropTimer=this.dragDropTimer+1;setTimeout('JSTreeObj.__timerDrag()',20);return;}
if(this.dragDropTimer==10)
{JSTreeObj.floatingContainer.style.display='block';JSTreeObj.floatingContainer.appendChild(JSTreeObj.dragNode_source);}},__moveDragableNodes:function(e)
{if(JSTreeObj.dragDropTimer<10)return;if(document.all)e=event;dragDrop_x=e.clientX/1+5+document.body.scrollLeft;dragDrop_y=e.clientY/1+5+document.documentElement.scrollTop;JSTreeObj.floatingContainer.style.left=dragDrop_x+'px';JSTreeObj.floatingContainer.style.top=dragDrop_y+'px';var thisObj=this;if(thisObj.tagName=='A'||thisObj.tagName=='IMG')thisObj=thisObj.parentNode;JSTreeObj.dragNode_noSiblings=false;var tmpVar=thisObj.getAttribute('noSiblings');if(!tmpVar)tmpVar=thisObj.noSiblings;if(tmpVar=='true')JSTreeObj.dragNode_noSiblings=true;if(thisObj&&thisObj.id)
{JSTreeObj.dragNode_destination=thisObj;var img=thisObj.getElementsByTagName('IMG')[1];var tmpObj=JSTreeObj.dropTargetIndicator;tmpObj.style.display='block';var eventSourceObj=this;if(JSTreeObj.dragNode_noSiblings&&eventSourceObj.tagName=='IMG')eventSourceObj=eventSourceObj.nextSibling;var tmpImg=tmpObj.getElementsByTagName('IMG')[0];if(this.tagName=='A'||JSTreeObj.dragNode_noSiblings){tmpImg.src=tmpImg.src.replace('ind1','ind2');JSTreeObj.insertAsSub=true;tmpObj.style.left=(DHTMLSuite.commonObj.getLeftPos(eventSourceObj)+JSTreeObj.indicator_offsetX_sub)+'px';}else{tmpImg.src=tmpImg.src.replace('ind2','ind1');JSTreeObj.insertAsSub=false;tmpObj.style.left=(DHTMLSuite.commonObj.getLeftPos(eventSourceObj)+JSTreeObj.indicator_offsetX)+'px';}
tmpObj.style.top=(DHTMLSuite.commonObj.getTopPos(thisObj)+JSTreeObj.indicator_offsetY)+'px';}
return false;},__dropDragableNodes:function()
{if(JSTreeObj.dragDropTimer<10){JSTreeObj.dragDropTimer=-1;DHTMLSuite.commonObj.__setOkToSelect(true);return;}
var showMessage=false;if(JSTreeObj.dragNode_destination){var countUp=JSTreeObj.__dragDropGetDepth(JSTreeObj.dragNode_destination,'up');var countDown=JSTreeObj.__dragDropGetDepth(JSTreeObj.dragNode_source,'down');var countLevels=countUp/1+countDown/1+(JSTreeObj.insertAsSub?1:0);if(countLevels>JSTreeObj.maximumDepth){JSTreeObj.dragNode_destination=false;showMessage=true;}}
if(JSTreeObj.dragNode_destination){if(JSTreeObj.insertAsSub){var uls=JSTreeObj.dragNode_destination.getElementsByTagName('UL');if(uls.length>0){ul=uls[0];ul.style.display='block';var lis=ul.getElementsByTagName('LI');if(lis.length>0){ul.insertBefore(JSTreeObj.dragNode_source,lis[0]);}else{ul.appendChild(JSTreeObj.dragNode_source);}}else{var ul=document.createElement('UL');ul.style.display='block';JSTreeObj.dragNode_destination.appendChild(ul);ul.appendChild(JSTreeObj.dragNode_source);}
var img=JSTreeObj.dragNode_destination.getElementsByTagName('IMG')[0];img.style.visibility='visible';img.src=img.src.replace(JSTreeObj.plusImage,JSTreeObj.minusImage);}else{if(JSTreeObj.dragNode_destination.nextSibling){var nextSib=JSTreeObj.dragNode_destination.nextSibling;nextSib.parentNode.insertBefore(JSTreeObj.dragNode_source,nextSib);}else{JSTreeObj.dragNode_destination.parentNode.appendChild(JSTreeObj.dragNode_source);}}
var tmpObj=JSTreeObj.dragNode_parent;var lis=tmpObj.getElementsByTagName('LI');if(lis.length==0){var img=tmpObj.parentNode.getElementsByTagName('IMG')[0];img.style.visibility='hidden';tmpObj.parentNode.removeChild(tmpObj);}}else{if(JSTreeObj.dragNode_sourceNextSib){JSTreeObj.dragNode_parent.insertBefore(JSTreeObj.dragNode_source,JSTreeObj.dragNode_sourceNextSib);}else{JSTreeObj.dragNode_parent.appendChild(JSTreeObj.dragNode_source);}}
JSTreeObj.dropTargetIndicator.style.display='none';JSTreeObj.dragDropTimer=-1;DHTMLSuite.commonObj.__setOkToSelect(true);if(showMessage&&JSTreeObj.messageMaximumDepthReached)alert(JSTreeObj.messageMaximumDepthReached);},__createDropIndicator:function()
{this.dropTargetIndicator=document.createElement('DIV');this.dropTargetIndicator.style.zIndex=240000;this.dropTargetIndicator.style.position='absolute';this.dropTargetIndicator.style.display='none';var img=document.createElement('IMG');img.src=DHTMLSuite.configObj.imagePath+'dragDrop_ind1.gif';img.id='dragDropIndicatorImage';this.dropTargetIndicator.appendChild(img);document.body.appendChild(this.dropTargetIndicator);},__dragDropGetDepth:function(obj,direction,stopAtObject){var countLevels=0;if(direction=='up'){while(obj.parentNode&&obj.parentNode!=stopAtObject){obj=obj.parentNode;if(obj.tagName=='UL')countLevels=countLevels/1+1;}
return countLevels;}
if(direction=='down'){var subObjects=obj.getElementsByTagName('LI');for(var no=0;no<subObjects.length;no++){countLevels=Math.max(countLevels,JSTreeObj.__dragDropGetDepth(subObjects[no],"up",obj));}
return countLevels;}},__cancelSelectionEvent:function()
{if(JSTreeObj.dragDropTimer<10)return true;return false;}}
DHTMLSuite.dynamicContent=function()
{var enableCache;var jsCache;var dynamicContent_ajaxObjects;var waitMessage;this.enableCache=true;this.jsCache=new Array();this.dynamicContent_ajaxObjects=new Array();this.waitMessage='Loading content - please wait';if(!standardObjectsCreated)DHTMLSuite.createStandardObjects();var objectIndex;this.objectIndex=DHTMLSuite.variableStorage.arrayOfDhtmlSuiteObjects.length;DHTMLSuite.variableStorage.arrayOfDhtmlSuiteObjects[this.objectIndex]=this;}
DHTMLSuite.dynamicContent.prototype={loadContent:function(divId,url,functionToCallOnLoaded)
{var ind=this.objectIndex;if(this.enableCache&&this.jsCache[url]){document.getElementById(divId).innerHTML=this.jsCache[url];return;}
var ajaxIndex=0;if(this.waitMessage){try{document.getElementById(divId).innerHTML=this.waitMessage;}catch(e){}}
this.dynamicContent_ajaxObjects[ajaxIndex]=new sack();this.dynamicContent_ajaxObjects[ajaxIndex].requestFile=url;this.dynamicContent_ajaxObjects[ajaxIndex].onCompletion=function(){DHTMLSuite.variableStorage.arrayOfDhtmlSuiteObjects[ind].__ajax_showContent(divId,ajaxIndex,url,functionToCallOnLoaded);};this.dynamicContent_ajaxObjects[ajaxIndex].runAJAX();},setWaitMessage:function(newWaitMessage)
{this.waitMessage=newWaitMessage;},setCache:function(enableCache)
{this.enableCache=enableCache;},__ajax_showContent:function(divId,ajaxIndex,url,functionToCallOnLoaded)
{var obj=document.getElementById(divId);obj.innerHTML=this.dynamicContent_ajaxObjects[ajaxIndex].response;if(this.enableCache){this.jsCache[url]=this.dynamicContent_ajaxObjects[ajaxIndex].response;}
this.__evaluateJs(obj);this.__evaluateCss(obj);if(functionToCallOnLoaded)eval(functionToCallOnLoaded);this.dynamicContent_ajaxObjects[ajaxIndex]=null;},__evaluateJs:function(obj)
{var scriptTags=obj.getElementsByTagName('SCRIPT');var string='';var jsCode='';for(var no=0;no<scriptTags.length;no++){if(scriptTags[no].src){var head=document.getElementsByTagName("head")[0];var scriptObj=document.createElement("script");scriptObj.setAttribute("type","text/javascript");scriptObj.setAttribute("src",scriptTags[no].src);}else{if(DHTMLSuite.clientInfoObj.isOpera){jsCode=jsCode+scriptTags[no].text+'\n';}
else
jsCode=jsCode+scriptTags[no].innerHTML;}}
if(jsCode)this.__installScript(jsCode);},__installScript:function(script)
{if(!script)
return;if(window.execScript){window.execScript(script)}else if(window.jQuery&&jQuery.browser.safari){window.setTimeout(script,0);}else{window.setTimeout(script,0);}},__evaluateCss:function(obj)
{var cssTags=obj.getElementsByTagName('STYLE');var head=document.getElementsByTagName('HEAD')[0];for(var no=0;no<cssTags.length;no++){head.appendChild(cssTags[no]);}}}
DHTMLSuite.colorHelp=function()
{}
DHTMLSuite.colorHelp.prototype={baseConverter:function(numberToConvert,oldBase,newBase){numberToConvert=numberToConvert+"";numberToConvert=numberToConvert.toUpperCase();var listOfCharactersOfCharacters="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ";var dec=0;for(var i=0;i<=numberToConvert.length;i++){dec+=(listOfCharacters.indexOf(numberToConvert.charAt(i)))*(Math.pow(oldBase,(numberToConvert.length-i-1)));}
numberToConvert="";var magnitude=Math.floor((Math.log(dec))/(Math.log(newBase)));for(var i=magnitude;i>=0;i--){var amount=Math.floor(dec/Math.pow(newBase,i));numberToConvert=numberToConvert+listOfCharacters.charAt(amount);dec-=amount*(Math.pow(newBase,i));}
if(numberToConvert.length==0)numberToConvertToConvert=0;return numberToConvert;},getHSV:function(rgbColor){rgbColor=rgbColor.replace('#','');red=baseConverter(rgbColor.substr(0,2),16,10);green=baseConverter(rgbColor.substr(2,2),16,10);blue=baseConverter(rgbColor.substr(4,2),16,10);if(red.length==0)red=0;if(green.length==0)green=0;if(blue.length==0)blue=0;red=red/255;green=green/255;blue=blue/255;maxValue=Math.max(red,green,blue);minValue=Math.min(red,green,blue);var hue=0;if(maxValue==minValue){hue=0;saturation=0;}else{if(red==maxValue){hue=(green-blue)/(maxValue-minValue)/1;}else if(green==maxValue){hue=2+(blue-red)/1/(maxValue-minValue)/1;}else if(blue==maxValue){hue=4+(red-green)/(maxValue-minValue)/1;}
saturation=(maxValue-minValue)/maxValue;}
hue=hue*60;valueBrightness=maxValue;if(valueBrightness/1<0.5){}
if(valueBrightness/1>=0.5){}
returnArray=[hue,saturation,valueBrightness];return returnArray;},toRgb:function(hue,saturation,valueBrightness){Hi=Math.floor(hue/60);if(hue==360)Hi=0;f=hue/60-Hi;p=(valueBrightness*(1-saturation)).toPrecision(2);q=(valueBrightness*(1-(f*saturation))).toPrecision(2);t=(valueBrightness*(1-((1-f)*saturation))).toPrecision(2);switch(Hi){case 0:red=valueBrightness;green=t;blue=p;break;case 1:red=q;green=valueBrightness;blue=p;break;case 2:red=q;green=valueBrightness;blue=t;break;case 3:red=p;green=q;;blue=valueBrightness;break;case 4:red=t;green=p;blue=valueBrightness;break;case 5:red=valueBrightness;green=p;blue=q;break;}
if(saturation==0){red=valueBrightness;green=valueBrightness;blue=valueBrightness;}
red*=255;green*=255;blue*=255;red=Math.round(red);green=Math.round(green);blue=Math.round(blue);red=baseConverter(red,10,16);green=baseConverter(green,10,16);blue=baseConverter(blue,10,16);red=red+"";green=green+"";blue=blue+"";while(red.length<2){red="0"+red;}
while(green.length<2){green="0"+green;}
while(blue.length<2){blue="0"+""+blue;}
rgbColor="#"+red+""+green+""+blue;return rgbColor.toUpperCase();},findColorByDegrees:function(rgbColor,degrees){rgbColor=rgbColor.replace('#','');myArray=this.getHSV(rgbColor);myArray[0]+=degrees;if(myArray[0]>=360)myArray[0]-=360;if(myArray[0]<0)myArray[0]+=360;return toRgb(myArray[0],myArray[1],myArray[2]);},findColorByBrightness:function(rgbColor,brightness){rgbColor=rgbColor.replace('#','');myArray=thhis.getHSV(rgbColor);myArray[2]+=brightness/100;if(myArray[2]>1)myArray[2]=1;if(myArray[2]<0)myArray[2]=0;myArray[1]+=brightness/100;if(myArray[1]>1)myArray[1]=1;if(myArray[1]<0)myArray[1]=0;return toRgb(myArray[0],myArray[1],myArray[2]);},getRgbFromNumbers:function(red,green,blue)
{red=this.baseConverter(red,10,16);if(red.length==0)red='0'+red;green=this.baseConverter(green,10,16);if(green.length==0)green='0'+green;blue=this.baseConverter(blue,10,16);if(blue.length==0)blue='0'+blue;return'#'+red+green+blue;}}
DHTMLSuite.sliderObjects=new Array();DHTMLSuite.indexOfCurrentlyActiveSlider=false;DHTMLSuite.slider_generalMouseEventsAdded=false;DHTMLSuite.slider=function()
{var width;var height;var targetObj;var sliderWidth;var sliderDirection;var functionToCallOnChange;var layoutCss;var sliderMaxValue;var sliderMinValue;var initialValue;var sliderSize;var directionOfPointer;var slideInProcessTimer;var indexThisSlider;var numberOfSteps;var stepLinesVisibility;var slide_event_pos;var slide_start_pos;var sliderHandleImg;var sliderName;var sliderValueReversed;this.sliderWidth=9;this.layoutCss='slider.css';this.sliderDirection='hor';this.width=0;this.height=0;this.sliderMaxValue=100;this.sliderMinValue=0;this.initialValue=0;this.targetObj=false;this.directionOfPointer='up';this.slideInProcessTimer=-1;this.sliderName='';this.numberOfSteps=false;this.stepLinesVisibility=true;this.sliderValueReversed=false;if(!standardObjectsCreated)DHTMLSuite.createStandardObjects();}
DHTMLSuite.slider.prototype={init:function()
{if(!this.targetObj){alert('Error! - No target for slider specified');return;}
if(!this.width)this.width=this.targetObj.clientWidth;if(!this.height)this.height=this.targetObj.clientHeight;if(!this.width)this.width=this.targetObj.offsetWidth;if(!this.height)this.height=this.targetObj.offsetHeight;this.width=this.width+'px';this.height=this.height+'px';DHTMLSuite.commonObj.loadCSS(this.layoutCss);this.__createSlider();},setSliderTarget:function(targetId)
{this.targetObj=document.getElementById(targetId);},setSliderDirection:function(newDirection)
{newDirection=newDirection+'';newDirection=newDirection.toLowerCase();if(newDirection!='hor'&&newDirection!='ver'){alert('Invalid slider direction - possible values: "hor" or "ver"');return;}
this.sliderDirection=newDirection;},setSliderWidth:function(newWidth)
{newWidth=newWidth+'';if(newWidth.indexOf('%')==-1)newWidth=newWidth+'px';this.width=newWidth;},setSliderHeight:function(newHeight)
{newHeight=newHeight+'';if(newHeight.indexOf('%')==-1)newHeight=newHeight+'px';this.height=height;},setSliderReversed:function()
{this.sliderValueReversed=true;},setOnChangeEvent:function(nameOfFunction)
{this.functionToCallOnChange=nameOfFunction;},setSliderMaxValue:function(newMaxValue)
{this.sliderMaxValue=newMaxValue;},setSliderMinValue:function(newMinValue)
{this.sliderMinValue=newMinValue;},setSliderName:function(nameOfSlider)
{this.sliderName=nameOfSlider;},setLayoutCss:function(nameOfNewCssFile)
{this.layoutCss=nameOfNewCssFile;},setInitialValue:function(newInitialValue)
{this.initialValue=newInitialValue;},setSliderPointerDirection:function(directionOfPointer)
{this.directionOfPointer=directionOfPointer;},setSliderValue:function(newValue)
{var position=Math.floor((newValue/this.sliderMaxValue)*this.sliderSize);if(this.sliderDirection=='hor'){this.sliderHandleImg.style.left=position+'px';}else{this.sliderHandleImg.style.top=position+'px';}},setNumberOfSliderSteps:function(numberOfSteps)
{this.numberOfSteps=numberOfSteps;},setStepLinesVisible:function(visible)
{this.stepLinesVisibility=visible;},__createSlider:function()
{this.indexThisSlider=DHTMLSuite.sliderObjects.length;DHTMLSuite.sliderObjects[this.indexThisSlider]=this;window.refToThisObject=this;var div=document.createElement('DIV');div.style.width=this.width;div.style.cursor='default';div.style.height=this.height;div.style.position='relative';div.id='sliderNumber'+this.indexThisSlider;div.onmousedown=this.__setPositionFromClick;DHTMLSuite.commonObj.__addEventElement(div);this.targetObj.appendChild(div);var sliderObj=document.createElement('DIV');if(this.sliderDirection=='hor'){sliderObj.className='DHTMLSuite_slider_horizontal';sliderObj.style.width=div.clientWidth+'px';this.sliderSize=div.offsetWidth-this.sliderWidth;var sliderHandle=document.createElement('IMG');var srcHandle='slider_handle_down.gif';sliderHandle.style.bottom='2px';if(this.directionOfPointer=='up'){srcHandle='slider_handle_up.gif';sliderHandle.style.bottom='0px';}
sliderHandle.src=DHTMLSuite.configObj.imagePath+srcHandle;div.appendChild(sliderHandle);var leftPos;if(this.sliderValueReversed){leftPos=Math.round(((this.sliderMaxValue-this.initialValue)/this.sliderMaxValue)*this.sliderSize)-1;}else{leftPos=Math.round((this.initialValue/this.sliderMaxValue)*this.sliderSize);}
sliderHandle.style.left=leftPos+'px';}else{sliderObj.className='DHTMLSuite_slider_vertical';sliderObj.style.height=div.clientHeight+'px';this.sliderSize=div.clientHeight-this.sliderWidth;var sliderHandle=document.createElement('IMG');var srcHandle='slider_handle_right.gif';sliderHandle.style.left='0px';if(this.directionOfPointer=='left'){srcHandle='slider_handle_left.gif';sliderHandle.style.left='0px';}
sliderHandle.src=DHTMLSuite.configObj.imagePath+srcHandle;div.appendChild(sliderHandle);var topPos;if(!this.sliderValueReversed){topPos=Math.floor(((this.sliderMaxValue-this.initialValue)/this.sliderMaxValue)*this.sliderSize);}else{topPos=Math.floor((this.initialValue/this.sliderMaxValue)*this.sliderSize);}
sliderHandle.style.top=topPos+'px';}
sliderHandle.id='sliderForObject'+this.indexThisSlider;sliderHandle.style.position='absolute';sliderHandle.style.zIndex=5;sliderHandle.onmousedown=this.__initDragHandle;sliderHandle.ondragstart=function(){return DHTMLSuite.commonObj.cancelEvent()};sliderHandle.onselectstart=function(){return DHTMLSuite.commonObj.cancelEvent()};DHTMLSuite.commonObj.__addEventElement(sliderHandle);this.sliderHandleImg=sliderHandle;if(!DHTMLSuite.slider_generalMouseEventsAdded){DHTMLSuite.commonObj.addEvent(document.documentElement,"mousemove",this.__moveSlider);DHTMLSuite.commonObj.addEvent(document.documentElement,"mouseup",this.__stopSlideProcess);DHTMLSuite.slider_generalMouseEventsAdded=true;}
sliderObj.innerHTML='<span style="cursor:default"></span>';div.appendChild(sliderObj);if(this.numberOfSteps&&this.stepLinesVisibility){var stepSize=this.sliderSize/this.numberOfSteps;for(var no=0;no<=this.numberOfSteps;no++){var lineDiv=document.createElement('DIV');lineDiv.style.position='absolute';lineDiv.innerHTML='<span></span>';div.appendChild(lineDiv);if(this.sliderDirection=='hor'){lineDiv.className='DHTMLSuite_smallLines_vertical';lineDiv.style.left=Math.floor((stepSize*no)+(this.sliderWidth/2))+'px';}else{lineDiv.className='DHTMLSuite_smallLines_horizontal';lineDiv.style.top=Math.floor((stepSize*no)+(this.sliderWidth/2))+'px';lineDiv.style.left='14px';}}}},__initDragHandle:function(e)
{if(document.all)e=event;var numIndex=this.id.replace(/[^0-9]/gi,'');var sliderObj=DHTMLSuite.sliderObjects[numIndex];DHTMLSuite.indexOfCurrentlyActiveSlider=numIndex;sliderObj.slideInProcessTimer=0;if(sliderObj.sliderDirection=='hor'){sliderObj.slide_event_pos=e.clientX;sliderObj.slide_start_pos=this.style.left.replace('px','')/1;}else{sliderObj.slide_event_pos=e.clientY;sliderObj.slide_start_pos=this.style.top.replace('px','')/1;}
sliderObj.__timerDragSlider();return false;},__setPositionFromClick:function(e)
{if(document.all)e=event;if(e.target)srcEvent=e.target;else if(e.srcElement)srcEvent=e.srcElement;if(srcEvent.nodeType==3)
srcEvent=srcEvent.parentNode;if(srcEvent.tagName!='DIV')return;var numIndex=this.id.replace(/[^0-9]/gi,'');var sliderObj=DHTMLSuite.sliderObjects[numIndex];if(sliderObj.numberOfSteps){modValue=sliderObj.sliderSize/sliderObj.numberOfSteps;}
if(sliderObj.sliderDirection=='hor'){var handlePos=(e.clientX-DHTMLSuite.commonObj.getLeftPos(this)-sliderObj.sliderWidth);}else{var handlePos=(e.clientY-DHTMLSuite.commonObj.getTopPos(this)-sliderObj.sliderWidth);}
if(sliderObj.numberOfSteps){var mod=handlePos%modValue;if(mod>(modValue/2))mod=modValue-mod;else mod*=-1;handlePos=handlePos+mod;}
if(handlePos<0)handlePos=0;if(handlePos>sliderObj.sliderSize)handlePos=sliderObj.sliderSize;if(sliderObj.sliderDirection=='hor'){sliderObj.sliderHandleImg.style.left=handlePos+'px';if(!sliderObj.sliderValueReversed){returnValue=Math.round((handlePos/sliderObj.sliderSize)*(sliderObj.sliderMaxValue-sliderObj.sliderMinValue));}else{returnValue=Math.round(((sliderObj.sliderSize-handlePos)/sliderObj.sliderSize)*(sliderObj.sliderMaxValue-sliderObj.sliderMinValue));}}else{sliderObj.sliderHandleImg.style.top=handlePos+'px';if(sliderObj.sliderValueReversed){returnValue=Math.round((topPos/sliderObj.sliderSize)*(sliderObj.sliderMaxValue-sliderObj.sliderMinValue));}else{returnValue=Math.round(((sliderObj.sliderSize-handlePos)/sliderObj.sliderSize)*(sliderObj.sliderMaxValue-sliderObj.sliderMinValue));}}
returnValue=returnValue+sliderObj.sliderMinValue;if(sliderObj.functionToCallOnChange)eval(sliderObj.functionToCallOnChange+'('+returnValue+',"'+sliderObj.sliderName+'")');},__timerDragSlider:function()
{if(this.slideInProcessTimer<10&&this.slideInProcessTimer>=0){this.slideInProcessTimer=this.slideInProcessTimer+1;window.refToThisSlider=this;setTimeout('window.refToThisSlider.__timerDragSlider()',5);}},__moveSlider:function(e)
{if(DHTMLSuite.indexOfCurrentlyActiveSlider===false)return;var sliderObj=DHTMLSuite.sliderObjects[DHTMLSuite.indexOfCurrentlyActiveSlider];if(document.all)e=event;if(sliderObj.slideInProcessTimer<10)return;var returnValue;if(sliderObj.numberOfSteps){modValue=sliderObj.sliderSize/sliderObj.numberOfSteps;}
if(sliderObj.sliderDirection=='hor'){var handlePos=e.clientX-sliderObj.slide_event_pos+sliderObj.slide_start_pos;}else{var handlePos=e.clientY-sliderObj.slide_event_pos+sliderObj.slide_start_pos;}
if(sliderObj.numberOfSteps){var mod=handlePos%modValue;if(mod>(modValue/2))mod=modValue-mod;else mod*=-1;handlePos=handlePos+mod;}
if(handlePos<0)handlePos=0;if(handlePos>sliderObj.sliderSize)handlePos=sliderObj.sliderSize;if(sliderObj.sliderDirection=='hor'){sliderObj.sliderHandleImg.style.left=handlePos+'px';if(!sliderObj.sliderValueReversed){returnValue=Math.round((handlePos/sliderObj.sliderSize)*(sliderObj.sliderMaxValue-sliderObj.sliderMinValue));}else{returnValue=Math.round(((sliderObj.sliderSize-handlePos)/sliderObj.sliderSize)*(sliderObj.sliderMaxValue-sliderObj.sliderMinValue));}}else{sliderObj.sliderHandleImg.style.top=handlePos+'px';if(sliderObj.sliderValueReversed){returnValue=Math.round((handlePos/sliderObj.sliderSize)*(sliderObj.sliderMaxValue-sliderObj.sliderMinValue));}else{returnValue=Math.round(((sliderObj.sliderSize-handlePos)/sliderObj.sliderSize)*(sliderObj.sliderMaxValue-sliderObj.sliderMinValue));}}
returnValue=returnValue+sliderObj.sliderMinValue;if(sliderObj.functionToCallOnChange)eval(sliderObj.functionToCallOnChange+'('+returnValue+',"'+sliderObj.sliderName+'")');},__stopSlideProcess:function(e)
{if(!DHTMLSuite.indexOfCurrentlyActiveSlider)return;var sliderObj=DHTMLSuite.sliderObjects[DHTMLSuite.indexOfCurrentlyActiveSlider];sliderObj.slideInProcessTimer=-1;}}
DHTMLSuite.modalMessage=function()
{var url;var htmlOfModalMessage;var divs_transparentDiv;var divs_content;var layoutCss;var width;var height;var existingBodyOverFlowStyle;var dynContentObj;var cssClassOfMessageBox;var shadowDivVisible;var shadowOffset;this.url='';this.htmlOfModalMessage='';this.layoutCss='modal-message.css';this.height=200;this.width=400;this.cssClassOfMessageBox=false;this.shadowDivVisible=true;this.shadowOffset=5;if(!standardObjectsCreated)DHTMLSuite.createStandardObjects();}
DHTMLSuite.modalMessage.prototype={setSource:function(urlOfSource)
{this.url=urlOfSource;},setHtmlContent:function(newHtmlContent)
{this.htmlOfModalMessage=newHtmlContent;},setSize:function(width,height)
{if(width)this.width=width;if(height)this.height=height;},setCssClassMessageBox:function(newCssClass)
{this.cssClassOfMessageBox=newCssClass;if(this.divs_content){if(this.cssClassOfMessageBox)
this.divs_content.className=this.cssClassOfMessageBox;else
this.divs_content.className='modalDialog_contentDiv';}},setShadowOffset:function(newShadowOffset)
{this.shadowOffset=newShadowOffset},setWaitMessage:function(newMessage)
{if(!this.dynContentObj){this.dynContentObj=new DHTMLSuite.dynamicContent();}
this.dynContentObj.setWaitMessage(newMessage);},setCache:function(cacheStatus)
{if(!this.dynContentObj){this.dynContentObj=new DHTMLSuite.dynamicContent();}
this.dynContentObj.setCache(cacheStatus);},display:function()
{if(!this.divs_transparentDiv){DHTMLSuite.commonObj.loadCSS(this.layoutCss);this.__createDivs();}
this.divs_transparentDiv.style.display='block';this.divs_content.style.display='block';this.divs_shadow.style.display='block';this.__resizeDivs();window.refToThisModalBoxObj=this;setTimeout('window.refToThisModalBoxObj.__resizeDivs()',150);this.__insertContent();},setShadowDivVisible:function(visible)
{this.shadowDivVisible=visible;},close:function()
{document.documentElement.style.overflow='';this.divs_transparentDiv.style.display='none';this.divs_content.style.display='none';this.divs_shadow.style.display='none';},__createDivs:function()
{this.divs_transparentDiv=document.createElement('DIV');this.divs_transparentDiv.className='DHTMLSuite_modalDialog_transparentDivs';this.divs_transparentDiv.style.left='0px';this.divs_transparentDiv.style.top='0px';document.body.appendChild(this.divs_transparentDiv);this.divs_content=document.createElement('DIV');this.divs_content.className='DHTMLSuite_modalDialog_contentDiv';this.divs_content.id='DHTMLSuite_modalBox_contentDiv';document.body.appendChild(this.divs_content);this.divs_shadow=document.createElement('DIV');this.divs_shadow.className='DHTMLSuite_modalDialog_contentDiv_shadow';document.body.appendChild(this.divs_shadow);},__resizeDivs:function()
{var topOffset=Math.max(document.body.scrollTop,document.documentElement.scrollTop);if(this.cssClassOfMessageBox)
this.divs_content.className=this.cssClassOfMessageBox;else
this.divs_content.className='DHTMLSuite_modalDialog_contentDiv';if(!this.divs_transparentDiv)return;document.documentElement.style.overflow='hidden';var bodyWidth=document.documentElement.clientWidth;var bodyHeight=document.documentElement.clientHeight;this.divs_content.style.width=this.width+'px';this.divs_content.style.height=this.height+'px';var tmpWidth=this.divs_content.offsetWidth;var tmpHeight=this.divs_content.offsetHeight;this.divs_transparentDiv.style.width=Math.ceil((bodyWidth-tmpWidth)/2)+'px';this.divs_transparentDiv.style.height=bodyHeight+'px';this.divs_transparentDiv.style.height='4000px';this.divs_transparentDiv.style.width='4000px';this.divs_content.style.left=Math.ceil((bodyWidth-tmpWidth)/2)+'px';;this.divs_content.style.top=(Math.ceil((bodyHeight-tmpHeight)/2)+topOffset)+'px';this.divs_shadow.style.left=(this.divs_content.style.left.replace('px','')/1+this.shadowOffset)+'px';this.divs_shadow.style.top=(this.divs_content.style.top.replace('px','')/1+this.shadowOffset)+'px';this.divs_shadow.style.height=tmpHeight+'px';this.divs_shadow.style.width=tmpWidth+'px';if(!this.shadowDivVisible)this.divs_shadow.style.display='none';},__insertContent:function()
{if(!this.dynContentObj){this.dynContentObj=new DHTMLSuite.dynamicContent();}
if(this.url){this.dynContentObj.loadContent('DHTMLSuite_modalBox_contentDiv',this.url);}else{this.divs_content.innerHTML=this.htmlOfModalMessage;}}}
DHTMLSuite.dynamicTooltip=function()
{var x_offset_tooltip;var y_offset_tooltip;var ajax_tooltipObj;var ajax_tooltipObj_iframe;var dynContentObj;var layoutCss;this.x_offset_tooltip=5;this.y_offset_tooltip=0;this.ajax_tooltipObj=false;this.ajax_tooltipObj_iframe=false;this.layoutCss='dynamic-tooltip.css';if(!standardObjectsCreated)DHTMLSuite.createStandardObjects();}
DHTMLSuite.dynamicTooltip.prototype={displayTooltip:function(externalFile,inputObj)
{DHTMLSuite.commonObj.loadCSS(this.layoutCss);if(!this.dynContentObj){this.dynContentObj=new DHTMLSuite.dynamicContent();}
if(!this.ajax_tooltipObj)
{this.ajax_tooltipObj=document.createElement('DIV');this.ajax_tooltipObj.style.position='absolute';this.ajax_tooltipObj.id='DHTMLSuite_ajax_tooltipObj';document.body.appendChild(this.ajax_tooltipObj);var leftDiv=document.createElement('DIV');leftDiv.className='DHTMLSuite_ajax_tooltip_arrow';leftDiv.id='DHTMLSuite_ajax_tooltip_arrow';leftDiv.style.backgroundImage='url(\''+DHTMLSuite.configObj.imagePath+'dyn-tooltip-arrow.gif'+'\')';this.ajax_tooltipObj.appendChild(leftDiv);var contentDiv=document.createElement('DIV');contentDiv.className='DHTMLSuite_ajax_tooltip_content';this.ajax_tooltipObj.appendChild(contentDiv);contentDiv.id='DHTMLSuite_ajax_tooltip_content';if(DHTMLSuite.clientInfoObj.isMSIE){this.ajax_tooltipObj_iframe=document.createElement('<IFRAME frameborder="0">');this.ajax_tooltipObj_iframe.style.position='absolute';this.ajax_tooltipObj_iframe.border='0';this.ajax_tooltipObj_iframe.frameborder=0;this.ajax_tooltipObj_iframe.style.backgroundColor='#FFF';this.ajax_tooltipObj_iframe.src='about:blank';contentDiv.appendChild(this.ajax_tooltipObj_iframe);this.ajax_tooltipObj_iframe.style.left='0px';this.ajax_tooltipObj_iframe.style.top='0px';}}
this.ajax_tooltipObj.style.display='block';this.dynContentObj.loadContent('DHTMLSuite_ajax_tooltip_content',externalFile);if(DHTMLSuite.clientInfoObj.isMSIE){this.ajax_tooltipObj_iframe.style.width=this.ajax_tooltipObj.clientWidth+'px';this.ajax_tooltipObj_iframe.style.height=this.ajax_tooltipObj.clientHeight+'px';}
this.__positionTooltip(inputObj);},setLayoutCss:function(newCssFileName)
{this.layoutCss=newCssFileName;},hideTooltip:function()
{this.ajax_tooltipObj.style.display='none';},__positionTooltip:function(inputObj)
{var leftPos=(DHTMLSuite.commonObj.getLeftPos(inputObj)+inputObj.offsetWidth);var topPos=DHTMLSuite.commonObj.getTopPos(inputObj);var tooltipWidth=document.getElementById('DHTMLSuite_ajax_tooltip_content').offsetWidth+document.getElementById('DHTMLSuite_ajax_tooltip_arrow').offsetWidth;this.ajax_tooltipObj.style.left=leftPos+'px';this.ajax_tooltipObj.style.top=topPos+'px';}}
DHTMLSuite.infoPanel=function()
{var xpPanel_slideActive;var xpPanel_slideSpeed;var xpPanel_onlyOneExpandedPane;var savedActivePane;var savedActiveSub;var xpPanel_currentDirection;var cookieNames;var layoutCSS;var arrayOfPanes;var dynamicContentObj;var paneHeights;var currentlyExpandedPane=false;this.xpPanel_slideActive=true;this.xpPanel_slideSpeed=20;this.xpPanel_onlyOneExpandedPane=false;this.savedActivePane=false;this.savedActiveSub=false;this.xpPanel_currentDirection=new Array();this.cookieNames=new Array();this.currentlyExpandedPane=false;this.layoutCSS='info-pane.css';this.arrayOfPanes=new Array();this.paneHeights=new Array();if(!standardObjectsCreated)DHTMLSuite.createStandardObjects();this.dynamicContentObj=new DHTMLSuite.dynamicContent();}
DHTMLSuite.infoPanel.prototype={addPane:function(idOfPane,labelOfPane,state,nameOfCookie,width)
{var index=this.arrayOfPanes.length;this.arrayOfPanes[index]=[idOfPane,labelOfPane,state,nameOfCookie,width];},addContentToPane:function(idOfPane,pathToExternalFile)
{var obj=document.getElementById(idOfPane);var subDivs=obj.getElementsByTagName('DIV');for(var no=0;no<subDivs.length;no++){if(subDivs[no].className=='DHTMLSuite_infoPaneContent'){window.refToThisPane=this;this.__slidePane(this.xpPanel_slideSpeed,subDivs[no].id);this.dynamicContentObj.loadContent(subDivs[no].id,pathToExternalFile,"window.refToThisPane.__repositionPane('"+idOfPane+"')");if(subDivs[no].parentNode.style.display=='none'||subDivs[no].parentNode.style.height=='0px'){var topBarObj=DHTMLSuite.domQueryObj.getElementsByClassName('DHTMLSuite_infoPaneTopBar',subDivs[no].parentNode.parentNode);this.__showHidePaneContent(topBarObj[0]);}
return;}}},addStaticContentToPane:function(idOfPane,newContent)
{var obj=document.getElementById(idOfPane);var subDivs=obj.getElementsByTagName('DIV');for(var no=0;no<subDivs.length;no++){if(subDivs[no].className=='DHTMLSuite_infoPaneContent'){window.refToThisPane=this;this.__slidePane(this.xpPanel_slideSpeed,subDivs[no].id);subDivs[no].innerHTML=newContent;if(subDivs[no].parentNode.style.display=='none'||subDivs[no].parentNode.style.height=='0px'){var topBarObj=DHTMLSuite.domQueryObj.getElementsByClassName('DHTMLSuite_infoPaneTopBar',subDivs[no].parentNode.parentNode);this.__showHidePaneContent(topBarObj[0]);}
this.__repositionPane(idOfPane);return;}}},init:function()
{DHTMLSuite.commonObj.loadCSS(this.layoutCSS);for(var no=0;no<this.arrayOfPanes.length;no++){var tmpDiv=document.getElementById(this.arrayOfPanes[no][0]);tmpDiv.className='DHTMLSuite_panel';var panelTitle=this.arrayOfPanes[no][1];var panelDisplayed=this.arrayOfPanes[no][2];var nameOfCookie=this.arrayOfPanes[no][3];var widthOfPane=this.arrayOfPanes[no][4];if(widthOfPane)tmpDiv.style.width=widthOfPane;var outerContentDiv=document.createElement('DIV');var contentDiv=tmpDiv.getElementsByTagName('DIV')[0];contentDiv.className='DHTMLSuite_infoPaneContent';contentDiv.id='infoPaneContent'+no;outerContentDiv.appendChild(contentDiv);this.cookieNames[this.cookieNames.length]=nameOfCookie;outerContentDiv.id='paneContent'+no;outerContentDiv.className='DHTMLSuite_panelContent';outerContentDiv.style.backgroundImage='url(\''+DHTMLSuite.configObj.imagePath+'xp-info-pane-bg_pane_right.gif'+'\')';var topBar=document.createElement('DIV');topBar.onselectstart=function(){return DHTMLSuite.commonObj.cancelEvent()};DHTMLSuite.commonObj.__addEventElement(topBar);var span=document.createElement('SPAN');span.innerHTML=panelTitle;topBar.appendChild(span);topBar.style.backgroundImage='url(\''+DHTMLSuite.configObj.imagePath+'xp-info-pane-bg_panel_top_right.gif'+'\')';window.refToXpPane=this;topBar.onclick=function(){window.refToXpPane.__showHidePaneContent(this)};if(document.all)topBar.ondblclick=function(){window.refToXpPane.__showHidePaneContent(this)};;topBar.onmouseover=this.__mouseoverTopbar;topBar.onmouseout=this.__mouseoutTopbar;topBar.style.position='relative';var img=document.createElement('IMG');img.id='showHideButton'+no;img.src=DHTMLSuite.configObj.imagePath+'xp-info-pane-arrow_up.gif';topBar.appendChild(img);if(nameOfCookie){cookieValue=DHTMLSuite.commonObj.getCookie(nameOfCookie);if(cookieValue)panelDisplayed=cookieValue==1?true:false;}
if(!panelDisplayed){outerContentDiv.style.height='0px';contentDiv.style.top=0-contentDiv.offsetHeight+'px';if(document.all)outerContentDiv.style.display='none';img.src=DHTMLSuite.configObj.imagePath+'xp-info-pane-arrow_down.gif';}
topBar.className='DHTMLSuite_infoPaneTopBar';topBar.id='infoPane_topBar'+no;tmpDiv.appendChild(topBar);tmpDiv.appendChild(outerContentDiv);}},__repositionPane:function(idOfPane)
{var obj=document.getElementById(idOfPane);var subDivs=obj.getElementsByTagName('DIV');for(var no=0;no<subDivs.length;no++){if(subDivs[no].className=='DHTMLSuite_panelContent'){subDivs[no].style.overflow='auto';subDivs[no].style.height='';var contentDiv=subDivs[no].getElementsByTagName('DIV')[0];var tmpHeight=subDivs[no].clientHeight;tmpHeight=subDivs[no].offsetHeight;subDivs[no].style.height=tmpHeight+'px';if(tmpHeight)this.paneHeights[subDivs[no].id]=tmpHeight;subDivs[no].style.top='0px';subDivs[no].style.overflow='hidden';var subSub=subDivs[no].getElementsByTagName('DIV')[0];subSub.style.top='0px';}}},__showHidePaneContent:function(inputObj,methodWhenFinished)
{var img=inputObj.getElementsByTagName('IMG')[0];var numericId=img.id.replace(/[^0-9]/g,'');var obj=document.getElementById('paneContent'+numericId);if(img.src.toLowerCase().indexOf('up')>=0){this.currentlyExpandedPane=false;img.src=img.src.replace('up','down');if(this.xpPanel_slideActive){obj.style.display='block';this.xpPanel_currentDirection[obj.id]=(this.xpPanel_slideSpeed*-1);this.__slidePane((this.xpPanel_slideSpeed*-1),obj.id,methodWhenFinished);}else{obj.style.display='none';}
if(this.cookieNames[numericId])DHTMLSuite.commonObj.setCookie(this.cookieNames[numericId],'0',100000);}else{if(inputObj){if(this.currentlyExpandedPane&&this.xpPanel_onlyOneExpandedPane)this.__showHidePaneContent(this.currentlyExpandedPane);this.currentlyExpandedPane=inputObj;}
img.src=img.src.replace('down','up');if(this.xpPanel_slideActive){if(document.all){obj.style.display='block';}
this.xpPanel_currentDirection[obj.id]=this.xpPanel_slideSpeed;this.__slidePane(this.xpPanel_slideSpeed,obj.id,methodWhenFinished);}else{obj.style.display='block';subDiv=obj.getElementsByTagName('DIV')[0];obj.style.height=subDiv.offsetHeight+'px';}
if(this.cookieNames[numericId])DHTMLSuite.commonObj.setCookie(this.cookieNames[numericId],'1',100000);}
return true;},__slidePane:function(slideValue,id,methodWhenFinished)
{if(slideValue!=this.xpPanel_currentDirection[id]){return false;}
var activePane=document.getElementById(id);if(activePane==this.savedActivePane){var subDiv=this.savedActiveSub;}else{var subDiv=activePane.getElementsByTagName('DIV')[0];}
this.savedActivePane=activePane;this.savedActiveSub=subDiv;var height=activePane.offsetHeight;var innerHeight=subDiv.offsetHeight;if(this.paneHeights[activePane.id])innerHeight=this.paneHeights[activePane.id];height+=slideValue;if(height<0)height=0;if(height>innerHeight)height=innerHeight;if(document.all){activePane.style.filter='alpha(opacity='+Math.round((height/innerHeight)*100)+')';}else{var opacity=(height/innerHeight);if(opacity==0)opacity=0.01;if(opacity==1)opacity=0.99;activePane.style.opacity=opacity;}
window.refToThisInfoPane=this;if(slideValue<0){activePane.style.height=height+'px';subDiv.style.top=height-innerHeight+'px';if(height>0){setTimeout('window.refToThisInfoPane.__slidePane('+slideValue+',"'+id+'","'+methodWhenFinished+'")',10);}else{if(document.all)activePane.style.display='none';if(methodWhenFinished)eval(methodWhenFinished);}}else{subDiv.style.top=height-innerHeight+'px';activePane.style.height=height+'px';if(height<innerHeight){setTimeout('window.refToThisInfoPane.__slidePane('+slideValue+',"'+id+'","'+methodWhenFinished+'")',10);}else{if(methodWhenFinished)eval(methodWhenFinished);}}},__mouseoverTopbar:function()
{var img=this.getElementsByTagName('IMG')[0];var src=img.src;img.src=img.src.replace('.gif','_over.gif');var span=this.getElementsByTagName('SPAN')[0];span.style.color='#428EFF';},__mouseoutTopbar:function()
{var img=this.getElementsByTagName('IMG')[0];var src=img.src;img.src=img.src.replace('_over.gif','.gif');var span=this.getElementsByTagName('SPAN')[0];span.style.color='';}}
DHTMLSuite.progressBar=function()
{var progressBar_steps;var div_progressPane;var div_progressBar_bg;var div_progressBar_outer;var div_progressBar_txt;var progressBarWidth;var currentStep;var layoutCSS;this.progressBar_steps=50;this.progressPane=false;this.progressBar_bg=false;this.progressBar_outer=false;this.progressBar_txt=false;this.progressBarWidth;this.currentStep=0;this.layoutCSS='progress-bar.css';if(!standardObjectsCreated)DHTMLSuite.createStandardObjects();}
DHTMLSuite.progressBar.prototype={setSteps:function(numberOfSteps)
{this.progressBar_steps=numberOfSteps;},init:function()
{document.body.style.width='100%';document.body.style.height='100%';document.documentElement.style.overflow='hidden';DHTMLSuite.commonObj.loadCSS(this.layoutCSS);this.__createProgressBarElements();},moveProgressBar:function(steps){this.progressBarWidth=this.div_progressBar_bg.clientWidth;if(!steps){this.div_progressBar_outer.style.width=progressBarWidth+'px';this.div_progressBar_txt.innerHTML='100%';this.__hideProgressBar();}else{this.currentStep+=steps;if(this.currentStep>this.progressBar_steps)this.currentStep=this.progressBar_steps;var width=Math.ceil(this.progressBarWidth*(this.currentStep/this.progressBar_steps));this.div_progressBar_outer.style.width=width+'px';var percent=Math.ceil((this.currentStep/this.progressBar_steps)*100);this.div_progressBar_txt.innerHTML=percent+'%';if(this.currentStep==this.progressBar_steps){this.__hideProgressBar();}}},__hideProgressBar:function()
{document.body.style.width=null;document.body.style.height=null;document.documentElement.style.overflow='';setTimeout('document.getElementById("DHTMLSuite_progressPane").style.display="none"',50);},__createProgressBarElements:function()
{this.div_progressPane=document.createElement('DIV');this.div_progressPane.id='DHTMLSuite_progressPane';document.body.appendChild(this.div_progressPane);this.div_progressBar_bg=document.createElement('DIV');this.div_progressBar_bg.id='DHTMLSuite_progressBar_bg';this.div_progressPane.appendChild(this.div_progressBar_bg);this.div_progressBar_outer=document.createElement('DIV');this.div_progressBar_outer.id='DHTMLSuite_progressBar_outer';this.div_progressBar_bg.appendChild(this.div_progressBar_outer);var div=document.createElement('DIV');div.id='DHTMLSuite_progressBar';this.div_progressBar_outer.appendChild(div);this.div_progressBar_txt=document.createElement('DIV');this.div_progressBar_txt.id='DHTMLSuite_progressBar_txt';this.div_progressBar_txt.innerHTML='0 %';this.div_progressBar_bg.appendChild(this.div_progressBar_txt);}}
DHTMLSuite.menuModelItem=function()
{var id;var itemText;var itemIcon;var url;var parentId;var separator;var jsFunction;var depth;var hasSubs;var type;var helpText;var state;var submenuWidth;var visible;this.state='regular';}
DHTMLSuite.menuModelItem.prototype={setMenuVars:function(id,itemText,itemIcon,url,parentId,helpText,jsFunction,type,submenuWidth)
{this.id=id;this.itemText=itemText;this.itemIcon=itemIcon;this.url=url;this.parentId=parentId;this.jsFunction=jsFunction;this.separator=false;this.depth=false;this.hasSubs=false;this.helpText=helpText;this.submenuWidth=submenuWidth;this.visible=true;if(!type){if(this.parentId)this.type='top';else this.type='sub';}else this.type=type;},setAsSeparator:function(id,parentId)
{this.id=id;this.parentId=parentId;this.separator=true;this.visible=true;if(this.parentId)this.type='top';else this.type='sub';},setVisibility:function(visible)
{this.visible=visible;},getState:function()
{return this.state;},setState:function(newState)
{this.state=newState;},setSubMenuWidth:function(newWidth)
{this.submenuWidth=newWidth;},setIcon:function(iconPath)
{this.itemIcon=iconPath;},setText:function(newText)
{this.itemText=newText;}}
DHTMLSuite.menuModel=function()
{var menuItems;var menuItemsOrder;var submenuType;var mainMenuGroupWidth;this.menuItems=new Array();this.menuItemsOrder=new Array();this.submenuType=new Array();this.submenuType[1]='top';for(var no=2;no<20;no++){this.submenuType[no]='sub';}
if(!standardObjectsCreated)DHTMLSuite.createStandardObjects();}
DHTMLSuite.menuModel.prototype={addItem:function(id,itemText,itemIcon,url,parentId,helpText,jsFunction,type,submenuWidth)
{if(!id)id=this.__getUniqueId();this.menuItems[id]=new DHTMLSuite.menuModelItem();this.menuItems[id].setMenuVars(id,itemText,itemIcon,url,parentId,helpText,jsFunction,type,submenuWidth);this.menuItemsOrder[this.menuItemsOrder.length]=id;return this.menuItems[id];},addItemsFromMarkup:function(ulId)
{if(!document.getElementById(ulId)){alert('<UL> tag with id '+ulId+' does not exist');return;}
var ulObj=document.getElementById(ulId);var liTags=ulObj.getElementsByTagName('LI');for(var no=0;no<liTags.length;no++){var id=liTags[no].id.replace(/[^0-9]/gi,'');if(!id)id=this.__getUniqueId();this.menuItems[id]=new DHTMLSuite.menuModelItem();this.menuItemsOrder[this.menuItemsOrder.length]=id;var parentId=0;if(liTags[no].parentNode!=ulObj)parentId=liTags[no].parentNode.parentNode.id;var type=liTags[no].getAttribute('itemType');if(!type)type=liTags[no].itemType;if(type=='separator'){this.menuItems[id].setAsSeparator(id,parentId);continue;}
if(parentId)type='sub';else type='top';var aTag=liTags[no].getElementsByTagName('A')[0];if(!aTag){continue;}
if(aTag)var itemText=aTag.innerHTML;var itemIcon=liTags[no].getAttribute('itemIcon');var url=aTag.href;if(url=='#'||url.substr(url.length-1,1)=='#')url='';var jsFunction=liTags[no].getAttribute('jsFunction');var submenuWidth=false;var helpText=aTag.getAttribute('title');if(!helpText)helpText=aTag.title;this.menuItems[id].setMenuVars(id,itemText,itemIcon,url,parentId,helpText,jsFunction,type,submenuWidth);}
var subUls=ulObj.getElementsByTagName('UL');for(var no=0;no<subUls.length;no++){var width=subUls[no].getAttribute('width');if(!width)width=subUls[no].width;if(width){var id=subUls[no].parentNode.id.replace(/[^0-9]/gi,'');this.setSubMenuWidth(id,width);}}
ulObj.style.display='none';},setSubMenuWidth:function(id,newWidth)
{this.menuItems[id].setSubMenuWidth(newWidth);},setMainMenuGroupWidth:function(newWidth)
{this.mainMenuGroupWidth=newWidth;},addSeparator:function(parentId)
{id=this.__getUniqueId();if(!parentId)parentId=0;this.menuItems[id]=new DHTMLSuite.menuModelItem();this.menuItems[id].setAsSeparator(id,parentId);this.menuItemsOrder[this.menuItemsOrder.length]=id;return this.menuItems[id];},init:function()
{this.__getDepths();this.__setHasSubs();},setMenuItemVisibility:function(id,visible)
{this.menuItems[id].setVisibility(visible);},setSubMenuType:function(depth,newType)
{this.submenuType[depth]=newType;},getItems:function(parentId,returnArray)
{if(!parentId)return this.menuItems;if(!returnArray)returnArray=new Array();for(var no=0;no<this.menuItemsOrder.length;no++){var id=this.menuItemsOrder[no];if(!id)continue;if(this.menuItems[id].parentId==parentId){returnArray[returnArray.length]=this.menuItems[id];if(this.menuItems[id].hasSubs)return this.getItems(this.menuItems[id].id,returnArray);}}
return returnArray;},__getUniqueId:function()
{var num=Math.random()+'';num=num.replace('.','');num='99'+num;num=num/1;while(this.menuItems[num]){num=Math.random()+'';num=num.replace('.','');num=num/1;}
return num;},__getDepths:function()
{for(var no=0;no<this.menuItemsOrder.length;no++){var id=this.menuItemsOrder[no];if(!id)continue;this.menuItems[id].depth=1;if(this.menuItems[id].parentId){this.menuItems[id].depth=this.menuItems[this.menuItems[id].parentId].depth+1;}
this.menuItems[id].type=this.submenuType[this.menuItems[id].depth];}},__setHasSubs:function()
{for(var no=0;no<this.menuItemsOrder.length;no++){var id=this.menuItemsOrder[no];if(!id)continue;if(this.menuItems[id].parentId){this.menuItems[this.menuItems[id].parentId].hasSubs=1;}}},__hasSubs:function(id)
{for(var no=0;no<this.menuItemsOrder.length;no++){var id=this.menuItemsOrder[no];if(!id)continue;if(this.menuItems[id].parentId==id)return true;}
return false;},__deleteChildNodes:function(parentId,recursive)
{var itemsToDeleteFromOrderArray=new Array();for(var prop=0;prop<this.menuItemsOrder.length;prop++){var id=this.menuItemsOrder[prop];if(!id)continue;if(this.menuItems[id].parentId==parentId&&parentId){this.menuItems[id]=false;itemsToDeleteFromOrderArray[itemsToDeleteFromOrderArray.length]=id;this.__deleteChildNodes(id,true);}}
if(!recursive){for(var prop=0;prop<itemsToDeleteFromOrderArray.length;prop++){if(!itemsToDeleteFromOrderArray[prop])continue;this.__deleteItemFromItemOrderArray(itemsToDeleteFromOrderArray[prop]);}}
this.__setHasSubs();},__deleteANode:function(id)
{this.menuItems[id]=false;this.__deleteItemFromItemOrderArray(id);},__deleteItemFromItemOrderArray:function(id)
{for(var no=0;no<this.menuItemsOrder.length;no++){var tmpId=this.menuItemsOrder[no];if(!tmpId)continue;if(this.menuItemsOrder[no]==id){this.menuItemsOrder.splice(no,1);return;}}},__appendMenuModel:function(newModel,parentId)
{if(!newModel)return;var items=newModel.getItems();for(var no=0;no<newModel.menuItemsOrder.length;no++){var id=newModel.menuItemsOrder[no];if(!id)continue;if(!items[id].parentId)items[id].parentId=parentId;this.menuItems[id]=items[id];for(var no2=0;no2<this.menuItemsOrder.length;no2++){if(!this.menuItemsOrder[no2])continue;if(this.menuItemsOrder[no2]==items[id].id){this.menuItemsOrder.splice(no2,1);}}
this.menuItemsOrder[this.menuItemsOrder.length]=items[id].id;}
this.__getDepths();this.__setHasSubs();}}
DHTMLSuite.menuItem=function()
{var layoutCSS;var divElement;var expandElement;var cssPrefix;var modelItemRef;this.layoutCSS='menu-item.css';this.cssPrefix='DHTMLSuite_';if(!standardObjectsCreated)DHTMLSuite.createStandardObjects();var objectIndex;this.objectIndex=DHTMLSuite.variableStorage.arrayOfDhtmlSuiteObjects.length;}
DHTMLSuite.menuItem.prototype={createItem:function(menuModelItemObj)
{DHTMLSuite.commonObj.loadCSS(this.layoutCSS);DHTMLSuite.variableStorage.arrayOfDhtmlSuiteObjects[this.objectIndex]=this;this.modelItemRef=menuModelItemObj;this.divElement=document.createElement('DIV');this.divElement.id='DHTMLSuite_menuItem'+menuModelItemObj.id;this.divElement.className=this.cssPrefix+'menuItem_'+menuModelItemObj.type+'_regular';this.divElement.onselectstart=function(){return DHTMLSuite.commonObj.cancelEvent()};if(menuModelItemObj.helpText){this.divElement.title=menuModelItemObj.helpText;}
if(menuModelItemObj.type=='top'){this.__createMenuElementsOfTypeTop(this.divElement);}
if(menuModelItemObj.type=='sub'){this.__createMenuElementsOfTypeSub(this.divElement);}
if(menuModelItemObj.separator){this.divElement.className=this.cssPrefix+'menuItem_separator_'+menuModelItemObj.type;this.divElement.innerHTML='<span></span>';}else{var tmpVar=this.objectIndex/1;this.divElement.onclick=function(e){DHTMLSuite.variableStorage.arrayOfDhtmlSuiteObjects[tmpVar].__navigate(e);}
this.divElement.onmousedown=this.__clickMenuItem;this.divElement.onmouseup=this.__rolloverMenuItem;this.divElement.onmouseover=this.__rolloverMenuItem;this.divElement.onmouseout=this.__rolloutMenuItem;DHTMLSuite.commonObj.__addEventElement(this.divElement);}
return this.divElement;},setLayoutCss:function(newLayoutCss)
{this.layoutCSS=newLayoutCss;},__createMenuElementsOfTypeTop:function(parentEl){if(this.modelItemRef.itemIcon){var iconDiv=document.createElement('DIV');iconDiv.innerHTML='<img src="'+this.modelItemRef.itemIcon+'">';iconDiv.id='menuItemIcon'+this.modelItemRef.id
parentEl.appendChild(iconDiv);}
if(this.modelItemRef.itemText){var div=document.createElement('DIV');div.innerHTML=this.modelItemRef.itemText;div.className=this.cssPrefix+'menuItem_textContent';div.id='menuItemText'+this.modelItemRef.id;parentEl.appendChild(div);}
var div=document.createElement('DIV');div.className=this.cssPrefix+'menuItem_top_arrowShowSub';div.id='DHTMLSuite_menuBar_arrow'+this.modelItemRef.id;parentEl.appendChild(div);this.expandElement=div;if(!this.modelItemRef.hasSubs)div.style.display='none';},__createMenuElementsOfTypeSub:function(parentEl){if(this.modelItemRef.itemIcon){parentEl.style.backgroundImage='url(\''+this.modelItemRef.itemIcon+'\')';parentEl.style.backgroundRepeat='no-repeat';parentEl.style.backgroundPosition='left center';}
if(this.modelItemRef.itemText){var div=document.createElement('DIV');div.className='DHTMLSuite_textContent';div.innerHTML=this.modelItemRef.itemText;div.className=this.cssPrefix+'menuItem_textContent';div.id='menuItemText'+this.modelItemRef.id;parentEl.appendChild(div);}
var div=document.createElement('DIV');div.className=this.cssPrefix+'menuItem_sub_arrowShowSub';parentEl.appendChild(div);div.id='DHTMLSuite_menuBar_arrow'+this.modelItemRef.id;this.expandElement=div;if(!this.modelItemRef.hasSubs){div.style.display='none';}else{div.previousSibling.style.paddingRight='15px';}},setCssPrefix:function(cssPrefix)
{this.cssPrefix=cssPrefix;},setIcon:function(newPath)
{this.modelItemRef.setIcon(newPath);if(this.modelItemRef.type=='top'){var div=document.getElementById('menuItemIcon'+this.modelItemRef.id);var img=div.getElementsByTagName('IMG')[0];if(!img){img=document.createElement('IMG');div.appendChild(img);}
img.src=newPath;if(!newPath)img.parentNode.removeChild(img);}
if(this.modelItemRef.type=='sub'){this.divElement.style.backgroundImage='url(\''+newPath+'\')';}},setText:function(newText)
{this.modelItemRef.setText(newText);document.getElementById('menuItemText'+this.modelItemRef.id).innerHTML=newText;},__clickMenuItem:function()
{this.className=this.className.replace('_regular','_click');this.className=this.className.replace('_over','_click');},__rolloverMenuItem:function()
{this.className=this.className.replace('_regular','_over');this.className=this.className.replace('_click','_over');},__rolloutMenuItem:function()
{this.className=this.className.replace('_over','_regular');},setState:function(newState)
{this.divElement.className=this.cssPrefix+'menuItem_'+this.modelItemRef.type+'_'+newState;this.modelItemRef.setState(newState);},getState:function()
{var state=this.modelItemRef.getState();if(!state){if(this.divElement.className.indexOf('_over')>=0)state='over';if(this.divElement.className.indexOf('_click')>=0)state='click';this.modelItemRef.setState(state);}
return state;},__setHasSub:function(hasSubs)
{this.modelItemRef.hasSubs=hasSubs;if(!hasSubs){document.getElementById(this.cssPrefix+'menuBar_arrow'+this.modelItemRef.id).style.display='none';}else{document.getElementById(this.cssPrefix+'menuBar_arrow'+this.modelItemRef.id).style.display='block';}},hide:function()
{this.modelItemRef.setVisibility(false);this.divElement.style.display='none';},show:function()
{this.modelItemRef.setVisibility(true);this.divElement.style.display='block';},__hideGroup:function()
{if(this.modelItemRef.parentId){this.divElement.parentNode.style.visibility='hidden';if(DHTMLSuite.clientInfoObj.isMSIE){try{var tmpId=this.divElement.parentNode.id.replace(/[^0-9]/gi,'');document.getElementById('DHTMLSuite_menuBarIframe_'+tmpId).style.visibility='hidden';}catch(e){}}}},__navigate:function(e)
{if(document.all)e=event;if(e){var srcEl=DHTMLSuite.commonObj.getSrcElement(e);if(srcEl.id.indexOf('arrow')>=0)return;}
if(this.modelItemRef.state=='disabled')return;if(this.modelItemRef.url){location.href=this.modelItemRef.url;}
if(this.modelItemRef.jsFunction){try{eval(this.modelItemRef.jsFunction);}catch(e){alert('Defined Javascript code for the menu item( '+this.modelItemRef.jsFunction+' ) cannot be executed');}}}}
DHTMLSuite.menuBar=function()
{var menuItemObj;var layoutCSS;var menuBarBackgroundImage;var menuItem_objects;var menuBarObj;var menuBarHeight;var menuItems;var highlightedItems;var menuBarState;var activeSubItemsOnMouseOver;var submenuGroups;var submenuIframes;var createIframesForOldIeBrowsers;var targetId;var menuItemCssPrefix;var cssPrefix;var menuItemLayoutCss;var globalObjectIndex;this.cssPrefix='DHTMLSuite_';this.menuItemLayoutCss=false;this.layoutCSS='menu-bar.css';this.menuBarBackgroundImage='menu_strip_bg.jpg';this.menuItem_objects=new Array();DHTMLSuite.variableStorage.menuBar_highlightedItems=new Array();this.menuBarState=false;this.menuBarObj=false;this.menuBarHeight=26;this.submenuGroups=new Array();this.submenuIframes=new Array();this.targetId=false;this.activeSubItemsOnMouseOver=false;this.menuItemCssPrefix=false;this.createIframesForOldIeBrowsers=true;if(!standardObjectsCreated)DHTMLSuite.createStandardObjects();}
DHTMLSuite.menuBar.prototype={init:function()
{DHTMLSuite.commonObj.loadCSS(this.layoutCSS);this.__createDivs();this.__createMenuItems();this.__setBasicEvents();window.refToThismenuBar=this;},setTarget:function(targetId)
{this.targetId=targetId;},setLayoutCss:function(layoutCSS)
{this.layoutCSS=layoutCSS;},setMenuItemLayoutCss:function(layoutCSS)
{this.menuItemLayoutCss=layoutCSS;},setCreateIframesForOldIeBrowsers:function(createIframesForOldIeBrowsers)
{this.createIframesForOldIeBrowsers=createIframesForOldIeBrowsers;},addMenuItems:function(menuItemObj)
{this.menuItemObj=menuItemObj;this.menuItems=menuItemObj.getItems();},setActiveSubItemsOnMouseOver:function(activateSubOnMouseOver)
{this.activeSubItemsOnMouseOver=activateSubOnMouseOver;},setMenuItemState:function(menuItemId,state)
{this.menuItem_objects[menuItemId].setState(state);},setMenuItemCssPrefix:function(newCssPrefix)
{this.menuItemCssPrefix=newCssPrefix;},setCssPrefix:function(newCssPrefix)
{this.cssPrefix=newCssPrefix;},replaceMenuItems:function(parentId,newMenuModel)
{this.hideSubMenus();this.__deleteMenuItems(parentId);this.menuItemObj.__appendMenuModel(newMenuModel,parentId);this.__clearAllMenuItems();this.__createMenuItems();},deleteMenuItems:function(parentId,includeParent)
{this.hideSubMenus();this.__deleteMenuItems(parentId,includeParent);this.__clearAllMenuItems();this.__createMenuItems();},appendMenuItems:function(parentId,newMenuModel)
{this.hideSubMenus();this.menuItemObj.__appendMenuModel(newMenuModel,parentId);this.__clearAllMenuItems();this.__createMenuItems();},hideMenuItem:function(id)
{this.menuItem_objects[id].hide();},showMenuItem:function(id)
{this.menuItem_objects[id].show();},setText:function(id,newText)
{this.menuItem_objects[id].setText(newText);},setIcon:function(id,newPath)
{this.menuItem_objects[id].setIcon(newPath);},__clearAllMenuItems:function()
{for(var prop=0;prop<this.menuItemObj.menuItemsOrder.length;prop++){var id=this.menuItemObj.menuItemsOrder[prop];if(!id)continue;if(this.submenuGroups[id]){this.submenuGroups[id].parentNode.removeChild(this.submenuGroups[id]);this.submenuGroups[id]=false;}
if(this.submenuIframes[id]){this.submenuIframes[id].parentNode.removeChild(this.submenuIframes[id]);this.submenuIframes[id]=false;}}
this.menuBarObj.innerHTML='';},__deleteMenuItems:function(parentId,includeParent)
{if(includeParent)this.menuItemObj.__deleteANode(parentId);if(!this.submenuGroups[parentId])return;this.menuItem_objects[parentId].__setHasSub(false);this.menuItemObj.__deleteChildNodes(parentId);var groupBox=this.submenuGroups[parentId];groupBox.parentNode.removeChild(groupBox);if(this.submenuIframes[parentId]){this.submenuIframes[parentId].parentNode.removeChild(this.submenuIframes[parentId]);}
this.submenuGroups.splice(parentId,1);this.submenuIframes.splice(parentId,1);},__changeMenuBarState:function(){var objectIndex=this.getAttribute('objectRef');var obj=DHTMLSuite.variableStorage.arrayOfDhtmlSuiteObjects[objectIndex];var parentId=this.id.replace(/[^0-9]/gi,'');var state=obj.menuItem_objects[parentId].getState();if(state=='disabled')return;obj.menuBarState=!obj.menuBarState;if(!obj.menuBarState)obj.hideSubMenus();else{obj.hideSubMenus();obj.__expandGroup(parentId);}},__createDivs:function()
{window.refTomenuBar=this;this.menuBarObj=document.createElement('DIV');this.menuBarObj.className=this.cssPrefix+'menuBar_'+this.menuItemObj.submenuType[1];if(!document.getElementById(this.targetId)){alert('No target defined for the menu object');return;}
var target=document.getElementById(this.targetId);target.appendChild(this.menuBarObj);},hideSubMenus:function(e)
{if(this&&this.tagName){if(document.all)e=event;var srcEl=DHTMLSuite.commonObj.getSrcElement(e);if(srcEl.tagName.toLowerCase()=='img')srcEl=srcEl.parentNode;if(srcEl.className&&srcEl.className.indexOf('arrow')>=0){return;}}
for(var no=0;no<DHTMLSuite.variableStorage.menuBar_highlightedItems.length;no++){DHTMLSuite.variableStorage.menuBar_highlightedItems[no].setState('regular');DHTMLSuite.variableStorage.menuBar_highlightedItems[no].__hideGroup();}
DHTMLSuite.variableStorage.menuBar_highlightedItems=new Array();},__expandGroup:function(parentId)
{var groupRef=this.submenuGroups[parentId];var subDiv=groupRef.getElementsByTagName('DIV')[0];var numericId=subDiv.id.replace(/[^0-9]/g,'');groupRef.style.visibility='visible';if(this.submenuIframes[parentId])this.submenuIframes[parentId].style.visibility='visible';DHTMLSuite.variableStorage.menuBar_highlightedItems[DHTMLSuite.variableStorage.menuBar_highlightedItems.length]=this.menuItem_objects[numericId];this.__positionSubMenu(parentId);if(DHTMLSuite.clientInfoObj.isOpera){var subDiv=groupRef.getElementsByTagName('DIV')[0];subDiv.className=subDiv.className.replace('_over','_over');}},__activateMenuElements:function(inputObj,objectRef,firstIteration)
{if(!this.menuBarState&&!this.activeSubItemsOnMouseOver)return;var numericId=inputObj.id.replace(/[^0-9]/g,'');var state=this.menuItem_objects[numericId].getState();if(state=='disabled')return;if(firstIteration&&DHTMLSuite.variableStorage.menuBar_highlightedItems.length>0){this.hideSubMenus();}
var newState='over';if(!firstIteration)newState='active';this.menuItem_objects[numericId].setState(newState);if(this.submenuGroups[numericId]){this.__expandGroup(numericId);}
DHTMLSuite.variableStorage.menuBar_highlightedItems[DHTMLSuite.variableStorage.menuBar_highlightedItems.length]=this.menuItem_objects[numericId];if(objectRef.menuItems[numericId].parentId){this.__activateMenuElements(objectRef.menuItem_objects[objectRef.menuItems[numericId].parentId].divElement,objectRef,false);}},__createMenuItems:function()
{if(!this.globalObjectIndex)this.globalObjectIndex=DHTMLSuite.variableStorage.arrayOfDhtmlSuiteObjects.length;;var index=this.globalObjectIndex;DHTMLSuite.variableStorage.arrayOfDhtmlSuiteObjects[index]=this;var firstChild=false;var firstChilds=document.getElementsByTagName('DIV');if(firstChilds.length>0)firstChild=firstChilds[0]
for(var no=0;no<this.menuItemObj.menuItemsOrder.length;no++){var indexThis=this.menuItemObj.menuItemsOrder[no];if(!this.menuItems[indexThis].id)continue;this.menuItem_objects[this.menuItems[indexThis].id]=new DHTMLSuite.menuItem();if(this.menuItemCssPrefix)this.menuItem_objects[this.menuItems[indexThis].id].setCssPrefix(this.menuItemCssPrefix);if(this.menuItemLayoutCss)this.menuItem_objects[this.menuItems[indexThis].id].setLayoutCss(this.menuItemLayoutCss);var ref=this.menuItem_objects[this.menuItems[indexThis].id].createItem(this.menuItems[indexThis]);if(!this.menuItems[indexThis].separator)DHTMLSuite.commonObj.addEvent(ref,"mouseover",function(){DHTMLSuite.variableStorage.arrayOfDhtmlSuiteObjects[index].__activateMenuElements(this,DHTMLSuite.variableStorage.arrayOfDhtmlSuiteObjects[index],true);});if(this.menuItem_objects[this.menuItems[indexThis].id].expandElement){var expandRef=this.menuItem_objects[this.menuItems[indexThis].id].expandElement;var parentId=DHTMLSuite.variableStorage.arrayOfDhtmlSuiteObjects[index].menuItems[indexThis].parentId+'';var tmpId=expandRef.id.replace(/[^0-9]/gi,'');expandRef.setAttribute('objectRef',index);expandRef.objectRef=index;expandRef.onclick=this.__changeMenuBarState;}
var target=this.menuBarObj;if(this.menuItems[indexThis].depth==1&&this.menuItemObj.submenuType[this.menuItems[indexThis].depth]!='top'&&this.menuItemObj.mainMenuGroupWidth){var tmpWidth=this.menuItemObj.mainMenuGroupWidth+'';if(tmpWidth.indexOf('%')==-1)tmpWidth=tmpWidth+'px';target.style.width=tmpWidth;}
if(this.menuItems[indexThis].depth=='1'){if(this.menuItemObj.submenuType[this.menuItems[indexThis].depth]=='top'){ref.style.styleFloat='left';ref.style.cssText='float:left';}}else{if(!this.menuItems[indexThis].depth){alert('Error in menu model(depth not defined for a menu item). Remember to call the init() method for the menuModel object.');return;}
if(!this.submenuGroups[this.menuItems[indexThis].parentId]){this.submenuGroups[this.menuItems[indexThis].parentId]=document.createElement('DIV');this.submenuGroups[this.menuItems[indexThis].parentId].style.zIndex=30000;this.submenuGroups[this.menuItems[indexThis].parentId].style.position='absolute';this.submenuGroups[this.menuItems[indexThis].parentId].id='DHTMLSuite_menuBarSubGroup'+this.menuItems[indexThis].parentId;this.submenuGroups[this.menuItems[indexThis].parentId].style.visibility='hidden';this.submenuGroups[this.menuItems[indexThis].parentId].className=this.cssPrefix+'menuBar_'+this.menuItemObj.submenuType[this.menuItems[indexThis].depth];if(firstChild){firstChild.parentNode.insertBefore(this.submenuGroups[this.menuItems[indexThis].parentId],firstChild);}else{document.body.appendChild(this.submenuGroups[this.menuItems[indexThis].parentId]);}
if(DHTMLSuite.clientInfoObj.isMSIE&&this.createIframesForOldIeBrowsers){this.submenuIframes[this.menuItems[indexThis].parentId]=document.createElement('<IFRAME src="about:blank" frameborder=0>');this.submenuIframes[this.menuItems[indexThis].parentId].id='DHTMLSuite_menuBarIframe_'+this.menuItems[indexThis].parentId;this.submenuIframes[this.menuItems[indexThis].parentId].style.position='absolute';this.submenuIframes[this.menuItems[indexThis].parentId].style.zIndex=9000;this.submenuIframes[this.menuItems[indexThis].parentId].style.visibility='hidden';if(firstChild){firstChild.parentNode.insertBefore(this.submenuIframes[this.menuItems[indexThis].parentId],firstChild);}else{document.body.appendChild(this.submenuIframes[this.menuItems[indexThis].parentId]);}}}
target=this.submenuGroups[this.menuItems[indexThis].parentId];}
target.appendChild(ref);if(this.menuItems[indexThis].visible==false)this.hideMenuItem(this.menuItems[indexThis].id);if(this.menuItems[indexThis].state!='regular')this.menuItem_objects[this.menuItems[indexThis].id].setState(this.menuItems[indexThis].state);}
this.__setSizeOfAllSubMenus();this.__positionAllSubMenus();if(DHTMLSuite.clientInfoObj.isOpera)this.__fixLayoutOpera();},__fixLayoutOpera:function()
{for(var no=0;no<this.menuItemObj.menuItemsOrder.length;no++){var id=this.menuItemObj.menuItemsOrder[no];if(!id)continue;this.menuItem_objects[id].divElement.className=this.menuItem_objects[id].divElement.className.replace('_regular','_regular');}},__setSizeOfAllSubMenus:function()
{for(var no=0;no<this.menuItemObj.menuItemsOrder.length;no++){var prop=this.menuItemObj.menuItemsOrder[no];if(!prop)continue;this.__setSizeOfSubMenus(prop);}},__positionAllSubMenus:function()
{for(var no=0;no<this.menuItemObj.menuItemsOrder.length;no++){var prop=this.menuItemObj.menuItemsOrder[no];if(!prop)continue;if(this.submenuGroups[prop])this.__positionSubMenu(prop);}},__positionSubMenu:function(parentId)
{try{var shortRef=this.submenuGroups[parentId];var depth=this.menuItems[parentId].depth;var dir=this.menuItemObj.submenuType[depth];if(dir=='top'){shortRef.style.left=DHTMLSuite.commonObj.getLeftPos(this.menuItem_objects[parentId].divElement)+'px';shortRef.style.top=(DHTMLSuite.commonObj.getTopPos(this.menuItem_objects[parentId].divElement)+this.menuItem_objects[parentId].divElement.offsetHeight)+'px';}else{shortRef.style.left=(DHTMLSuite.commonObj.getLeftPos(this.menuItem_objects[parentId].divElement)+this.menuItem_objects[parentId].divElement.offsetWidth)+'px';shortRef.style.top=(DHTMLSuite.commonObj.getTopPos(this.menuItem_objects[parentId].divElement))+'px';}
if(DHTMLSuite.clientInfoObj.isMSIE){var iframeRef=this.submenuIframes[parentId]
iframeRef.style.left=shortRef.style.left;iframeRef.style.top=shortRef.style.top;iframeRef.style.width=shortRef.clientWidth+'px';iframeRef.style.height=shortRef.clientHeight+'px';}}catch(e){}},__setSizeOfSubMenus:function(parentId)
{try{var shortRef=this.submenuGroups[parentId];var subWidth=Math.max(shortRef.offsetWidth,this.menuItem_objects[parentId].divElement.offsetWidth);if(this.menuItems[parentId].submenuWidth)subWidth=this.menuItems[parentId].submenuWidth;if(subWidth>400)subWidth=150;subWidth=subWidth+'';if(subWidth.indexOf('%')==-1)subWidth=subWidth+'px';shortRef.style.width=subWidth;if(DHTMLSuite.clientInfoObj.isMSIE){this.submenuIframes[parentId].style.width=shortRef.style.width;this.submenuIFrames[parentId].style.height=shortRef.style.height;}}catch(e){}},__repositionMenu:function(inputObj)
{inputObj.menuBarObj.style.top=document.documentElement.scrollTop+'px';},__menuItemRollOver:function(inputObj)
{var numericId=inputObj.id.replace(/[^0-9]/g,'');inputObj.className='DHTMLSuite_menuBar_menuItem_over_'+this.menuItems[numericId]['depth'];},__menuItemRollOut:function(inputObj)
{var numericId=inputObj.id.replace(/[^0-9]/g,'');inputObj.className='DHTMLSuite_menuBar_menuItem_'+this.menuItems[numericId]['depth'];},__menuNavigate:function(inputObj)
{var numericIndex=inputObj.id.replace(/[^0-9]/g,'');var url=this.menuItems[numericIndex]['url'];if(!url)return;},__setBasicEvents:function()
{DHTMLSuite.commonObj.addEvent(document.documentElement,"click",this.hideSubMenus);}}
DHTMLSuite.windowDataModel=function()
{var title;var icon;var resizable;var minimizable;var closable;var xPos;var yPos;var width;var height;var zIndex;var cookieName;var state;var activeTabId;var tabsVisible;var windowDataModelContent;this.windowDataModelContent=new Array();}
DHTMLSuite.windowDataModel.prototype={setTitle:function(newTitle)
{this.title=newTitle;},setIcon:function(newIcon)
{this.icon=newIcon;},setResizable:function(resizable)
{this.resizable=resizable;},setMinimizable:function(minimizable)
{this.minimizable=minimizable;},setClosable:function(closable)
{this.closable=closable;},setCookieName:function(cookieName)
{this.cookieName=cookieName;},setTabTitles:function(newTabTitles)
{for(var no=0;no<newTabTitles.length;no++){if(this.windowDataContents[no])this.windowDataContents[no].setTitle(newTabTitles[no]);}},setTabIcons:function(newTabIcons)
{for(var no=0;no<newTabIcons.length;no++){if(this.windowDataContents[no])this.windowDataContents[no].setIcon(newTabIcons[no]);}},createWindowsFromMarkup:function(elementId)
{var obj=document.getElementById(elementId);if(!obj){alert('Object with id '+elementId+' does not exists');return;}
obj.style.display='none';var divs=obj.getElementsByTagName('DIV');for(var no=0;no<divs.length;no++){if(divs[no].className=='DHTMLSuite_windowContent'){var index=this.windowDataModelContent.length;this.windowDataModelContent[index]=new DHTMLSuite.windowDataModelContent();this.windowDataModelContent[index].setId(divs[no].id);}}}}
DHTMLSuite.windowDataModelContent=function()
{var title;var icon;var textContent;var id;var visible;}
DHTMLSuite.windowDataModelContent.prototype={setTitle:function(newTitle)
{this.title=newTitle;},setIcon:function(newIcon)
{this.icon=newIcon;},setId:function(newId)
{this.id=newId;}}
DHTMLSuite.paneSplitterModel=function()
{var panes;this.panes=new Array();if(!standardObjectsCreated)DHTMLSuite.createStandardObjects();}
DHTMLSuite.paneSplitterModel.prototype={addPane:function(obj)
{this.panes[this.panes.length]=obj;},getItems:function()
{return this.panes;}}
DHTMLSuite.paneSplitterPaneModel=function(inputArray)
{var id;var position;var size;var minSize;var maxSize;var resizable;var visible;var scrollbars;var contents;var collapsable;var state;this.contents=new Array();this.scrollbars=true;this.resizable=true;this.collapsable=true;this.state='expanded';this.visible=true;if(inputArray)this.setData(inputArray);}
DHTMLSuite.paneSplitterPaneModel.prototype={setData:function(inputArray)
{if(inputArray["id"])this.id=inputArray["id"];if(inputArray["position"])this.position=inputArray["position"];if(inputArray["resizable"]===false||inputArray["resizable"]===true)this.resizable=inputArray["resizable"];if(inputArray["size"])this.size=inputArray["size"];if(inputArray["minSize"])this.minSize=inputArray["minSize"];if(inputArray["maxSize"])this.maxSize=inputArray["maxSize"];if(inputArray["visible"]===false||inputArray["visible"]===true)this.visible=inputArray["visible"];if(inputArray["collapsable"]===false||inputArray["collapsable"]===true)this.collapsable=inputArray["collapsable"];if(inputArray["scrollbars"]===false||inputArray["scrollbars"]===true)this.scrollbars=inputArray["scrollbars"];if(inputArray["state"])this.state=inputArray["state"];},setSize:function(newSize)
{this.size=newSize;},addContent:function(contentObj)
{for(var no=0;no<this.contents.length;no++){if(this.contents[no].id==contentObj.id)return false;}
this.contents[this.contents.length]=contentObj;return true;},getContents:function()
{return this.contents;},getCountContent:function()
{return this.contents.length;},getPosition:function()
{return this.position.toLowerCase();},__setState:function(state)
{this.state=state;},__getState:function(state)
{return this.state;},__deleteContent:function(contentIndex)
{try{this.contents.splice(contentIndex,1);}catch(e)
{}
var retVal=contentIndex;if(this.contents.length>(contentIndex-1))retVal--;if(retVal<0&&this.contents.length==0)return false;if(retVal<0)retVal=0;return retVal;},__getIndexFromId:function(id)
{for(var no=0;no<this.contents.length;no++){if(this.contents[no].id==id)return no;}
return false;},__setVisible:function(visible)
{this.visible=visible;}}
DHTMLSuite.paneSplitterContentModel=function(inputArray)
{var id;var htmlElementId;var title;var tabTitle;var closable;var contentUrl;this.closable=true;var refreshAfterSeconds;this.refreshAfterSeconds=0;if(inputArray)this.setData(inputArray);}
DHTMLSuite.paneSplitterContentModel.prototype={setData:function(inputArray)
{if(inputArray["id"])this.id=inputArray["id"];else this.id=inputArray['htmlElementId'];if(inputArray["closable"]===false||inputArray["closable"]===true)this.closable=inputArray["closable"];if(inputArray["title"])this.title=inputArray["title"];if(inputArray["tabTitle"])this.tabTitle=inputArray["tabTitle"];if(inputArray["contentUrl"])this.contentUrl=inputArray["contentUrl"];if(inputArray["htmlElementId"])this.htmlElementId=inputArray["htmlElementId"];if(inputArray["refreshAfterSeconds"])this.refreshAfterSeconds=inputArray["refreshAfterSeconds"];},__setIdOfContentElement:function(htmlElementId)
{this.htmlElementId=htmlElementId;},__setRefreshAfterSeconds:function(refreshAfterSeconds)
{this.refreshAfterSeconds=refreshAfterSeconds;},__setContentUrl:function(contentUrl)
{this.contentUrl=contentUrl;}}
DHTMLSuite.paneSplitterPane=function(parentRef)
{var divElement;var divElementCollapsed;var divElementCollapsedInner;var contentDiv;var headerDiv;var titleSpan;var paneModel;var resizeDiv;var tabDiv;var parentRef;var divClose;var divCollapse;var divExpand;var slideIsInProgress;var zIndexCounter;var reloadIntervalHandlers;this.contents=new Array();this.reloadIntervalHandlers=new Array();this.parentRef=parentRef;var activeContentIndex;this.activeContentIndex=0;this.slideIsInProgress=false;var objectIndex;this.zIndexCounter=1;this.objectIndex=DHTMLSuite.variableStorage.arrayOfDhtmlSuiteObjects.length;DHTMLSuite.variableStorage.arrayOfDhtmlSuiteObjects[this.objectIndex]=this;}
DHTMLSuite.paneSplitterPane.prototype={addDataSource:function(paneModel)
{this.paneModel=paneModel;},addContent:function(contentModel)
{var retValue=this.paneModel.addContent(contentModel);this.__addContentDivs();this.__updateTabContent();this.__updateView();return retValue},showContent:function(id)
{for(var no=0;no<this.paneModel.contents.length;no++){if(this.paneModel.contents[no].id==id){this.__updatePaneView(no);return;}}},loadContent:function(id,url,refreshAfterSeconds,internalCall)
{if(!url)return;for(var no=0;no<this.paneModel.contents.length;no++){if(this.paneModel.contents[no].id==id){if(internalCall&&!this.paneModel.contents[no].refreshAfterSeconds)return;this.paneModel.contents[no].__setContentUrl(url);if(refreshAfterSeconds&&!internalCall){this.paneModel.contents[no].__setRefreshAfterSeconds(refreshAfterSeconds);}
if(refreshAfterSeconds)this.__handleContentReload(id,refreshAfterSeconds);var dynContent=new DHTMLSuite.dynamicContent();dynContent.loadContent(this.paneModel.contents[no].htmlElementId,url);dynContent=false;return;}}},reloadContent:function(id)
{var contentIndex=this.paneModel.__getIndexFromId(id);if(contentIndex!==false){this.loadContent(id,this.paneModel.contents[contentIndex].contentUrl);}},setRefreshAfterSeconds:function(id,refreshAfterSeconds)
{for(var no=0;no<this.paneModel.contents.length;no++){if(this.paneModel.contents[no].id==id){if(!this.paneModel.contents[no].refreshAfterSeconds){this.loadContent(id,this.paneModel.contents[no].contentUrl,refreshAfterSeconds);}
this.paneModel.contents[no].__setRefreshAfterSeconds(refreshAfterSeconds);this.__handleContentReload(id);}}},hidePane:function()
{this.paneModel.__setVisible(false);this.divElement.style.display='none';},showPane:function()
{this.paneModel.__setVisible(true);this.divElement.style.display='block';},__handleContentReload:function(id)
{var ind=this.objectIndex;var contentIndex=this.paneModel.__getIndexFromId(id);if(contentIndex!==false){var contentRef=this.paneModel.contents[contentIndex];if(contentRef.refreshAfterSeconds){if(this.reloadIntervalHandlers[id])clearInterval(this.reloadIntervalHandlers[id]);this.reloadIntervalHandlers[id]=setInterval('DHTMLSuite.variableStorage.arrayOfDhtmlSuiteObjects['+ind+'].loadContent("'+id+'","'+contentRef.contentUrl+'",'+contentRef.refreshAfterSeconds+',true)',(contentRef.refreshAfterSeconds*1000));}else{if(this.reloadIntervalHandlers[id])clearInterval(this.reloadIntervalHandlers[id]);}}},__createPane:function()
{this.divElement=document.createElement('DIV');this.divElement.style.position='absolute';this.divElement.className='DHTMLSuite_pane';this.divElement.id='DHTMLSuite_pane_'+this.paneModel.getPosition();document.body.appendChild(this.divElement);this.__createHeaderBar();this.__createContentPane();this.__createTabBar();this.__createCollapsedPane();this.__updateView();this.__addContentDivs();this.__setSize();},__createCollapsedPane:function()
{var ind=this.objectIndex;var pos=this.paneModel.getPosition();var buttonSuffix='Vertical';if(pos=='west'||pos=='east')buttonSuffix='Horizontal';if(pos=='center')buttonSuffix='';this.divElementCollapsed=document.createElement('DIV');var obj=this.divElementCollapsed;obj.className='DHTMLSuite_pane_collapsed_'+pos;obj.style.visibility='hidden';obj.style.position='absolute';this.divElementCollapsedInner=document.createElement('DIV');this.divElementCollapsedInner.className='DHTMLSuite_pane_collapsedInner';this.divElementCollapsedInner.onmouseover=this.__mouseoverHeaderButton;this.divElementCollapsedInner.onmouseout=this.__mouseoutHeaderButton;this.divElementCollapsedInner.onclick=function(e){DHTMLSuite.variableStorage.arrayOfDhtmlSuiteObjects[ind].__slidePane(e);}
DHTMLSuite.commonObj.__addEventElement(this.divElementCollapsedInner);obj.appendChild(this.divElementCollapsedInner);var buttonDiv=document.createElement('DIV');buttonDiv.className='buttonDiv';this.divElementCollapsedInner.appendChild(buttonDiv);this.divExpand=document.createElement('DIV');if(pos=='south'||pos=='east')
this.divExpand.className='collapseButton'+buttonSuffix;else
this.divExpand.className='expandButton'+buttonSuffix;this.divExpand.onclick=function(){return DHTMLSuite.variableStorage.arrayOfDhtmlSuiteObjects[ind].__expand();};this.divExpand.onmouseover=this.__mouseoverHeaderButton;this.divExpand.onmouseout=this.__mouseoutHeaderButton;DHTMLSuite.commonObj.__addEventElement(this.divExpand);buttonDiv.appendChild(this.divExpand);document.body.appendChild(obj);},__autoSlideInPane:function(e)
{if(document.all)e=event;var state=this.paneModel.__getState();if(state=='collapsed'&&this.divElement.style.visibility!='hidden'){if(!DHTMLSuite.commonObj.isObjectClicked(this.divElement,e))this.__slidePane(e,true);}},__slidePane:function(e,forceSlide)
{if(this.slideIsInProgress)return;this.zIndexCounter++;if(document.all)e=event;var src=DHTMLSuite.commonObj.getSrcElement(e);if(src.className.indexOf('collapsed')<0&&!forceSlide)return;this.slideIsInProgress=true;var state=this.paneModel.__getState();var hideWhenComplete=true;if(this.divElement.style.visibility=='hidden'){this.__setSlideInitPosition();this.divElement.style.visibility='visible';this.divElement.style.zIndex=16000+this.zIndexCounter;this.divElementCollapsed.style.zIndex=16000+this.zIndexCounter;var slideTo=this.__getSlideToCoordinates(true);hideWhenComplete=false;var slideSpeed=this.__getSlideSpeed(true);}else{var slideTo=this.__getSlideToCoordinates(false);var slideSpeed=this.__getSlideSpeed(false);}
this.__processSlide(slideTo,slideSpeed*this.parentRef.slideSpeed,this.__getCurrentCoordinate(),hideWhenComplete);},__setSlideInitPosition:function()
{var browserWidth=DHTMLSuite.clientInfoObj.getBrowserWidth();var browserHeight=DHTMLSuite.clientInfoObj.getBrowserHeight();var pos=this.paneModel.getPosition();switch(pos){case"west":this.divElement.style.left=(0-this.paneModel.size)+'px';break;case"east":this.divElement.style.left=browserWidth+'px';break;case"north":this.divElement.style.top=(0-this.paneModel.size)+'px';break;case"south":this.divElement.style.top=browserHeight+'px';break;}},__getCurrentCoordinate:function()
{var pos=this.paneModel.getPosition();switch(pos){case"west":return this.divElement.style.left.replace('px','')/1;case"east":return this.divElement.style.left.replace('px','')/1;case"south":return this.divElement.style.top.replace('px','')/1;case"north":return this.divElement.style.top.replace('px','')/1;}},__getSlideSpeed:function(slideOut)
{var pos=this.paneModel.getPosition();switch(pos){case"west":case"north":if(slideOut)return 1;else return-1;break;case"south":case"east":if(slideOut)return-1;else return 1;}},__processSlide:function(slideTo,slidePixels,currentPos,hideWhenComplete)
{var pos=this.paneModel.getPosition();currentPos=currentPos+slidePixels;var repeatSlide=true;if(slidePixels>0&&currentPos>slideTo){currentPos=slideTo;repeatSlide=false;}
if(slidePixels<0&&currentPos<slideTo){currentPos=slideTo;repeatSlide=false;}
switch(pos){case"west":case"east":this.divElement.style.left=currentPos+'px';break;case"north":case"south":this.divElement.style.top=currentPos+'px';}
if(repeatSlide){var ind=this.objectIndex;setTimeout('DHTMLSuite.variableStorage.arrayOfDhtmlSuiteObjects['+ind+'].__processSlide('+slideTo+','+slidePixels+','+currentPos+','+hideWhenComplete+')',10);}else{if(hideWhenComplete){this.divElement.style.visibility='hidden';this.divElement.style.zIndex=11000;this.divElementCollapsed.style.zIndex=12000;}
this.slideIsInProgress=false;}},__getSlideToCoordinates:function(slideOut)
{var browserWidth=DHTMLSuite.clientInfoObj.getBrowserWidth();var browserHeight=DHTMLSuite.clientInfoObj.getBrowserHeight();var pos=this.paneModel.getPosition();switch(pos){case"west":if(slideOut)
return this.parentRef.paneSizeCollapsed;else
return(0-this.paneModel.size);case"east":if(slideOut)
return browserWidth-this.parentRef.paneSizeCollapsed-this.paneModel.size;else
return browserWidth;case"north":if(slideOut)
return this.parentRef.paneSizeCollapsed;else
return(0-this.paneModel.size);case"south":if(slideOut)
return browserHeight-this.parentRef.paneSizeCollapsed-this.paneModel.size;else
return browserHeight;}},__updateCollapsedSize:function()
{var pos=this.paneModel.getPosition();var size;if(pos=='west'||pos=='east')size=this.divElementCollapsed.offsetWidth;if(pos=='north'||pos=='south')size=this.divElementCollapsed.offsetHeight;if(size)this.parentRef.__setPaneSizeCollapsed(size);},__createHeaderBar:function()
{var ind=this.objectIndex;var pos=this.paneModel.getPosition();var buttonSuffix='Vertical';if(pos=='west'||pos=='east')buttonSuffix='Horizontal';if(pos=='center')buttonSuffix='';this.headerDiv=document.createElement('DIV');this.headerDiv.className='DHTMLSuite_paneHeader';this.headerDiv.style.position='relative';this.titleSpan=document.createElement('SPAN');this.titleSpan.className='paneTitle';this.headerDiv.appendChild(this.titleSpan);this.divElement.appendChild(this.headerDiv);var buttonDiv=document.createElement('DIV');buttonDiv.style.position='absolute';buttonDiv.style.right='0px';buttonDiv.style.top='0px';buttonDiv.className='DHTMLSuite_paneHeader_buttonDiv';this.headerDiv.appendChild(buttonDiv);this.divClose=document.createElement('DIV');this.divClose.className='closeButton';this.divClose.onmouseover=this.__mouseoverHeaderButton;this.divClose.onmouseout=this.__mouseoutHeaderButton;this.divClose.onclick=function(){return DHTMLSuite.variableStorage.arrayOfDhtmlSuiteObjects[ind].__close();};DHTMLSuite.commonObj.__addEventElement(this.divClose);buttonDiv.appendChild(this.divClose);if(pos!='center'){this.divCollapse=document.createElement('DIV');if(pos=='south'||pos=='east')
this.divCollapse.className='expandButton'+buttonSuffix;else
this.divCollapse.className='collapseButton'+buttonSuffix;this.divCollapse.onclick=function(){return DHTMLSuite.variableStorage.arrayOfDhtmlSuiteObjects[ind].__collapse();};this.divCollapse.onmouseover=this.__mouseoverHeaderButton;this.divCollapse.onmouseout=this.__mouseoutHeaderButton;this.divCollapse.style.display='none';DHTMLSuite.commonObj.__addEventElement(this.divCollapse);buttonDiv.appendChild(this.divCollapse);}
this.headerDiv.onselectstart=DHTMLSuite.commonObj.cancelEvent;},__mouseoverHeaderButton:function()
{if(this.className.indexOf('Over')==-1)this.className=this.className+'Over';},__mouseoutHeaderButton:function()
{this.className=this.className.replace('Over','');},__close:function(e)
{var id=this.paneModel.contents[this.activeContentIndex].id;if(id){try{document.getElementById(this.paneModel.contents[this.activeContentIndex].htmlElementId).parentNode.removeChild(document.getElementById(this.paneModel.contents[this.activeContentIndex].htmlElementId));}catch(e){}}
this.activeContentIndex=this.paneModel.__deleteContent(this.activeContentIndex);this.__updatePaneView(this.activeContentIndex);},__deleteContentByIndex:function(contentIndex)
{if(this.paneModel.getCountContent()==0)return;var htmlElementId=this.paneModel.contents[contentIndex].htmlElementId;if(htmlElementId){try{document.getElementById(htmlElementId).parentNode.removeChild(document.getElementById(htmlElementId));}catch(e){}}
var tmpIndex=this.paneModel.__deleteContent(contentIndex);if(contentIndex==this.activeContentIndex)this.activeContentIndex=tmpIndex;if(this.activeContentIndex>contentIndex)this.activeContentIndex--;if(tmpIndex===false)this.activeContentIndex=false;this.__updatePaneView(this.activeContentIndex);},__deleteContentById:function(id)
{var index=this.paneModel.__getIndexFromId(id);if(index!==false)this.__deleteContentByIndex(index);},__collapse:function()
{this.__updateCollapsedSize();this.paneModel.__setState('collapsed');this.divElementCollapsed.style.visibility='visible';this.divElement.style.visibility='hidden';this.__updateView();this.parentRef.__hideResizeHandle(this.paneModel.getPosition());this.parentRef.__positionPanes();},__expand:function()
{this.paneModel.__setState('expanded');this.divElementCollapsed.style.visibility='hidden';this.divElement.style.visibility='visible';this.__updateView();this.parentRef.__showResizeHandle(this.paneModel.getPosition());this.parentRef.__positionPanes();},__updateHeaderBar:function(index)
{if(index===false){this.divClose.style.display='none';if(this.paneModel.getPosition()!='center')this.divCollapse.style.display='block';else this.divCollapse.style.display='none';this.titleSpan.innerHTML='';return;}
this.divClose.style.display='block';if(this.divCollapse)this.divCollapse.style.display='block';this.titleSpan.innerHTML=this.paneModel.contents[index].title;var contentObj=this.paneModel.contents[index];if(!contentObj.closable)this.divClose.style.display='none';if(!this.paneModel.collapsable){if(this.divCollapse)this.divCollapse.style.display='none';this.divExpand.style.display='none';}},__showButtons:function()
{var div=this.headerDiv.getElementsByTagName('DIV')[0];div.style.visibility='visible';},__hideButtons:function()
{var div=this.headerDiv.getElementsByTagName('DIV')[0];div.style.visibility='hidden';},__updateView:function()
{if(this.paneModel.getCountContent()>0&&this.activeContentIndex===false)this.activeContentIndex=0;this.tabDiv.style.display='block';this.headerDiv.style.display='block';if(this.divElement.style.visibility!='hidden'){}
var pos=this.paneModel.getPosition();if(pos=='south'||pos=='north')this.divElementCollapsed.style.height=this.parentRef.paneSizeCollapsed;if(this.paneModel.getCountContent()<2)this.tabDiv.style.display='none';if(this.activeContentIndex!==false)if(!this.paneModel.contents[this.activeContentIndex].title)this.headerDiv.style.display='none';if(this.paneModel.state=='expanded')this.__showButtons();else this.__hideButtons();this.__setSize();},__createContentPane:function()
{this.contentDiv=document.createElement('DIV');this.contentDiv.className='DHTMLSuite_paneContent';if(DHTMLSuite.clientInfoObj.isMSIE){}
if(!this.paneModel.scrollbars)this.contentDiv.style.overflow='hidden';this.divElement.appendChild(this.contentDiv);},__createTabBar:function()
{this.tabDiv=document.createElement('DIV');this.tabDiv.className='DHTMLSuite_paneTabs';this.divElement.appendChild(this.tabDiv);this.__updateTabContent();},__updateTabContent:function()
{this.tabDiv.innerHTML='';var tableObj=document.createElement('TABLE');tableObj.style.padding='0px';tableObj.style.margin='0px';tableObj.style.position='relative';tableObj.cellPadding=0;tableObj.cellSpacing=0;this.tabDiv.appendChild(tableObj);var tbody=document.createElement('TBODY');tableObj.appendChild(tbody);var row=tbody.insertRow(0);var contents=this.paneModel.getContents();var ind=this.objectIndex;for(var no=0;no<contents.length;no++){var cell=row.insertCell(-1);var divTag=document.createElement('DIV');divTag.className='paneSplitterInactiveTab';cell.appendChild(divTag);var aTag=document.createElement('A');contents[no].tabTitle=contents[no].tabTitle+'';aTag.innerHTML=contents[no].tabTitle.replace(' ','&nbsp;');aTag.id='paneTabLink'+no;aTag.href='#';aTag.onclick=function(e){return DHTMLSuite.variableStorage.arrayOfDhtmlSuiteObjects[ind].__tabClick(e);};divTag.appendChild(aTag);DHTMLSuite.commonObj.__addEventElement(aTag);}
this.__updateTabView(0);},__updateTabView:function(activeTab)
{var aTags=this.tabDiv.getElementsByTagName('DIV');for(var no=0;no<aTags.length;no++){if(no==activeTab)aTags[no].className='paneSplitterActiveTab';else aTags[no].className='paneSplitterInactiveTab';}},__tabClick:function(e)
{if(document.all)e=event;var inputObj=DHTMLSuite.commonObj.getSrcElement(e);if(inputObj.tagName!='A')inputObj=inputObj.parentNode;this.__updatePaneView(inputObj.id.replace(/[^0-9]/gi,''));return false;},__addContentDivs:function()
{var contents=this.paneModel.getContents();for(var no=0;no<contents.length;no++){var htmlElementId=this.paneModel.contents[no].htmlElementId;var contentUrl=this.paneModel.contents[no].contentUrl;var refreshAfterSeconds=this.paneModel.contents[no].refreshAfterSeconds;if(htmlElementId){try{this.contentDiv.appendChild(document.getElementById(htmlElementId));document.getElementById(htmlElementId).className='DHTMLSuite_paneContentInner';document.getElementById(htmlElementId).style.display='none';}catch(e){}}
if(contentUrl){if(!this.paneModel.contents[no].htmlElementId||this.paneModel.contents[no].htmlElementId.indexOf('dynamicCreatedDiv__')==-1){var d=new Date();var divId='dynamicCreatedDiv__'+d.getSeconds()+(Math.random()+'').replace('.','');this.paneModel.contents[no].__setIdOfContentElement(divId);var div=document.createElement('DIV');div.id=divId;div.className='DHTMLSuite_paneContentInner';this.contentDiv.appendChild(div);div.style.display='none';this.loadContent(this.paneModel.contents[no].id,contentUrl,refreshAfterSeconds);}}}
this.__updatePaneView(this.activeContentIndex);},__updatePaneView:function(index)
{if(!index)index=this.activeContentIndex;this.__updateTabContent();this.__updateView();this.__updateHeaderBar(index);this.__showHideContentDiv(index);this.__updateTabView(index);this.activeContentIndex=index;},__showHideContentDiv:function(index)
{if(index!==false){var htmlElementId=this.paneModel.contents[this.activeContentIndex].htmlElementId;try{document.getElementById(htmlElementId).style.display='none';}catch(e){}
var htmlElementId=this.paneModel.contents[index].htmlElementId;if(htmlElementId){try{document.getElementById(htmlElementId).style.display='block';}catch(e){}}}},__setSize:function(recursive)
{var pos=this.paneModel.getPosition().toLowerCase();if(pos=='west'||pos=='east'){this.divElement.style.width=this.paneModel.size+'px';}
if(pos=='north'||pos=='south'){this.divElement.style.height=this.paneModel.size+'px';this.divElement.style.width='100%';}
try{this.contentDiv.style.height=(this.divElement.clientHeight-this.tabDiv.offsetHeight-this.headerDiv.offsetHeight)+'px';}catch(e){}
if(!recursive){window.obj=this;setTimeout('window.obj.__setSize(true)',100);}},__setTopPosition:function(newTop)
{this.divElement.style.top=newTop+'px';},__setLeftPosition:function(newLeft)
{this.divElement.style.left=newLeft+'px';},__setWidth:function(newWidth)
{if(this.paneModel.getPosition()=='west'||this.paneModel.getPosition()=='east')this.paneModel.setSize(newWidth);newWidth=newWidth+'';if(newWidth.indexOf('%')==-1)newWidth=Math.max(1,newWidth)+'px';this.divElement.style.width=newWidth;},__setHeight:function(newHeight)
{if(this.paneModel.getPosition()=='north'||this.paneModel.getPosition()=='south')this.paneModel.setSize(newHeight);this.divElement.style.height=Math.max(1,newHeight)+'px';this.__setSize();}}
DHTMLSuite.paneSplitter=function()
{var dataModel;var panes;var panesAssociative;var paneContent;var layoutCSS;var horizontalSplitterSize;var horizontalSplitterBorderSize;var verticalSplitterSize;var paneSplitterHandles;var paneDivsCollapsed;var paneSplitterHandleOnResize;var resizeInProgress;var resizeCounter;var currentResize;var currentResize_min;var currentResize_max;var paneSizeCollapsed;var paneBorderLeftPlusRight;var slideSpeed;this.resizeCounter=-1;this.horizontalSplitterSize=5;this.verticalSplitterSize=5;this.paneBorderLeftPlusRight=2;this.slideSpeed=10;this.horizontalSplitterBorderSize=1;this.resizeInProgress=false;this.paneSplitterHandleOnResize=false;this.paneSizeCollapsed=26;this.paneSplitterHandles=new Array();this.paneDivsCollapsed=new Array();this.dataModel=false;this.layoutCSS='pane-splitter.css';this.panes=new Array();this.panesAssociative=new Array();if(!standardObjectsCreated)DHTMLSuite.createStandardObjects();var objectIndex;this.objectIndex=DHTMLSuite.variableStorage.arrayOfDhtmlSuiteObjects.length;DHTMLSuite.variableStorage.arrayOfDhtmlSuiteObjects[this.objectIndex]=this;}
DHTMLSuite.paneSplitter.prototype={addModel:function(newModel)
{this.dataModel=newModel;},setLayoutCss:function(layoutCSS)
{this.layoutCSS=layoutCSS;},setSlideSpeed:function(slideSpeed)
{this.slideSpeed=slideSpeed;},init:function()
{DHTMLSuite.commonObj.loadCSS(this.layoutCSS);this.__createPanes();this.__positionPanes();this.__createResizeHandles();this.__addEvents();setTimeout("DHTMLSuite.variableStorage.arrayOfDhtmlSuiteObjects["+this.objectIndex+"].__positionPanes();",100);setTimeout("DHTMLSuite.variableStorage.arrayOfDhtmlSuiteObjects["+this.objectIndex+"].__positionPanes();",500);},loadContent:function(id,url,refreshAfterSeconds)
{var ref=this.__getPaneReferenceFromId(id);if(ref){ref.loadContent(id,url,refreshAfterSeconds);}},reloadContent:function(id)
{var ref=this.__getPaneReferenceFromId(id);if(ref){ref.reloadContent(id);}},setRefreshAfterSeconds:function(id,refreshAfterSeconds)
{var ref=this.__getPaneReferenceFromId(id);if(ref){ref.setRefreshAfterSeconds(id,refreshAfterSeconds);}},showContent:function(id)
{var ref=this.__getPaneReferenceFromId(id);if(ref)ref.showContent(id);},addContent:function(panePosition,contentModel)
{if(this.panesAssociative[panePosition.toLowerCase()])return this.panesAssociative[panePosition.toLowerCase()].addContent(contentModel);else return false;},deleteContentById:function(id)
{var ref=this.__getPaneReferenceFromId(id);if(ref)ref.__deleteContentById(id);},deleteContentByIndex:function(panePosition,contentIndex)
{if(this.panesAssociative[panePosition]){this.panesAssociative[panePosition].__deleteContentByIndex(contentIndex);}},hidePane:function(panePosition)
{if(this.panesAssociative[panePosition]&&panePosition!='center'){this.panesAssociative[panePosition].hidePane();if(this.paneSplitterHandles[panePosition])this.paneSplitterHandles[panePosition].style.display='none';this.__positionPanes();}else return false;},showPane:function(panePosition)
{if(this.panesAssociative[panePosition]&&panePosition!='center'){this.panesAssociative[panePosition].showPane();if(this.paneSplitterHandles[panePosition])this.paneSplitterHandles[panePosition].style.display='block';this.__positionPanes();}else return false;},__setPaneSizeCollapsed:function(newSize)
{if(newSize>this.paneSizeCollapsed)this.paneSizeCollapsed=newSize;},__createPanes:function()
{var dataObjects=this.dataModel.getItems();for(var no=0;no<dataObjects.length;no++){var index=this.panes.length;this.panes[index]=new DHTMLSuite.paneSplitterPane(this);this.panes[index].addDataSource(dataObjects[no]);this.panes[index].__createPane();this.panesAssociative[dataObjects[no].position.toLowerCase()]=this.panes[index];}},__createResizeHandles:function()
{var ind=this.objectIndex;if(this.panesAssociative['north']&&this.panesAssociative['north'].paneModel.resizable){this.paneSplitterHandles['north']=document.createElement('DIV');var obj=this.paneSplitterHandles['north'];obj.className='DHTMLSuite_paneSplitter_horizontal';obj.style.position='absolute';obj.style.height=this.horizontalSplitterSize+'px';obj.style.width='100%';obj.style.zIndex=10000;DHTMLSuite.commonObj.addEvent(obj,'mousedown',function(){DHTMLSuite.variableStorage.arrayOfDhtmlSuiteObjects[ind].__initResizePane('north');});document.body.appendChild(obj);}
if(this.panesAssociative['west']&&this.panesAssociative['west'].paneModel.resizable){this.paneSplitterHandles['west']=document.createElement('DIV');var obj=this.paneSplitterHandles['west'];obj.className='DHTMLSuite_paneSplitter_vertical';obj.style.position='absolute';obj.style.width=this.verticalSplitterSize+'px';obj.style.zIndex=11000;DHTMLSuite.commonObj.addEvent(obj,'mousedown',function(){DHTMLSuite.variableStorage.arrayOfDhtmlSuiteObjects[ind].__initResizePane('west');});document.body.appendChild(obj);}
if(this.panesAssociative['east']&&this.panesAssociative['east'].paneModel.resizable){this.paneSplitterHandles['east']=document.createElement('DIV');var obj=this.paneSplitterHandles['east'];obj.className='DHTMLSuite_paneSplitter_vertical';obj.style.position='absolute';obj.style.width=this.verticalSplitterSize+'px';obj.style.zIndex=11000;DHTMLSuite.commonObj.addEvent(obj,'mousedown',function(){DHTMLSuite.variableStorage.arrayOfDhtmlSuiteObjects[ind].__initResizePane('east');});document.body.appendChild(obj);}
if(this.panesAssociative['south']&&this.panesAssociative['south'].paneModel.resizable){this.paneSplitterHandles['south']=document.createElement('DIV');var obj=this.paneSplitterHandles['south'];obj.className='DHTMLSuite_paneSplitter_horizontal';obj.style.position='absolute';obj.style.height=this.horizontalSplitterSize+'px';obj.style.width='100%';obj.style.zIndex=10000;DHTMLSuite.commonObj.addEvent(obj,'mousedown',function(){DHTMLSuite.variableStorage.arrayOfDhtmlSuiteObjects[ind].__initResizePane('south');});document.body.appendChild(obj);}
this.paneSplitterHandleOnResize=document.createElement('DIV');var obj=this.paneSplitterHandleOnResize;obj.className='DHTMLSuite_paneSplitter_onResize';obj.style.position='absolute';obj.style.zIndex=55000;obj.style.display='none';document.body.appendChild(obj);},__getPaneReferenceFromId:function(id)
{for(var no=0;no<this.panes.length;no++){var contents=this.panes[no].paneModel.getContents();for(var no2=0;no2<contents.length;no2++){if(contents[no2].id==id)return this.panes[no];}}
return false;},__initResizePane:function(pos)
{this.currentResize=pos;this.currentResize_min=this.__getMinimumPos(pos);this.currentResize_max=this.__getMaximumPos(pos);this.paneSplitterHandleOnResize.style.left=this.paneSplitterHandles[pos].style.left;this.paneSplitterHandleOnResize.style.top=this.paneSplitterHandles[pos].style.top;this.paneSplitterHandleOnResize.style.width=this.paneSplitterHandles[pos].offsetWidth+'px';this.paneSplitterHandleOnResize.style.height=this.paneSplitterHandles[pos].offsetHeight+'px';this.paneSplitterHandleOnResize.style.display='block';this.resizeCounter=0;DHTMLSuite.commonObj.__setOkToSelect(false);this.__timerResizePane();},__getMinimumPos:function(pos)
{var browserWidth=DHTMLSuite.clientInfoObj.getBrowserWidth();var browserHeight=DHTMLSuite.clientInfoObj.getBrowserHeight();if(pos=='west'||pos=='north'){return this.panesAssociative[pos].paneModel.minSize;}else{if(pos=='east')return browserWidth-this.panesAssociative[pos].paneModel.maxSize;if(pos=='south')return browserHeight-this.panesAssociative[pos].paneModel.maxSize;}},__getMaximumPos:function(pos)
{var browserWidth=DHTMLSuite.clientInfoObj.getBrowserWidth();var browserHeight=DHTMLSuite.clientInfoObj.getBrowserHeight();if(pos=='west'||pos=='north'){return this.panesAssociative[pos].paneModel.maxSize;}else{if(pos=='east')return browserWidth-this.panesAssociative[pos].paneModel.minSize;if(pos=='south')return browserHeight-this.panesAssociative[pos].paneModel.minSize;}},__timerResizePane:function()
{if(this.resizeCounter>=0&&this.resizeCounter<5){this.resizeCounter++;setTimeout('DHTMLSuite.variableStorage.arrayOfDhtmlSuiteObjects['+this.objectIndex+'].__timerResizePane()',2);}},__resizePane:function(e)
{if(document.all)e=event;if(DHTMLSuite.clientInfoObj.isMSIE&&e.button!=1)this.__endResize();if(this.resizeCounter==5){if(this.currentResize=='west'||this.currentResize=='east'){var leftPos=e.clientX;if(leftPos<this.currentResize_min)leftPos=this.currentResize_min;if(leftPos>this.currentResize_max)leftPos=this.currentResize_max;this.paneSplitterHandleOnResize.style.left=leftPos+'px';}else{var topPos=e.clientY;if(topPos<this.currentResize_min)topPos=this.currentResize_min;if(topPos>this.currentResize_max)topPos=this.currentResize_max;this.paneSplitterHandleOnResize.style.top=topPos+'px';}}},__endResize:function()
{if(this.resizeCounter==5){var browserWidth=DHTMLSuite.clientInfoObj.getBrowserWidth();var browserHeight=DHTMLSuite.clientInfoObj.getBrowserHeight();var obj=this.panesAssociative[this.currentResize];switch(this.currentResize){case"west":obj.__setWidth(this.paneSplitterHandleOnResize.style.left.replace('px','')/1);break;case"north":obj.__setHeight(this.paneSplitterHandleOnResize.style.top.replace('px','')/1);break;case"east":obj.__setWidth(browserWidth-this.paneSplitterHandleOnResize.style.left.replace('px','')/1);break;case"south":obj.__setHeight(browserHeight-this.paneSplitterHandleOnResize.style.top.replace('px','')/1);break;}
this.__positionPanes();}
this.paneSplitterHandleOnResize.style.display='none';this.resizeCounter=-1;DHTMLSuite.commonObj.__setOkToSelect(true);},__hideResizeHandle:function(pos){if(this.paneSplitterHandles[pos])this.paneSplitterHandles[pos].style.display='none';},__showResizeHandle:function(pos){if(this.paneSplitterHandles[pos])this.paneSplitterHandles[pos].style.display='block';},__positionResizeHandles:function()
{if(this.paneSplitterHandles['north']){this.paneSplitterHandles['north'].style.top=this.panesAssociative['north'].divElement.style.height.replace('px','')+'px';}
var heightHandler=this.panesAssociative['center'].divElement.offsetHeight+1;var topPos=0;if(this.panesAssociative['center'])topPos+=this.panesAssociative['center'].divElement.style.top.replace('px','')/1;if(this.paneSplitterHandles['west']){if(this.paneSplitterHandles['east'])heightHandler+=this.horizontalSplitterBorderSize/2;this.paneSplitterHandles['west'].style.left=this.panesAssociative['west'].divElement.offsetWidth+'px';this.paneSplitterHandles['west'].style.height=heightHandler+'px';this.paneSplitterHandles['west'].style.top=topPos+'px';}
if(this.paneSplitterHandles['east']){var leftPos=this.panesAssociative['center'].divElement.style.left.replace('px','')/1+this.panesAssociative['center'].divElement.offsetWidth;this.paneSplitterHandles['east'].style.left=leftPos+'px';this.paneSplitterHandles['east'].style.height=heightHandler+'px';this.paneSplitterHandles['east'].style.top=topPos+'px';}
if(this.paneSplitterHandles['south']){var topPos=this.panesAssociative['south'].divElement.style.top.replace('px','')/1;topPos=topPos-this.horizontalSplitterSize-this.horizontalSplitterBorderSize;this.paneSplitterHandles['south'].style.top=topPos+'px';}
this.resizeInProgress=false;},__positionPanes:function()
{if(this.resizeInProgress)return;var ind=this.objectIndex;this.resizeInProgress=true;var browserWidth=DHTMLSuite.clientInfoObj.getBrowserWidth();var browserHeight=DHTMLSuite.clientInfoObj.getBrowserHeight();var posTopMiddlePanes=0;if(this.panesAssociative['north']&&this.panesAssociative['north'].paneModel.visible){if(this.panesAssociative['north'].paneModel.state=='expanded'){posTopMiddlePanes=this.panesAssociative['north'].divElement.offsetHeight;if(this.paneSplitterHandles['north'])posTopMiddlePanes+=(this.horizontalSplitterSize+this.horizontalSplitterBorderSize);this.panesAssociative['north'].__setHeight(this.panesAssociative['north'].divElement.offsetHeight);}else{posTopMiddlePanes+=this.paneSizeCollapsed;}}
if(this.panesAssociative['center'])this.panesAssociative['center'].__setTopPosition(posTopMiddlePanes);if(this.panesAssociative['west'])this.panesAssociative['west'].__setTopPosition(posTopMiddlePanes);if(this.panesAssociative['east'])this.panesAssociative['east'].__setTopPosition(posTopMiddlePanes);if(this.panesAssociative['west'])this.panesAssociative['west'].divElementCollapsed.style.top=posTopMiddlePanes+'px';if(this.panesAssociative['east'])this.panesAssociative['east'].divElementCollapsed.style.top=posTopMiddlePanes+'px';var posLeftCenterPane=0;if(this.panesAssociative['west']){if(this.panesAssociative['west'].paneModel.state=='expanded'){posLeftCenterPane=this.panesAssociative['west'].divElement.offsetWidth;this.panesAssociative['west'].__setLeftPosition(0);posLeftCenterPane+=(this.verticalSplitterSize);}else{posLeftCenterPane+=this.paneSizeCollapsed;}}
this.panesAssociative['center'].__setLeftPosition(posLeftCenterPane);var sizeCenterPane=browserWidth;if(this.panesAssociative['west']&&this.panesAssociative['west'].paneModel.visible){if(this.panesAssociative['west'].paneModel.state=='expanded')
sizeCenterPane-=this.panesAssociative['west'].divElement.offsetWidth;else
sizeCenterPane-=this.paneSizeCollapsed;}
if(this.panesAssociative['east']&&this.panesAssociative['east'].paneModel.visible){if(this.panesAssociative['east'].paneModel.state=='expanded')
sizeCenterPane-=this.panesAssociative['east'].divElement.offsetWidth;else
sizeCenterPane-=this.paneSizeCollapsed;}
sizeCenterPane-=this.paneBorderLeftPlusRight;if(this.paneSplitterHandles['west']&&this.panesAssociative['west'].paneModel.state=='expanded')sizeCenterPane-=(this.verticalSplitterSize);if(this.paneSplitterHandles['east']&&this.panesAssociative['east'].paneModel.state=='expanded')sizeCenterPane-=(this.verticalSplitterSize);this.panesAssociative['center'].__setWidth(sizeCenterPane);var posEastPane=posLeftCenterPane+this.panesAssociative['center'].divElement.offsetWidth;if(this.paneSplitterHandles['east'])posEastPane+=(this.verticalSplitterSize);if(this.panesAssociative['east']){if(this.panesAssociative['east'].paneModel.state=='expanded')this.panesAssociative['east'].__setLeftPosition(posEastPane);this.panesAssociative['east'].divElementCollapsed.style.left=(posEastPane-this.verticalSplitterSize)+'px';}
var heightMiddleFrames=browserHeight;if(this.panesAssociative['north']&&this.panesAssociative['north'].paneModel.visible){if(this.panesAssociative['north'].paneModel.state=='expanded'){heightMiddleFrames-=this.panesAssociative['north'].divElement.offsetHeight;heightMiddleFrames-=(this.horizontalSplitterSize+this.horizontalSplitterBorderSize);}else
heightMiddleFrames-=this.paneSizeCollapsed;}
if(this.panesAssociative['south']&&this.panesAssociative['south'].paneModel.visible){if(this.panesAssociative['south'].paneModel.state=='expanded'){heightMiddleFrames-=this.panesAssociative['south'].divElement.offsetHeight;if(!this.paneSplitterHandles['south'])heightMiddleFrames+=(this.horizontalSplitterSize+this.horizontalSplitterBorderSize);}else
heightMiddleFrames-=this.paneSizeCollapsed;}
if(this.panesAssociative['center'])this.panesAssociative['center'].__setHeight(heightMiddleFrames);if(this.panesAssociative['west'])this.panesAssociative['west'].__setHeight(heightMiddleFrames);if(this.panesAssociative['east'])this.panesAssociative['east'].__setHeight(heightMiddleFrames);var posSouth=0;if(this.panesAssociative['north']){if(this.panesAssociative['north'].paneModel.state=='expanded'){posSouth=this.panesAssociative['north'].divElement.offsetHeight;}else
posSouth=this.paneSizeCollapsed;}
posSouth+=heightMiddleFrames;if(this.paneSplitterHandles['south']&&this.panesAssociative['south'].paneModel.state=='expanded'){posSouth+=(this.horizontalSplitterSize+this.horizontalSplitterBorderSize);}
if(this.panesAssociative['south']){this.panesAssociative['south'].__setTopPosition(posSouth);this.panesAssociative['south'].divElementCollapsed.style.top=posSouth+'px';this.panesAssociative['south'].__setWidth('100%');}
if(this.panesAssociative['west']){this.panesAssociative['west'].divElementCollapsed.style.height=(heightMiddleFrames)+'px';this.panesAssociative['west'].divElementCollapsedInner.style.height=(heightMiddleFrames-5)+'px';}
if(this.panesAssociative['east']){this.panesAssociative['east'].divElementCollapsed.style.height=heightMiddleFrames+'px';this.panesAssociative['east'].divElementCollapsedInner.style.height=(heightMiddleFrames-5)+'px';}
if(this.panesAssociative['south']){this.panesAssociative['south'].divElementCollapsed.style.width=browserWidth+'px';this.panesAssociative['south'].divElementCollapsedInner.style.width=(browserWidth-4)+'px';if(this.panesAssociative['south'].paneModel.state=='collapsed'&&this.panesAssociative['south'].divElementCollapsed.offsetHeight){var rest=browserHeight-this.panesAssociative['south'].divElementCollapsed.style.top.replace('px','')/1-this.panesAssociative['south'].divElementCollapsed.offsetHeight;if(rest>0)this.panesAssociative['south'].divElementCollapsed.style.height=(this.panesAssociative['south'].divElementCollapsed.offsetHeight+rest)+'px';}}
if(this.panesAssociative['north']){this.panesAssociative['north'].divElementCollapsed.style.width=browserWidth+'px';this.panesAssociative['north'].divElementCollapsedInner.style.width=(browserWidth-4)+'px';}
this.__positionResizeHandles();setTimeout('DHTMLSuite.variableStorage.arrayOfDhtmlSuiteObjects['+ind+'].__positionResizeHandles()',50);},__autoSlideInPanes:function(e)
{if(document.all)e=event;if(this.panesAssociative['south'])this.panesAssociative['south'].__autoSlideInPane(e);if(this.panesAssociative['west'])this.panesAssociative['west'].__autoSlideInPane(e);if(this.panesAssociative['north'])this.panesAssociative['north'].__autoSlideInPane(e);if(this.panesAssociative['east'])this.panesAssociative['east'].__autoSlideInPane(e);},__addEvents:function()
{var ind=this.objectIndex;DHTMLSuite.commonObj.addEvent(window,'resize',function(){DHTMLSuite.variableStorage.arrayOfDhtmlSuiteObjects[ind].__positionPanes();});DHTMLSuite.commonObj.addEvent(document.documentElement,'mouseup',function(){DHTMLSuite.variableStorage.arrayOfDhtmlSuiteObjects[ind].__endResize();});DHTMLSuite.commonObj.addEvent(document.documentElement,'mousemove',function(e){DHTMLSuite.variableStorage.arrayOfDhtmlSuiteObjects[ind].__resizePane(e);});DHTMLSuite.commonObj.addEvent(document.documentElement,'click',function(e){DHTMLSuite.variableStorage.arrayOfDhtmlSuiteObjects[ind].__autoSlideInPanes(e);});document.documentElement.onselectstart=function(){return DHTMLSuite.commonObj.__getOkToSelect();};DHTMLSuite.commonObj.__addEventElement(window);}}
DHTMLSuite.listModel=function(inputArray)
{var options;this.options=new Array();}
DHTMLSuite.listModel.prototype={addElement:function(value,text)
{var index=this.options.length;this.options[index]=new Array();this.options[index]['value']=value;this.options[index]['text']=text;},createFromMarkupSelect:function(elId)
{var obj=document.getElementById(elId);if(obj&&obj.tagName.toLowerCase()!='select')obj=false;if(!obj){alert('Error in listModel.createFromMarkupSelect - cannot create elements from select box with id '+elId);return;}
for(var no=0;no<obj.options.length;no++){var index=this.options.length;this.options[index]=new Array();this.options[index]['value']=obj.options[no].value;this.options[index]['text']=obj.options[no].text;}
obj.style.display='none';},createFromMarkupUlLi:function(elId)
{var obj=document.getElementById(elId);if(obj&&obj.tagName.toLowerCase()!='ul')obj=false;if(!obj){alert('Error in listModel.createFromMarkupSelect - cannot create elements from select box with id '+elId);return;}
var lis=obj.getElementsByTagName('LI');for(var no=0;no<lis.length;no++){var index=this.options.length;this.options[index]=new Array();this.options[index]['value']=lis[no].getAttribute('title');if(!this.options[index]['value'])this.options[index]['value']=lis[no].title;this.options[index]['text']=lis[no].innerHTML;}
obj.style.display='none';}}
DHTMLSuite.textEditModel=function(inputArray)
{var labelId;var targetId;var serversideFile;var optionObj;if(!standardObjectsCreated)DHTMLSuite.createStandardObjects();if(inputArray)this.addElement(inputArray);}
DHTMLSuite.textEditModel.prototype={addElement:function(inputArray)
{if(inputArray['labelId'])this.labelId=inputArray['labelId'];if(inputArray['elementId'])this.elementId=inputArray['elementId'];if(inputArray['serverFile'])this.serverFile=inputArray['serverFile'];if(inputArray['listModel'])this.listModel=inputArray['listModel'];}}
DHTMLSuite.textEdit=function()
{var layoutCSS;var elements;var elementsAssociative;var serversideFile;var objectIndex;var inputObjects;this.layoutCSS='text-edit.css';this.elements=new Array();this.elementsAssociative=new Array();this.inputObjects=new Array();if(!standardObjectsCreated)DHTMLSuite.createStandardObjects();this.objectIndex=DHTMLSuite.variableStorage.arrayOfDhtmlSuiteObjects.length;DHTMLSuite.variableStorage.arrayOfDhtmlSuiteObjects[this.objectIndex]=this;}
DHTMLSuite.textEdit.prototype={setLayoutCss:function(layoutCSS)
{this.layoutCSS=layoutCSS;},setServersideFile:function(serversideFile)
{this.serversideFile=serversideFile;},addElement:function(inputArray)
{var index=this.elements.length;this.elements[index]=new DHTMLSuite.textEditModel(inputArray);this.elementsAssociative[inputArray['elementId']]=this.elements[index];},init:function()
{DHTMLSuite.commonObj.loadCSS(this.layoutCSS);var index=this.objectIndex;for(var no=0;no<this.elements.length;no++){var obj=this.elements[no];var label=document.getElementById(obj.labelId);label.setAttribute('elementId',obj.elementId);if(!label.getAttribute('elementId'))label.elementId=obj.elementId;if(label){if(label.className){label.setAttribute('origClassname',label.className);label.origClassname=label.className;}
label.onclick=function(e){DHTMLSuite.variableStorage.arrayOfDhtmlSuiteObjects[index].__clickOnLabel(e);}
DHTMLSuite.commonObj.__addEventElement(label);}
var el=document.getElementById(obj.elementId);DHTMLSuite.commonObj.__addEventElement(el);if(el){el.onclick=function(e){DHTMLSuite.variableStorage.arrayOfDhtmlSuiteObjects[index].__clickOnElement(e);}
if(obj.listModel){this.inputObjects[obj.elementId]=document.createElement('SELECT');var selObj=this.inputObjects[obj.elementId];selObj.className='DHTMLSuite_textEdit_select';for(var no2=0;no2<obj.listModel.options.length;no2++){selObj.options[selObj.options.length]=new Option(obj.listModel.options[no2].text,obj.listModel.options[no2].value);}
selObj.id='input___'+el.id;selObj.onblur=function(e){DHTMLSuite.variableStorage.arrayOfDhtmlSuiteObjects[index].__exitEditMode(e);}
DHTMLSuite.commonObj.__addEventElement(selObj);el.parentNode.insertBefore(selObj,el);selObj.style.display='none';}else{this.inputObjects[obj.elementId]=document.createElement('INPUT');var input=this.inputObjects[obj.elementId];input.onblur=function(e){DHTMLSuite.variableStorage.arrayOfDhtmlSuiteObjects[index].__exitEditMode(e);}
DHTMLSuite.commonObj.__addEventElement(input);input.className='DHTMLSuite_textEdit_input';input.id='input___'+el.id;input.value=el.innerHTML;el.parentNode.insertBefore(input,el);input.style.display='none';}}}},__setLabelClassName:function(obj,state)
{if(state=='active')
obj.className='DHTMLSuite_textEdit_label';else{var className='';className=obj.getAttribute('origClassname');if(!className)className=obj.origClassname;obj.className=className;}},__clickOnLabel:function(e)
{if(document.all)e=event;var obj=DHTMLSuite.commonObj.getSrcElement(e);this.__setLabelClassName(obj,'active');var elementId=obj.getAttribute('elementId');this.__clickOnElement(false,document.getElementById(elementId));},__clickOnElement:function(e,obj)
{if(document.all)e=event;if(!obj)var obj=DHTMLSuite.commonObj.getSrcElement(e);var id=obj.id;var dataSource=this.elementsAssociative[id];if(dataSource.listModel)this.__setSelectBoxValue(id,obj.innerHTML);if(dataSource.labelId)this.__setLabelClassName(document.getElementById(dataSource.labelId),'active');this.inputObjects[id].style.display='';this.inputObjects[id].focus();if(!dataSource.listModel)this.inputObjects[id].select();obj.style.display='none';},__setSelectBoxValue:function(id,value)
{var selObj=this.inputObjects[id];for(var no=0;no<selObj.options.length;no++){if(selObj.options[no].text==value){selObj.selectedIndex=no;return;}}},__exitEditMode:function(e)
{if(document.all)e=event;var obj=DHTMLSuite.commonObj.getSrcElement(e);var elementId=obj.id.replace('input___','');var dataSource=this.elementsAssociative[elementId];var newValue;if(dataSource.listModel){newValue=obj.options[obj.options.selectedIndex].text;}else{newValue=obj.value;}
if(e.keyCode&&e.keyCode==27)newValue=document.getElementById(dataSource.elementId).innerHTML;if(newValue&&newValue!=document.getElementById(dataSource.elementId).innerHTML)this.__sendRequest(dataSource.elementId,newValue);document.getElementById(dataSource.elementId).innerHTML=newValue;document.getElementById(dataSource.elementId).style.display='';obj.style.display='none';if(dataSource.labelId)this.__setLabelClassName(document.getElementById(dataSource.labelId),'inactive');},__sendRequest:function(elementId,value)
{var index=DHTMLSuite.variableStorage.ajaxObjects.length;var ind=this.objectIndex;try{DHTMLSuite.variableStorage.ajaxObjects[index]=new sack();}catch(e){alert('Unable to create ajax object. Please make sure that the sack js file is included on your page');return;}
var url;if(this.elementsAssociative[elementId].serverFile)url=this.elementsAssociative[elementId].serverFile;else url=this.serversideFile;if(url.indexOf('?')>=0)url=url+'&';else url=url+'?';url=url+'saveTextEdit=1&textEditElementId='+elementId+'&textEditValue='+escape(value);DHTMLSuite.variableStorage.ajaxObjects[index].requestFile=url;DHTMLSuite.variableStorage.ajaxObjects[index].onCompletion=function(){DHTMLSuite.variableStorage.arrayOfDhtmlSuiteObjects[ind].__handleServerSideResponse(index,url);};DHTMLSuite.variableStorage.ajaxObjects[index].onError=function(){DHTMLSuite.variableStorage.arrayOfDhtmlSuiteObjects[ind].__handleAjaxError(ajaxIndex,url);};DHTMLSuite.variableStorage.ajaxObjects[index].runAJAX();},__handleServerSideResponse:function(ajaxIndex,url)
{if(DHTMLSuite.variableStorage.ajaxObjects[ajaxIndex].response!='OK'){alert('An error occured in the textEdit widget when calling the url\n'+url);}
DHTMLSuite.variableStorage.ajaxObjects[ajaxIndex]=null;},__handleAjaxError:function(ajaxIndex,url)
{alert('Error when calling the url:\n'+url);DHTMLSuite.variableStorage.ajaxObjects[ajaxIndex]=null;}}
var referenceToDHTMLSuiteContextMenu;DHTMLSuite.contextMenu=function()
{var menuModels;var menuItems;var menuObject;var layoutCSS;var menuUls;var width;var srcElement;var indexCurrentlyDisplayedMenuModel;this.menuModels=new Array();this.menuObject=false;this.layoutCSS='context-menu.css';this.menuUls=new Array();this.width=100;this.srcElement=false;this.indexCurrentlyDisplayedMenuModel=false;if(!standardObjectsCreated)DHTMLSuite.createStandardObjects();}
DHTMLSuite.contextMenu.prototype={setWidth:function(newWidth)
{this.width=newWidth;},setLayoutCss:function(cssFileName)
{this.layoutCSS=cssFileName;},attachToElement:function(element,elementId,menuModel)
{window.refToThisContextMenu=this;if(!element&&elementId)element=document.getElementById(elementId);if(!element.id){element.id='context_menu'+Math.random();element.id=element.id.replace('.','');}
this.menuModels[element.id]=menuModel;element.oncontextmenu=this.__displayContextMenu;element.onmousedown=function(){window.refToThisContextMenu.__setReference(window.refToThisContextMenu);};DHTMLSuite.commonObj.__addEventElement(element)
DHTMLSuite.commonObj.addEvent(document.documentElement,"click",this.__hideContextMenu);},__setReference:function(obj)
{referenceToDHTMLSuiteContextMenu=obj;},__displayContextMenu:function(e)
{if(document.all)e=event;var ref=referenceToDHTMLSuiteContextMenu;ref.srcElement=DHTMLSuite.commonObj.getSrcElement(e);if(!ref.indexCurrentlyDisplayedMenuModel||ref.indexCurrentlyDisplayedMenuModel!=this.id){if(!ref.indexCurrentlyDisplayedMenuModel)DHTMLSuite.commonObj.loadCSS(ref.layoutCSS);if(ref.indexCurrentlyDisplayedMenuModel){ref.menuObject.innerHTML='';}else{ref.__createDivs();}
ref.menuItems=ref.menuModels[this.id].getItems();ref.__createMenuItems();}
ref.indexCurrentlyDisplayedMenuModel=this.id;ref.menuObject.style.left=(e.clientX+Math.max(document.body.scrollLeft,document.documentElement.scrollLeft))+'px';ref.menuObject.style.top=(e.clientY+Math.max(document.body.scrollTop,document.documentElement.scrollTop))+'px';ref.menuObject.style.display='block';return false;},__hideContextMenu:function()
{var ref=referenceToDHTMLSuiteContextMenu;if(!ref)return;if(ref.menuObject)ref.menuObject.style.display='none';},__createDivs:function()
{var firstChild=false;var firstChilds=document.getElementsByTagName('DIV');if(firstChilds.length>0)firstChild=firstChilds[0];this.menuObject=document.createElement('DIV');this.menuObject.className='DHTMLSuite_contextMenu';this.menuObject.style.backgroundImage='url(\''+DHTMLSuite.configObj.imagePath+'context-menu-gradient.gif'+'\')';this.menuObject.style.backgroundRepeat='repeat-y';if(this.width)this.menuObject.style.width=this.width+'px';if(firstChild){firstChild.parentNode.insertBefore(this.menuObject,firstChild);}else{document.body.appendChild(this.menuObject);}},__mouseOver:function()
{this.className='DHTMLSuite_item_mouseover';if(!document.all){this.style.backgroundPosition='left center';}},__mouseOut:function()
{this.className='';if(!document.all){this.style.backgroundPosition='1px center';}},__createMenuItems:function()
{window.refToContextMenu=this;this.menuUls=new Array();for(var no in this.menuItems){if(!this.menuUls[0]){this.menuUls[0]=document.createElement('UL');this.menuObject.appendChild(this.menuUls[0]);}
if(this.menuItems[no].depth==1){if(this.menuItems[no].separator){var li=document.createElement('DIV');li.className='DHTMLSuite_contextMenu_separator';}else{var li=document.createElement('LI');if(this.menuItems[no].jsFunction){this.menuItems[no].url=this.menuItems[no].jsFunction+'(this,referenceToDHTMLSuiteContextMenu.srcElement)';}
if(this.menuItems[no].itemIcon){li.style.backgroundImage='url(\''+this.menuItems[no].itemIcon+'\')';if(!document.all)li.style.backgroundPosition='1px center';}
if(this.menuItems[no].url){var url=this.menuItems[no].url+'';li.onclick=function(){eval(url);};}
li.innerHTML='<a href="#" onclick="return false">'+this.menuItems[no].itemText+'</a>';li.onmouseover=this.__mouseOver;li.onmouseout=this.__mouseOut;DHTMLSuite.commonObj.__addEventElement(li);}
this.menuUls[0].appendChild(li);}}}}
