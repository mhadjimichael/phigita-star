struct struct -super_helper "class_helper" {
    varchar nsp
    varchar name
    varchar class_cmd
    varchar pk
    bool is_final_if_no_scope
    set<slot> slots = {}
}

struct slot {
    varchar name
    varchar type
    varchar default
    bool optional_p = false
    varchar container_type
    varchar subtype
}

struct email -pk address {
    varchar name = ""
    varchar address
}

struct file {
    varchar name
    varchar mime_type
    int32 size
}

struct folder {
    varchar name
}

struct message -is_final_if_no_scope "1" {

    varchar device = "sms"

    int16 num_comments = 0

    varchar subject

    varchar body

    # example of an instance:
    # email -name "zena wow" -address "zena@example.com"
    #
    # example of slot definition:
    # email from
    #
    # slot from -type email
    attribute_helper email from

    slot from -type email

    # embedded object mapping for slot email
    # struct -name from {
    #     varchar name = ""
    #     varchar email
    # }

    list<email> to
    list<email> cc = {}
    list<email> bcc = {}

    bool public_p = false

    set<category> categories
    set<folder> folders
    set<varchar> tags
    set<file> attachment = {}

    map<varchar,i32> wordcount

    #extends -ref content.Object
    #extends -ref content.Content
    #extends -ref auditing.Auditing -hi world

    #index -attr public_p -abc 123

}

message msg1 -subject "hello"

db_insert -scope {user} -what msg1
